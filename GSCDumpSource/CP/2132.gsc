// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

class_progression_init()
{
    while ( !isdefined( level.players ) )
        wait 0.1;
}

get_player_class( var_0 )
{
    if ( !isdefined( var_0 ) )
        var_0 = self;

    var_1 = var_0 scripts\cp\utility::getplayerdataloadoutgroup();
    var_2 = var_0 getplayerdata( level.loadoutsgroup, "squadMembers", "cpFieldUpgrade" );
}

give_player_class( var_0 )
{
    self notify( "giving_class" );
    scripts\cp\perks\cp_perks::init_each_perk();
    var_1 = scripts\cp\utility::getplayerdataloadoutgroup();
    var_2 = scripts\cp\cp_loadout::cac_getloadoutselectedidx();
    var_3 = "none";

    if ( !scripts\cp\utility::prematchintiallandingcomplete() )
    {
        self setviewkickscale( 0.5 );

        for ( var_4 = 0; var_4 < 3; var_4++ )
        {
            var_5 = var_4;

            if ( isdefined( var_0 ) )
                var_6 = scripts\cp\cp_loadout::table_getperk( level.classtablename, var_0, var_4 );
            else
                var_6 = self getplayerdata( level.loadoutsgroup, "squadMembers", "loadouts", var_2, "loadoutPerks", var_5 );

            if ( isdefined( var_6 ) )
                scripts\cp\utility::giveperk( var_6 );
        }
    }

    scripts\cp\coop_super::molotov_damage_over_time();
    init_player_sessiondata();
}

give_assault_class()
{
    self.class = "assault";
    scripts\cp\utility::giveperk( "specialty_fastreload" );
}

_id_119E1()
{
    scripts\cp\utility::takeperk( "specialty_fastreload" );
}

give_crusader_class()
{
    self.class = "crusader";
}

_id_119E7()
{

}

wait_and_give_perk( var_0, var_1 )
{
    wait( var_1 );
    scripts\cp\utility::giveperk( var_0 );
}

give_tank_class()
{
    self.class = "tank";
    molotov_cleanup_pool();
}

molotov_cleanup_pool()
{
    var_0 = self getcurrentweapon();

    if ( scripts\cp\cp_weapon::is_launcher( var_0 ) && !scripts\cp\cp_weapon::is_killstreak_weapon( var_0 ) )
        var_0 = scripts\cp\cp_weapon::add_launcher_xmags( var_0 );
}

_id_11A11()
{
    var_0 = self getcurrentweapon();

    if ( scripts\cp\cp_weapon::is_launcher( var_0 ) && !scripts\cp\cp_weapon::is_killstreak_weapon( var_0 ) )
    {
        var_1 = self getweaponammoclip( var_0 );
        var_2 = self getweaponammostock( var_0 );
        var_0 = scripts\cp\cp_weapon::_id_119F6( var_0 );
        self setweaponammoclip( var_0, var_1 );
        self setweaponammostock( var_0, var_2 );
    }
}

give_medic_class()
{
    self.class = "medic";
}

_id_119FA()
{

}

give_hunter_class()
{
    self.class = "hunter";
    scripts\cp\perks\cp_perks::reduce_recoil();
}

_id_119F3()
{
    scripts\cp\perks\cp_perks::_id_11A08();
}

give_engineer_class()
{
    self.class = "engineer";
}

_id_119E9()
{

}

give_default_class()
{
    var_0 = scripts\engine\utility::random( [ "medic", "tank", "crusader", "assault", "hunter", "engineer" ] );

    switch ( var_0 )
    {
        case "medic":
            give_medic_class();
            break;
        case "tank":
            give_tank_class();
            break;
        case "crusader":
            give_crusader_class();
            break;
        case "assault":
            give_assault_class();
            break;
        case "hunter":
            give_hunter_class();
        case "engineer":
            give_engineer_class();
            break;
    }
}

init_player_sessiondata()
{
    var_0 = self;
    var_0 setplayerdata( "cp", "CPSession", "skill_level", 1, 0 );
    var_0 setplayerdata( "cp", "CPSession", "skill_level", 2, 0 );
    var_0 setplayerdata( "cp", "CPSession", "skill_level", 3, 0 );
    var_0 setplayerdata( "cp", "CPSession", "skill_level", 4, 0 );
    var_0 setplayerdata( "cp", "CPSession", "skill_points", 0 );
}

randomize_player_sessiondata()
{
    foreach ( var_1 in level.players )
    {
        var_1 setplayerdata( "cp", "CPSession", "skill_level", 1, randomint( 5 ) );
        var_1 setplayerdata( "cp", "CPSession", "skill_level", 2, randomint( 5 ) );
        var_1 setplayerdata( "cp", "CPSession", "skill_level", 3, randomint( 5 ) );
        var_1 setplayerdata( "cp", "CPSession", "skill_level", 4, randomint( 5 ) );
    }
}

give_skill_points( var_0 )
{
    var_1 = self getplayerdata( "cp", "CPSession", "skill_points" );
    self setplayerdata( "cp", "CPSession", "skill_points", var_1 + var_0 );
}

take_skill_points( var_0 )
{
    var_1 = self getplayerdata( "cp", "CPSession", "skill_points" );
    self setplayerdata( "cp", "CPSession", "skill_points", var_1 - var_0 );
}

giveskillpointsthruluinotify( var_0 )
{
    var_1 = self getplayerdata( "cp", "CPSession", "skill_level", var_0 );
    var_2 = self.skill_names[var_0 - 1];
    add_skill_point_to_skill( var_2, 1 );
}

set_class_playerdata( var_0 )
{
    switch ( var_0 )
    {
        case "assault":
            var_1 = 1;
            break;
        case "tank":
            var_1 = 2;
            break;
        case "medic":
            var_1 = 3;
            break;
        case "hunter":
            var_1 = 4;
            break;
        default:
            var_1 = 0;
            break;
    }
}

reload_on_kill()
{

}

add_skill_point_to_skill( var_0, var_1 )
{

}

debug_give_class( var_0 )
{
    give_player_class( var_0 );
}

return_wbk_version_of_weapon( var_0, var_1, var_2 )
{
    level endon( "game_ended" );
    var_0 endon( "disconnect" );

    if ( !istrue( var_0.weaponkitinitialized ) )
        var_0 waittill( "player_weapon_build_kit_initialized" );

    if ( isdefined( var_0.weapon_build_models[var_1] ) )
        return asmdevgetallstates( var_0.weapon_build_models[var_1] );
    else
        return var_2;
}
