// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

main()
{
    level endon( "game_ended" );

    if ( !isdefined( level._id_1303C ) )
        level._id_1303C = spawnstruct();

    scripts\engine\utility::flag_init( "wztrain_array_set" );
    scripts\engine\utility::flag_init( "wztrain_processed_track" );
    scripts\engine\utility::flag_init( "wztrain_spawn_started" );
    scripts\engine\utility::flag_init( "wztrain_anim_playing" );
    scripts\engine\utility::flag_init( "wztrain_icons_attached" );
    var_0 = "";

    if ( isdefined( level.cleanupswaploadoutflags ) && isdefined( level.cleanupswaploadoutflags._id_12850 ) )
        var_0 = level.cleanupswaploadoutflags._id_12850;
    else
        var_0 = getdvar( "scr_wztrain_type", "" );

    if ( var_0 != "armored" )
    {
        getblueprintforpickupweapon( "armored" );
        scripts\mp\utility\sound::anim_spawnposition_override( "vehicle_cargo_train" );
    }

    level._id_1303C.botdisablekillstreaks = location_objective_remover( var_0 );
    level._id_1303C.type = var_0;

    if ( !level playernumlivesvo() )
        return 0;

    if ( var_0 == "armored" )
        scripts\mp\gametypes\br_movingtrain_armored.gsc::init();

    level thread _id_12DDC();
}

#using_animtree("script_model");

location_objective_remover( var_0 )
{
    var_1 = spawnstruct();

    if ( var_0 == "armored" )
    {
        var_1.init_ai = "armored_train_car_";
        var_1.infilweaponraise = "armored_train_car_col_";
        var_1.modelname = "armored_train_car_model_";
        var_1.scriptable_door_get_in_radius = "armored_train_car_1";
        var_1.anime = %iw8_mp_verdansk_armored_train_long_290;
        var_1.animname = "iw8_mp_verdansk_armored_train_long_290";
        var_1.play_bank_intro_vo = [ 8, 7, 6, 5, 4, 3, 2, 1 ];
        var_1.bot_update_difficultysetttings = "veh8_mil_lnd_br_armored_train_assembly_long";
        var_1._id_12325 = "x2_veh8_mil_lnd_br_train_locomotive";
        var_1._id_12324 = "x2_veh8_mil_lnd_br_train_assault";
    }
    else
    {
        var_1.init_ai = "train_car_";
        var_1.modelname = "train_car_model_";
        var_1.shouldgamelobbyremainintact = 1;
        var_1.scriptable_door_get_in_radius = "train_car_20";
        var_1.anime = %iw8_mp_verdansk_train_290;
        var_1.animname = "iw8_mp_verdansk_train_290";
        var_1.play_bank_intro_vo = [ 13, 14, 15, 16, 17, 18, 19, 20 ];
        var_1.bot_update_difficultysetttings = "veh8_mil_lnd_br_train_assembly";
    }

    return var_1;
}

getblueprintforpickupweapon( var_0 )
{
    var_1 = location_objective_remover( var_0 );

    foreach ( var_3 in var_1.play_bank_intro_vo )
    {
        var_4 = var_1.init_ai + var_3;
        var_5 = getent( var_4, "script_noteworthy" );

        if ( isdefined( var_5 ) )
            var_5 delete();

        if ( isdefined( var_1.infilweaponraise ) )
        {
            var_5 = getent( var_1.infilweaponraise + var_3, "script_noteworthy" );

            if ( isdefined( var_5 ) )
                var_5 delete();
        }

        var_5 = getent( var_4 + "_train_front_hurt", "script_noteworthy" );

        if ( isdefined( var_5 ) )
            var_5 delete();

        var_5 = getent( var_1.modelname + var_3, "script_noteworthy" );

        if ( isdefined( var_5 ) )
            var_5 delete();
    }
}

_id_12DDC()
{
    if ( tolower( getdvar( "mapname" ) ) != "mp_train_wz" )
    {
        level thread _id_12844( "br_prematchEnded" );
        level scripts\engine\utility::_id_12E3F( "br_prematchEnded", "br_debug_beginEnvEvents" );
    }

    if ( getdvarint( "scr_wztrain_enable", 0 ) == 0 )
        return;

    level thread trial_vehicles();
}

_id_12841()
{
    if ( getdvarfloat( "scr_wztrain_endattrainperc", 0.0 ) == 0.0 )
        return;

    var_0 = getdvarfloat( "scr_wztrain_endattrainperc", 0.0 );

    if ( var_0 != 1.0 )
    {
        if ( randomint( 100 ) < var_0 * 100 )
            return;
    }

    var_1 = scripts\engine\utility::array_combine( level.br_level.br_circleclosetimes, level.br_level.br_circledelaytimes );
    var_2 = 0;

    for ( var_3 = 0; var_3 < var_1.size; var_3++ )
        var_2 = var_2 + var_1[var_3];

    if ( var_2 <= 0 )
        return;

    var_2 = _id_12842( var_2 );
    var_4 = level._id_1303C.botdisablekillstreaks.anime;
    var_5 = getanimlength( var_4 );

    if ( !isdefined( var_5 ) || var_5 <= 0 )
        return;

    var_6 = var_2 / var_5;
    var_7 = var_6 - int( var_6 );
    var_8 = getanglesforanimtime( ( -9661, -9119, -299.007 ), ( 0, 0, 0 ), var_4, var_7 );
    level._id_1303C.dropradius = spawnstruct();
    level._id_1303C.dropradius._id_130A9 = var_5;
    level._id_1303C.dropradius.round_smoke_semtex_logic = var_6;
    level._id_1303C.dropradius.round_smoke_molotov_logic = var_7;
    level._id_1303C.dropradius._id_1278F = var_2;
    level._id_1303C.dropradius.droporigin = var_8;
    setdvar( "br_final_circle_override", var_8 );
}

_id_12842( var_0 )
{
    var_1 = 425;

    if ( getdvarint( "scr_wztrain_endattrainback", 425 ) != 425 )
        var_1 = getdvarint( "scr_wztrain_endattrainback", 425 );

    if ( getdvarint( "scr_wztrain_endattrainrand", 75 ) > 0 )
    {
        var_2 = getdvarint( "scr_wztrain_endattrainrand", 75 );
        var_1 = var_1 + randomint( var_2 );
    }

    var_3 = 10;

    for ( var_4 = 0; var_4 < var_1 - var_3; var_4 = var_4 + var_3 )
    {
        if ( var_0 - var_3 > 0 )
            var_0 = var_0 - var_3;
    }

    return var_0;
}

playernumlivesvo()
{
    level._id_1303C._id_12810 = [];

    if ( isdefined( level._id_1303C._id_11F40 ) )
    {
        foreach ( var_1 in level._id_1303C._id_11F40 )
            level._id_1303C._id_12810[level._id_1303C._id_12810.size] = var_1;
    }
    else
    {
        level._id_1303C._id_12810 = [];
        var_3 = level._id_1303C.botdisablekillstreaks.init_ai;

        foreach ( var_5 in level._id_1303C.botdisablekillstreaks.play_bank_intro_vo )
        {
            var_6 = getent( var_3 + var_5, "script_noteworthy" );
            level._id_1303C._id_12810[level._id_1303C._id_12810.size] = var_6;

            if ( isdefined( level._id_1303C.botdisablekillstreaks.infilweaponraise ) )
            {
                var_7 = level._id_1303C.botdisablekillstreaks.infilweaponraise;
                var_8 = getent( var_7 + var_5, "script_noteworthy" );

                if ( isdefined( var_8 ) )
                {
                    var_6.infilvideowaituntilcomplete = var_8;
                    var_8 linkto( var_6 );
                }
            }
        }
    }

    foreach ( var_11 in level._id_1303C._id_12810 )
    {
        if ( !isent( var_11 ) )
            return 0;
    }

    _id_12841();
    _id_12834();
    level._id_1303C._id_12810 = scripts\engine\utility::array_reverse( level._id_1303C._id_12810 );
    _id_12811();
    _id_12812();
    _id_12814();
    _id_1282C();

    if ( getdvarint( "scr_wztrain_immobilized", 0 ) == 0 )
    {
        _id_1282D();
        _id_12815();
        level thread _id_12840();
        level thread _id_12839();
        level thread noprone();
        level thread _id_12827();
    }
    else
        _id_1281F();

    if ( scripts\mp\utility\game::getgametype() == "br" )
    {
        level thread _id_1220F( level._id_1303C._id_12810 );
        level thread _id_12816();
        level thread _id_12813();
    }

    scripts\engine\utility::flag_set( "wztrain_array_set" );
    return 1;
}

_id_12811()
{
    var_0 = level._id_1303C.botdisablekillstreaks.modelname;

    for ( var_1 = 0; var_1 < level._id_1303C._id_12810.size; var_1++ )
    {
        var_2 = strtok( level._id_1303C._id_12810[var_1].script_noteworthy, "_" );
        var_3 = var_2[var_2.size - 1];
        var_4 = _id_12824( var_0 + var_3 );

        if ( isent( var_4 ) )
        {
            level._id_1303C._id_12810[var_1].runplunderextractsitetimer = var_4;
            level._id_1303C._id_12810[var_1].runplunderextractsitetimer markkeyframedmover();
            var_4.runpain = level._id_1303C._id_12810[var_1];
        }
    }
}

_id_12824( var_0 )
{
    var_1 = undefined;

    if ( istrue( level._id_1303C.botdisablekillstreaks.shouldgamelobbyremainintact ) )
        var_1 = getent( var_0, "script_noteworthy" );
    else
    {
        var_2 = scripts\engine\utility::getstruct( var_0, "script_noteworthy" );

        if ( isdefined( var_2 ) )
        {
            var_1 = spawn( "script_model", var_2.origin );

            if ( var_2.script_modelname == "veh8_mil_lnd_br_train_locomotive" )
                var_1 setmodel( level._id_1303C.botdisablekillstreaks._id_12325 );
            else
                var_1 setmodel( level._id_1303C.botdisablekillstreaks._id_12324 );
        }
    }

    return var_1;
}

_id_12812()
{
    for ( var_0 = 0; var_0 < level._id_1303C._id_12810.size; var_0++ )
    {
        _id_1282B( level._id_1303C._id_12810[var_0] );
        level._id_1303C._id_12810[var_0] forcenetfieldhighlod( 1 );
        level._id_1303C._id_12810[var_0] setmoveroptimized( 1 );
        level._id_1303C._id_12810[var_0] setmoverantilagged( 1 );
        level._id_1303C._id_12810[var_0] linkto( level._id_1303C._id_12810[var_0].runplunderextractsitetimer );
    }
}

_id_12814()
{
    for ( var_0 = 0; var_0 < level._id_1303C._id_12810.size; var_0++ )
    {
        var_1 = _id_12822( var_0 );

        if ( getdvarint( "scr_wztrain_anim_per_car", 0 ) )
            var_2 = "tag_origin";
        else
            var_2 = level._id_1303C._id_1283D[var_0];

        var_3 = level._id_1303C.animents[var_1] gettagorigin( var_2 );
        var_4 = level._id_1303C._id_1283E[var_0];
        level._id_1303C._id_12810[var_0].runplunderextractsitetimer forcenetfieldhighlod( 1 );
        level._id_1303C._id_12810[var_0].runplunderextractsitetimer setmoveroptimized( 1 );
        level._id_1303C._id_12810[var_0].runplunderextractsitetimer setmoverantilagged( 1 );
        level._id_1303C._id_12810[var_0].runplunderextractsitetimer.origin = var_3;

        if ( getdvarint( "scr_wztrain_anim_uselink", 0 ) > 0 )
        {
            if ( getdvarint( "scr_wztrain_anim_per_car", 0 ) > 0 )
            {
                level._id_1303C._id_12810[var_0].runplunderextractsitetimer linkto( level._id_1303C.animents[var_1], "tag_origin", var_4, ( 0, 0, 0 ) );
                continue;
            }

            level._id_1303C._id_12810[var_0].runplunderextractsitetimer linkto( level._id_1303C.animents[var_1], var_2, var_4, ( 0, 0, 0 ) );
        }
    }
}

_id_1282B( var_0 )
{
    var_0.vehiclename = "cargo_train";
    var_0.runplunderextractsitetimer.vehiclename = "cargo_train";
    var_0 thread _id_1283F();
    var_0.runplunderextractsitetimer thread _id_1283F();
}

_id_1283F()
{
    level endon( "game_ended" );
    self endon( "death" );
    self.velocity = ( 0, 0, 0 );

    for (;;)
    {
        self.lastorigin = self.origin;
        wait 0.05;
        self.velocity = ( self.origin - self.lastorigin ) / 0.05;
    }
}

_id_1283B()
{
    level notify( "obj_stop_train" );
}

_id_12816()
{
    if ( getdvarint( "scr_wztrain_noammocrate", 0 ) > 0 )
        return;

    var_0 = level._id_1303C._id_12810[1];
    var_1 = ( 20, 0, 5 );
    var_2 = ( 0, 90, 0 );
    var_3 = rotatevector( var_2, var_0.angles );
    var_4 = "military_ammo_restock_noent";
    var_5 = easepower( var_4, var_0.origin + var_1, var_3 );
    var_5 thread _id_12835( var_0, var_1, var_3 );
    var_0.bischildthread = var_5;
}

_id_12844( var_0 )
{
    level endon( "game_ended" );
    waitframe();
    _id_12820();
    level waittill( var_0 );
    _id_12821();
}

_id_12821()
{
    if ( istrue( level._id_1303C.hidedangercircle ) )
    {
        level._id_1303C.hidedangercircle = undefined;

        foreach ( var_1 in level._id_1303C._id_12810 )
        {
            if ( isdefined( var_1.runplunderextractsitetimer ) )
            {
                var_1.runplunderextractsitetimer show();
                var_1.runplunderextractsitetimer solid();
                var_1 solid();

                if ( isdefined( var_1._id_12843 ) )
                    var_1._id_12843.pickedupcoreminigun = 1;

                if ( isdefined( var_1.bischildthread ) )
                    var_1.bischildthread setscriptablepartstate( "military_ammo_restock", "USEABLE_ON" );
            }
        }
    }
}

_id_12820()
{
    if ( !istrue( level._id_1303C.hidedangercircle ) )
    {
        level._id_1303C.hidedangercircle = 1;

        foreach ( var_1 in level._id_1303C._id_12810 )
        {
            if ( isdefined( var_1.runplunderextractsitetimer ) )
            {
                var_1.runplunderextractsitetimer hide();
                var_1.runplunderextractsitetimer notsolid();
                var_1 notsolid();

                if ( isdefined( var_1._id_12843 ) )
                    var_1._id_12843.pickedupcoreminigun = 0;

                if ( isdefined( var_1.bischildthread ) )
                    var_1.bischildthread setscriptablepartstate( "military_ammo_restock", "USEABLE_OFF" );
            }
        }
    }
}

_id_1282D()
{
    var_0 = _accessreaderscriptableused::_id_12BF1( "cargo_train", 1 );
    var_0.br_onvehicledeath = 1;
    var_0.get_random_station_names_on_track = 1;
    var_0.gate_closes = 350;
    var_0.gate_flares_think = 525;
    var_0.gasvfxstructs = 875;
    var_0.gcd = 8;
    var_0.generate_achievementid = 25;
    var_0.gatherstadiumlocs = 100;
    var_0.generatecodestoshow = 0;
    var_0.generatenumbercode = 0;
    var_0.generate_solution = 1;
    var_0.nuke_cancel = ::nopropsspectate;
}

nopropsspectate( var_0, var_1 )
{
    var_2 = var_0.ent[0];

    if ( !isdefined( var_2 ) )
        return;

    var_3 = var_0.ent[1];
    var_4 = var_3 getentitynumber();

    if ( isdefined( var_2._id_12BE2 ) && isdefined( var_2._id_12BE2.size ) && var_2._id_12BE2.size > 0 )
    {
        if ( isdefined( var_2._id_12BE2[var_4] ) )
            return 0;
    }

    if ( isdefined( var_3.velocity ) )
        var_0.velocity[1] = var_3.velocity;
    else if ( isdefined( var_3 getlinkedchildren() ) )
    {
        var_5 = undefined;
        var_6 = var_3 getlinkedchildren();

        foreach ( var_8 in var_6 )
        {
            if ( isdefined( var_8.velocity ) )
            {
                var_5 = var_8.velocity;
                var_0.velocity[1] = var_5;
                break;
            }
        }
    }

    var_10 = 1;
    var_11 = 1;
    var_12 = 1;
    var_13 = 1;
    var_14 = 20;
    var_15 = 0.5;
    var_16 = 30;
    var_17 = length( var_0.velocity[0] );
    var_10 = scripts\engine\math::remap( var_17, 0, 600, var_13, var_14 );
    var_0._id_12D3B = [];
    var_0._id_12D3B[0] = vectornormalize( var_0.velocity[0] );
    var_0._id_12D3B[1] = vectornormalize( var_0.velocity[1] );
    var_18 = scripts\engine\math::anglebetweenvectorsunit( var_0._id_12D3B[0], var_0._id_12D3B[1] );
    var_11 = scripts\engine\math::remap( var_18, 0, 180, var_15, var_16 );

    if ( getdvarfloat( "scr_wztrain_vehdmgmult", -1 ) != -1 )
        var_12 = getdvarfloat( "scr_wztrain_vehdmgmult", -1 );

    var_19 = var_2.health;
    var_20 = 10;
    var_21 = var_20 * var_11 * var_10 * var_12;
    var_22 = var_21;
    var_23 = var_2.health;

    if ( var_2.health > 5 && level._id_1303C.type != "armored" )
        var_23 = var_2.health - 5;

    if ( var_21 > var_23 )
        var_21 = var_23;

    var_2 dodamage( var_21, var_3.origin, var_3, var_3, "MOD_CRUSH" );

    if ( var_2.health < var_19 )
        level thread _id_12BF4( var_2, var_3, 1 );

    return var_22;
}

_id_12BF4( var_0, var_1, var_2 )
{
    if ( !isdefined( var_0._id_12BE2 ) )
        var_0._id_12BE2 = [];

    var_3 = var_1 getentitynumber();
    var_0._id_12BE2[var_3] = var_1;
    wait( var_2 );

    if ( isdefined( var_0 ) && isdefined( var_0._id_12BE2 ) )
        var_0._id_12BE2[var_3] = undefined;

    if ( isdefined( var_0 ) && isdefined( var_0._id_12BE2 ) && var_0._id_12BE2.size == 0 )
        var_0._id_12BE2 = undefined;
}

noprone()
{
    level endon( "game_ended" );
    level endon( "obj_stop_train" );
    var_0 = level._id_1303C._id_12810[0];
    var_1 = var_0 getentitynumber();
    var_2 = 150;

    if ( getdvarfloat( "scr_wztrain_frontitemradius", 150 ) != 150 )
        var_2 = getdvarfloat( "scr_wztrain_frontitemradius", 150 );

    var_3 = physics_createcontents( [ "physicscontents_item" ] );
    var_4 = ( var_2, var_2, 200 );
    var_5 = [ var_0, var_0.runplunderextractsitetimer ];

    for (;;)
    {
        var_6 = var_0.origin + rotatevector( ( 375, 0, -100 ), var_0.angles );
        var_7 = var_6 - var_4;
        var_8 = var_6 + var_4;
        var_9 = physics_aabbbroadphasequery( var_7, var_8, var_3, var_5 );

        for ( var_10 = 0; var_10 < var_9.size; var_10++ )
        {
            var_11 = var_9[var_10];

            if ( istrue( var_11.set_scriptable_states ) )
                continue;

            if ( isdefined( var_11._id_12846 ) && isdefined( var_11._id_12846.size ) )
            {
                if ( var_11._id_12846.size > 0 )
                {
                    if ( isdefined( var_11._id_12846[var_1] ) )
                        continue;
                }
            }

            if ( isdefined( var_11.equipmentref ) )
            {
                if ( var_11.equipmentref == "equip_tac_cover" )
                {
                    if ( !var_11.collision istouching( var_0 ) )
                        continue;

                    var_11 scripts\mp\equipment\tactical_cover::tac_cover_destroy( undefined, 0 );
                    var_11.set_scriptable_states = 1;
                    continue;
                }
            }

            if ( !var_11 istouching( var_0 ) )
                continue;

            if ( isdefined( var_11.cratetype ) && var_11.cratetype == "battle_royale_loadout" )
            {
                _id_12826( var_11, var_0, var_6 );
                continue;
            }

            if ( scripts\mp\utility\entity::isturret( var_11 ) )
            {
                if ( istrue( var_11.randoexplodo ) )
                    continue;

                var_11 notify( "kill_turret", 1 );
                var_11.set_scriptable_states = 1;
                continue;
            }

            if ( _id_1281B( var_11 ) )
            {
                if ( isdefined( var_11.health ) && var_11.health > 0 )
                {
                    var_11 dodamage( var_11.health + 100, var_0.origin );
                    var_11.set_scriptable_states = 1;
                }
            }
        }

        waitframe();
    }
}

_id_1281B( var_0 )
{
    if ( !isdefined( var_0.weapon_name ) )
        return 0;

    var_1 = 0;

    switch ( var_0.weapon_name )
    {
        case "armor_box_mp":
        case "support_box_mp":
            var_1 = 1;
            break;
    }

    if ( var_1 )
        return 1;

    return 0;
}

recievedcarepackagekillstreaks( var_0, var_1, var_2 )
{
    if ( !isdefined( var_0._id_12846 ) )
        var_0._id_12846 = [];

    var_3 = var_1 getentitynumber();
    var_0._id_12846[var_3] = var_1;
    wait( var_2 );

    if ( isdefined( var_0 ) && isdefined( var_0._id_12846 ) )
        var_0._id_12846[var_3] = undefined;

    if ( isdefined( var_0 ) && isdefined( var_0._id_12846 ) && var_0._id_12846.size == 0 )
        var_0._id_12846 = undefined;
}

_id_12826( var_0, var_1, var_2 )
{
    if ( !istrue( var_0.participantweaponxp ) )
    {
        var_3 = var_1.velocity * 150;
        var_0 playsound( "mp_care_package_high_impact" );
        var_0 physicslaunchserver( var_2, var_3 );
        var_0.participantweaponxp = 1;
        level thread recievedcarepackagekillstreaks( var_0, var_1, 1 );
    }
    else
    {
        var_0 scripts\cp_mp\killstreaks\airdrop::destroycrate();
        var_0.set_scriptable_states = 1;
    }
}

_id_12827()
{
    level endon( "game_ended" );
    level endon( "obj_stop_train" );

    if ( !isdefined( level.mines ) )
        level.mines = [];

    var_0 = level._id_1303C._id_12810[0];
    var_1 = var_0 getentitynumber();
    var_2 = 150;

    if ( getdvarfloat( "scr_wztrain_frontitemradius", 150 ) != 150 )
        var_2 = getdvarfloat( "scr_wztrain_frontitemradius", 150 );

    var_3 = var_2 - 25;
    var_4 = var_3 * var_3;

    for (;;)
    {
        var_5 = level.mines;

        if ( var_5.size > 0 )
        {
            var_6 = var_0.origin + rotatevector( ( 375, 0, -100 ), var_0.angles );

            foreach ( var_8 in var_5 )
            {
                if ( !isdefined( var_8 ) )
                    continue;

                if ( istrue( var_8.set_scriptable_states ) )
                    continue;

                if ( distance2dsquared( var_8.origin, var_6 ) > var_4 )
                    continue;

                if ( distancesquared( var_8.origin, var_6 ) > var_4 )
                    continue;

                if ( isdefined( var_8.weapon_name ) )
                {
                    if ( var_8.weapon_name == "trophy_mp" )
                    {
                        var_8 scripts\mp\equipment\trophy_system::sweeptrophy();
                        var_8.set_scriptable_states = 1;
                        continue;
                    }

                    if ( var_8.weapon_name == "claymore_mp" )
                    {
                        var_8 scripts\mp\equipment\claymore::sweepclaymore();
                        var_8.set_scriptable_states = 1;
                        continue;
                    }

                    if ( var_8.weapon_name == "at_mine_mp" )
                    {
                        var_8 scripts\mp\equipment\at_mine::at_mine_destroy();
                        var_8.set_scriptable_states = 1;
                        continue;
                    }

                    if ( var_8.weapon_name == "tac_insert_trigger" )
                    {
                        var_8 scripts\mp\equipment\tac_insert::deletetacinsert();
                        var_8.set_scriptable_states = 1;
                    }
                }
            }
        }

        waitframe();
    }
}

_id_1282C()
{
    var_0 = 0;

    foreach ( var_2 in level._id_1303C._id_12810 )
    {
        var_3 = var_2.script_noteworthy;
        var_4 = var_3 + "_loot";
        var_5 = scripts\engine\utility::getstructarray( var_4, "targetname" );
        var_0 = var_0 + var_5.size;
    }

    level._id_1303C._id_12793 = var_0;
    _id_1282E( level._id_1303C._id_12810 );

    if ( isdefined( level._id_1303C._id_12810 ) )
    {
        level._id_1303C._id_12810[0].handle_settings_for_techo_group = ( -95, -5, 200 );
        level._id_1303C._id_12810[0].handle_roof_spawning = ( 0, 180, 0 );
        level._id_1303C._id_12810[0].handle_train_veh_collision = 3;
        level._id_1303C._id_12810[1].handle_settings_for_techo_group = ( -135, -50, 49 );
        level._id_1303C._id_12810[1].handle_roof_spawning = ( 0, 80, 0 );
        level._id_1303C._id_12810[1].handle_train_veh_collision = 0;
        level._id_1303C._id_12810[5].handle_settings_for_techo_group = ( -80, -50, 49 );
        level._id_1303C._id_12810[5].handle_roof_spawning = ( 0, 70, 0 );
        level._id_1303C._id_12810[5].handle_train_veh_collision = 0;
        level._id_1303C._id_12810[7].handle_settings_for_techo_group = ( -150, 45, 49 );
        level._id_1303C._id_12810[7].handle_roof_spawning = ( 0, 180, 0 );
        level._id_1303C._id_12810[7].handle_train_veh_collision = 0;
    }
}

trial_vehicles()
{
    level endon( "game_ended" );
    scripts\engine\utility::flag_set( "wztrain_spawn_started" );
    level thread _id_12833();
    level thread _id_1282F( 3 );
    level waittill( "obj_stop_train" );
    level thread _id_12830();
}

_id_1282F( var_0 )
{
    level endon( "game_ended" );
    level endon( "obj_stop_train" );
    scripts\engine\utility::flag_wait( "wztrain_anim_playing" );
    wait( var_0 );
    var_1 = level._id_1303C._id_12810[1];
    var_2 = "";

    if ( isdefined( level.cleanupswaploadoutflags ) && isdefined( level.cleanupswaploadoutflags._id_12850 ) )
        var_2 = level.cleanupswaploadoutflags._id_12850;

    var_3 = level._id_1303C.botdisablekillstreaks.scriptable_door_get_in_radius;

    foreach ( var_1 in level._id_1303C._id_12810 )
    {
        var_5 = ( 0, 0, 300 );
        var_6 = ( 0, 0, 0 );
        var_7 = rotatevector( var_6, var_1.angles );

        if ( var_2 == "armored" )
            var_8 = "br_armortrain";
        else
            var_8 = "br_cargotrain";

        if ( isdefined( var_1.script_noteworthy ) && var_2 == "armored" && var_1.script_noteworthy == var_3 )
            var_8 = "br_armortrain_engine";
        else if ( isdefined( var_1.script_noteworthy ) && var_1.script_noteworthy == var_3 )
            var_8 = "br_cargotrain_engine";

        var_9 = easepower( var_8, var_1.origin + var_5, var_7 );
        var_9 thread _id_12835( var_1, var_5, var_7 );

        if ( var_2 == "armored" )
            var_9 setscriptablepartstate( "br_armortrain", "visible" );
        else
            var_9 setscriptablepartstate( "br_cargotrain", "visible" );

        var_9.forcegivekillstreak = 1;
        var_1.chopper_gunner_assignedtargetmarkers_onnewai = var_9;
    }

    scripts\engine\utility::flag_set( "wztrain_icons_attached" );
}

_id_12830()
{
    foreach ( var_1 in level._id_1303C._id_12810 )
    {
        if ( isdefined( var_1.chopper_gunner_assignedtargetmarkers_onnewai ) )
        {
            if ( level.cleanupswaploadoutflags._id_12850 == "armored" )
            {
                var_1.chopper_gunner_assignedtargetmarkers_onnewai setscriptablepartstate( "br_armortrain", "hidden" );
                continue;
            }

            var_1.chopper_gunner_assignedtargetmarkers_onnewai setscriptablepartstate( "br_cargotrain", "hidden" );
        }
    }
}

_id_1282E( var_0 )
{
    foreach ( var_2 in var_0 )
    {
        var_3 = var_2.script_noteworthy;
        var_4 = var_3 + "_loot";
        var_5 = scripts\engine\utility::getstructarray( var_4, "targetname" );
        var_2.semtex_killstuckplayer = [];

        for ( var_6 = 0; var_6 < var_5.size; var_6++ )
        {
            var_7 = var_5[var_6].origin - var_2.origin;
            var_8 = rotatevectorinverted( var_7, var_2.angles );
            var_2.semtex_killstuckplayer[var_6] = var_8;
        }
    }
}

_id_1220F( var_0 )
{
    if ( getdvarint( "scr_wztrain_cratespawn", 1 ) == 0 )
        return;

    scripts\engine\utility::flag_wait( "wztrain_array_set" );
    var_1 = 4;
    var_2 = 0;
    var_3 = 0;

    if ( getdvarint( "scr_wztrain_legecrates", 0 ) > 0 )
        var_1 = getdvarint( "scr_wztrain_legecrates", 0 );

    if ( var_1 > level._id_1303C._id_12793 )
        var_1 = level._id_1303C._id_12793;

    foreach ( var_5 in var_0 )
    {
        var_6 = var_5.script_noteworthy;
        var_7 = var_6 + "_loot";
        var_8 = scripts\engine\utility::getstructarray( var_7, "targetname" );

        for ( var_9 = 0; var_9 < var_8.size; var_9++ )
        {
            var_10 = "br_loot_cache";

            if ( var_3 > level._id_1303C._id_12793 - var_1 )
            {
                if ( var_2 < var_1 )
                {
                    var_10 = "br_loot_cache_lege";
                    var_2++;
                }
            }
            else if ( var_2 < var_1 && scripts\engine\utility::cointoss() )
            {
                var_10 = "br_loot_cache_lege";
                var_2++;
            }

            var_11 = var_5.semtex_killstuckplayer[var_9];
            var_12 = var_8[var_9].angles;
            var_13 = easepower( var_10, var_5.origin + var_11, var_12 );
            scripts\mp\gametypes\br_pickups.gsc::_id_11959( var_13 );
            var_13 thread _id_12835( var_5, var_11, var_12 );
            var_13.forcegivekillstreak = 1;

            if ( var_13 getscriptablehaspart( "body" ) )
                var_13 setscriptablepartstate( "body", "closed_nocol" );

            var_3++;
            waitframe();
        }
    }
}

_id_12835( var_0, var_1, var_2 )
{
    level endon( "game_ended" );
    wait 1;
    self scriptablesetparententity( var_0, var_1, var_2 );
}

_id_12815()
{
    foreach ( var_1 in level._id_1303C._id_12810 )
    {
        var_2 = var_1.script_noteworthy;
        var_3 = var_2 + "_train_front_hurt";
        var_4 = getent( var_3, "script_noteworthy" );

        if ( isent( var_4 ) )
        {
            var_1._id_12843 = var_4;
            var_1._id_12843 enablelinkto();
            var_1._id_12843 linkto( var_1 );
            var_1._id_12843 thread _id_12829( var_1 );
        }
    }
}

_id_1281F()
{
    foreach ( var_1 in level._id_1303C._id_12810 )
    {
        var_2 = var_1.script_noteworthy;
        var_3 = var_2 + "_train_front_hurt";
        var_4 = getent( var_3, "script_noteworthy" );

        if ( isdefined( var_4 ) )
            var_4 delete();
    }
}

_id_12813()
{
    level endon( "game_ended" );
    level endon( "obj_stop_train" );
    var_0 = getdvarint( "scr_wztrain_contractspawn", 0 );

    if ( var_0 == 0 )
        return;

    var_1 = level._id_1303C._id_12810[3];

    if ( !isdefined( var_1 ) || !isent( var_1 ) )
        return;

    var_2 = ( -85, 0, -25 );
    var_3 = ( 0, 0, 0 );
    var_4 = rotatevector( var_3, var_1.angles );
    var_5 = "brloot_domination_tablet";
    var_6 = 45;
    var_7 = getdvarint( "scr_wztrain_contractdelay", 60 );

    if ( var_7 != 60 )
        var_6 = var_7;

    level._id_1303C.handle_truck_spawning = 1;
    var_8 = getdvarint( "scr_wztrain_domflare", 1 );

    if ( var_8 == 0 )
        level._id_1303C.handle_truck_spawning = 0;

    var_9 = getdvarint( "scr_wztrain_domnocol", 1 );

    if ( var_9 == 1 )
        level._id_1303C.handle_set_respawn_overrides = 1;

    var_1._id_1281D = [];
    level._id_1303C.extractiontime = 0;
    level._id_1303C.extractionmethod = 0;

    if ( !isdefined( level._id_1303C.funcs ) )
        level._id_1303C.funcs = spawnstruct();

    level._id_1303C.funcs.bomb_vest_timer_frozen = scripts\mp\vehicles\little_bird_mg_mp::bomb_vest_timer_frozen;
    level._id_1303C.funcs.bomb_vest_explodes = scripts\mp\vehicles\little_bird_mg_mp::bomb_vest_explodes;
    level thread _id_1282A();
    scripts\engine\utility::flag_wait( "wztrain_icons_attached" );

    for (;;)
    {
        while ( istrue( level._id_1303C.bridge_two_death_func ) )
            wait 5;

        var_10 = easepower( var_5, var_1.origin + var_2, var_4 );
        scripts\mp\gametypes\br_pickups.gsc::_id_11959( var_10 );
        var_10 scriptablesetparententity( var_1, var_2, var_4 );
        var_10.stimmodelattached = 1;
        var_10.keepinmap = 1;
        var_10.playoverwatch_dialogue_with_endon = scripts\mp\vehicles\little_bird_mg_mp::handle_respawn_via_c130;
        var_10.forcegivekillstreak = 1;

        if ( soundexists( "br_pickup_generic_3d" ) )
            playsoundatpos( var_1.origin + var_2, "br_pickup_generic_3d" );

        var_1._id_1281D[var_1._id_1281D.size] = var_10;
        level._id_1303C._id_1281C = var_10;
        level._id_1303C waittill( "train_dom_contract_complete", var_11 );

        if ( isdefined( var_11 ) )
            level._id_1303C.extractionmethod++;

        if ( isdefined( var_11 ) && isdefined( var_11.result ) && var_11.result == "success" )
        {
            level._id_1303C.extractiontime++;

            if ( getdvarint( "scr_wztrain_domloot", 1 ) > 0 )
            {
                var_11.itemsdropped = 0;
                var_11.count = 0;
                var_11.origin = var_11._id_11B21;
                var_11.angles = var_11._id_11B1E;
                var_11.fxred = 0;
                var_12 = var_11.fxred;
                var_13 = getdvarint( "scr_wztrain_domloot_armor", 2 );
                var_14 = getdvarint( "scr_wztrain_domloot_ar", 1 );
                var_15 = getdvarint( "scr_wztrain_domloot_smg", 1 );
                var_16 = getdvarint( "scr_wztrain_domloot_sh", 1 );
                var_17 = getdvarint( "scr_wztrain_domloot_sn", 1 );
                var_18 = getdvarint( "scr_wztrain_domloot_la", 1 );
                var_19 = [];

                for ( var_20 = 0; var_20 < var_13; var_20++ )
                    var_19[var_19.size] = "brloot_armor_plate";

                for ( var_20 = 0; var_20 < var_14; var_20++ )
                    var_19[var_19.size] = "brloot_ammo_762";

                for ( var_20 = 0; var_20 < var_15; var_20++ )
                    var_19[var_19.size] = "brloot_ammo_919";

                for ( var_20 = 0; var_20 < var_16; var_20++ )
                    var_19[var_19.size] = "brloot_ammo_12g";

                if ( scripts\engine\utility::cointoss() )
                {
                    for ( var_20 = 0; var_20 < var_17; var_20++ )
                        var_19[var_19.size] = "brloot_ammo_50cal";
                }
                else
                {
                    for ( var_20 = 0; var_20 < var_18; var_20++ )
                        var_19[var_19.size] = "brloot_ammo_rocket";
                }

                var_21 = getdvarint( "scr_wztrain_domloot_sp_num", 0 );
                var_22 = getdvar( "scr_wztrain_domloot_sp_name", "" );

                if ( var_21 > 0 && var_22 != "" )
                {
                    for ( var_20 = 0; var_20 < var_21; var_20++ )
                        var_19[var_19.size] = var_22;
                }

                if ( isdefined( var_19 ) && var_19.size > 0 )
                    var_23 = var_11 scripts\mp\gametypes\br_lootcache.gsc::select_bunker_interior_four_spawners( var_19 );
            }
        }

        wait( var_6 );
    }
}

_id_1282A()
{
    level endon( "game_ended" );
    level endon( "obj_stop_train" );

    for (;;)
    {
        if ( scripts\mp\vehicles\little_bird_mg_mp::bomb_vest_explodes() )
        {
            level._id_1303C.bridge_two_death_func = 1;

            if ( isdefined( level._id_1303C._id_1281C ) )
            {
                var_0 = level._id_1303C._id_1281C;
                var_1 = var_0 getscriptablepartstate( "brloot_domination_tablet" );

                if ( var_1 == "visible" )
                {
                    var_0 scripts\mp\gametypes\br_pickups.gsc::getcoremapdropzones();

                    if ( isdefined( level._id_1303C._id_1281C ) )
                        level._id_1303C._id_1281C = undefined;

                    level._id_1303C notify( "train_dom_contract_complete" );
                }
            }
        }
        else
            level._id_1303C.bridge_two_death_func = 0;

        wait 5;
    }
}

_id_12829( var_0 )
{
    level endon( "game_ended" );
    self endon( "death" );
    var_1 = 1;

    if ( getdvarfloat( "scr_wztrain_playerdmgmult", -1 ) != -1 )
        var_1 = getdvarfloat( "scr_wztrain_playerdmgmult", -1 );

    self.pickedupcoreminigun = 1;
    self.recentghostridekillcount = 1;

    for (;;)
    {
        self waittill( "trigger", var_2 );

        if ( !istrue( self.pickedupcoreminigun ) )
            continue;

        if ( isplayer( var_2 ) && isalive( var_2 ) && ( istrue( var_2.inlaststand ) || var_2 istouching( var_0 ) || var_2 istouching( var_0.runplunderextractsitetimer ) ) )
            var_2 dodamage( var_2.health + 1000 * var_1, self.origin, var_2, self, "MOD_TRIGGER_HURT" );
    }
}

_id_12840()
{
    level endon( "game_ended" );

    if ( level._id_1303C.type == "armored" )
        return;

    scripts\engine\utility::flag_wait( "wztrain_anim_playing" );
    wait 0.1;

    if ( getdvarint( "scr_wztrain_delayfx", -1 ) != -1 )
    {
        var_0 = level._id_1303C._id_12810[0].runplunderextractsitetimer;
        var_1 = scripts\engine\utility::getfx( "vrx_br_train_engine" );
        playfxontag( var_1, var_0, "tag_origin" );
        var_2 = scripts\engine\utility::getfx( "vrx_br_train_flatbed" );

        for ( var_3 = 1; var_3 < level._id_1303C._id_12810.size; var_3++ )
        {
            var_4 = level._id_1303C._id_12810[var_3].runplunderextractsitetimer;
            playfxontag( var_2, var_4, "tag_origin" );
        }
    }
    else
    {
        foreach ( var_6 in level._id_1303C._id_12810 )
        {
            if ( var_6.runplunderextractsitetimer getscriptablehaspart( "train_part" ) )
                var_6.runplunderextractsitetimer setscriptablepartstate( "train_part", "moving" );
        }
    }
}

_id_12839()
{
    level endon( "game_ended" );
    scripts\engine\utility::flag_wait( "wztrain_anim_playing" );
    wait 0.1;

    for ( var_0 = 0; var_0 < level._id_1303C._id_12810.size; var_0++ )
    {
        if ( soundexists( "veh_cargotrain_lp_" + var_0 ) )
            level._id_1303C._id_12810[var_0].runplunderextractsitetimer playloopsound( "veh_cargotrain_lp_" + var_0 );
    }
}

_id_12828( var_0 )
{
    var_1 = level._id_1303C._id_12810[0].runplunderextractsitetimer;
    var_1 playsoundonmovingent( "veh_horn_cargotrain" );
}

_id_12833()
{
    level endon( "game_ended" );
    var_0 = 20;

    if ( getdvarint( "scr_wztrain_introdelay", -1 ) != -1 )
        var_0 = getdvarint( "scr_wztrain_introdelay", -1 );

    if ( var_0 > 0 )
        wait( var_0 );

    if ( getdvarint( "scr_wztrain_decho_spawn", 0 ) )
    {
        var_1 = getent( "train_car_50", "script_noteworthy" );

        if ( isdefined( var_1 ) )
        {
            var_2 = spawnstruct();
            var_2.origin = var_1.origin + ( 0, 0, 58 );
            var_2.spawntype = "DEVGUI";

            if ( isdefined( var_1.angles ) )
                var_2.angles = var_1.angles;

            var_3 = scripts\cp_mp\vehicles\jeep::jeep_create( var_2 );
            wait 0.1;
            var_3 vehicle_turnengineoff();
            wait 1;
        }
    }

    scripts\engine\utility::flag_set( "wztrain_anim_playing" );
    var_4 = _id_12825();
    var_5 = level._id_1303C.animstruct.origin;
    var_6 = level._id_1303C.animstruct.angles;

    for ( var_7 = 0; var_7 < var_4; var_7++ )
    {
        level._id_1303C.animents[var_7].quickdropremovearmorfrominventory = 1;
        level._id_1303C.animents[var_7] notsolid();
        level._id_1303C.animents[var_7] dontinterpolate();
        var_8 = level._id_1303C.animents[var_7].blueprintextract_trygetreward;
        level._id_1303C.animstruct thread scripts\common\anim::anim_loop_solo( level._id_1303C.animents[var_7], var_8 );

        if ( getdvarint( "scr_wztrain_randomstart", 1 ) > 0 )
        {
            level._id_1303C.animstruct thread _id_12836( level._id_1303C.animents[var_7], var_8 );
            continue;
        }

        var_9 = getdvarfloat( "scr_wztrain_ratio_start", -1 );

        if ( var_9 >= 0 )
            level._id_1303C.animstruct thread _id_12837( level._id_1303C.animents[var_7], var_8, var_9 );
    }

    if ( getdvarint( "scr_wztrain_anim_uselink", 0 ) == 0 )
    {
        for (;;)
        {
            for ( var_7 = 0; var_7 < level._id_1303C._id_12810.size; var_7++ )
            {
                var_10 = level._id_1303C._id_1283E[var_7];
                var_11 = level._id_1303C._id_1283D[var_7];
                var_12 = _id_12822( var_7 );
                var_13 = level._id_1303C.animents[var_12] gettagorigin( var_11 );
                var_14 = level._id_1303C.animents[var_12] gettagangles( var_11 );
                var_15 = anglestoaxis( var_14 );
                var_13 = var_13 + var_15["forward"] * var_10[0];
                var_13 = var_13 + var_15["right"] * var_10[1];
                var_13 = var_13 + var_15["up"] * var_10[2];
                var_16 = 0.1;
                var_13 = vectorlerp( level._id_1303C._id_12810[var_7].runplunderextractsitetimer.origin, var_13, var_16 );
                var_14 = scripts\engine\math::fake_slerp( level._id_1303C._id_12810[var_7].runplunderextractsitetimer.angles, var_14, var_16 );
                level._id_1303C._id_12810[var_7].runplunderextractsitetimer.origin = var_13;
                level._id_1303C._id_12810[var_7].runplunderextractsitetimer.angles = var_14;
            }

            waitframe();
        }
    }
}

_id_12834()
{
    setdvarifuninitialized( "scr_wztrain_anim_per_car", 0 );
    level.scr_animtree["br_cargo_train_anim"] = #animtree;
    level.scr_anim["br_cargo_train_anim"]["full_anim"][0] = %iw8_mp_verdansk_train;
    level.scr_animname["br_cargo_train_anim"]["full_anim"][0] = "iw8_mp_verdansk_train";
    level.scr_anim["br_cargo_train_anim"]["full_anim_290"][0] = level._id_1303C.botdisablekillstreaks.anime;
    level.scr_animname["br_cargo_train_anim"]["full_anim_290"][0] = level._id_1303C.botdisablekillstreaks.animname;
    scripts\common\anim::addnotetrack_customfunction( "br_cargo_train_anim", "br_train_horn", ::_id_12828 );
    level.scr_anim["br_cargo_train_anim"]["test_anim"][0] = %iw8_mp_verdansk_train_test_straight;
    level.scr_animname["br_cargo_train_anim"]["test_anim"][0] = "iw8_mp_verdansk_train_test_straight";
    level.scr_anim["br_cargo_train_anim"]["test_anim_290"][0] = %iw8_mp_verdansk_train_test_straight_290;
    level.scr_animname["br_cargo_train_anim"]["test_anim_290"][0] = "iw8_mp_verdansk_train_test_straight_290";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_01"] = %iw8_mp_verdansk_train_cars_290_01;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_01"] = "iw8_mp_verdansk_train_cars_290_01";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_02"] = %iw8_mp_verdansk_train_cars_290_02;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_02"] = "iw8_mp_verdansk_train_cars_290_02";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_03"] = %iw8_mp_verdansk_train_cars_290_03;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_03"] = "iw8_mp_verdansk_train_cars_290_03";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_04"] = %iw8_mp_verdansk_train_cars_290_04;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_04"] = "iw8_mp_verdansk_train_cars_290_04";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_05"] = %iw8_mp_verdansk_train_cars_290_05;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_05"] = "iw8_mp_verdansk_train_cars_290_05";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_06"] = %iw8_mp_verdansk_train_cars_290_06;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_06"] = "iw8_mp_verdansk_train_cars_290_06";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_07"] = %iw8_mp_verdansk_train_cars_290_07;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_07"] = "iw8_mp_verdansk_train_cars_290_07";
    level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_08"] = %iw8_mp_verdansk_train_cars_290_08;
    level.scr_animname["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_08"] = "iw8_mp_verdansk_train_cars_290_08";
    level._id_1303C._id_1283D = [];
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_locomotive_joint_01";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_flatbed_joint_01";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_flatbed_joint_02";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_cart_joint_01";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_flatbed_joint_03";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_flatbed_joint_04";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_flatbed_joint_05";
    level._id_1303C._id_1283D[level._id_1303C._id_1283D.size] = "veh8_train_flatbed_joint_06";
    level._id_1303C._id_1283E = [];
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    level._id_1303C._id_1283E[level._id_1303C._id_1283E.size] = ( 0, 0, 0 );
    waitframe();
    var_0 = ( -9661, -9119, -299.007 );
    var_1 = ( 0, 0, 0 );

    if ( isdefined( level._id_1303C.bmoovertime ) )
        var_0 = level._id_1303C.bmoovertime;

    level._id_1303C.animstruct = spawnstruct();
    level._id_1303C.animstruct.origin = var_0;
    level._id_1303C.animstruct.angles = var_1;
    level._id_1303C.animents = [];
    var_2 = _id_12825();
    var_3 = level._id_1303C.botdisablekillstreaks.bot_update_difficultysetttings;

    for ( var_4 = 0; var_4 < var_2; var_4++ )
    {
        level._id_1303C.animents[var_4] = spawn( "script_model", level._id_1303C.animstruct.origin );

        if ( getdvarint( "scr_wztrain_anim_per_car", 0 ) > 0 )
            level._id_1303C.animents[var_4] setmodel( "tag_origin" );
        else
            level._id_1303C.animents[var_4] setmodel( var_3 );

        level._id_1303C.animents[var_4].angles = level._id_1303C.animstruct.angles;
        level._id_1303C.animents[var_4].animname = "br_cargo_train_anim";
        level._id_1303C.animents[var_4] useanimtree( level.scr_animtree["br_cargo_train_anim"] );
        level._id_1303C.animents[var_4] forcenetfieldhighlod( 1 );
        level._id_1303C.animents[var_4] setmoveroptimized( 1 );
        level._id_1303C.animents[var_4] setmoverantilagged( 1 );
        level._id_1303C.animents[var_4] hideallparts();
        level._id_1303C.animents[var_4].blueprintextract_trygetreward = _id_12823( var_4 + 1 );
    }
}

_id_12836( var_0, var_1 )
{
    var_2 = level.scr_anim["br_cargo_train_anim"][var_1][0];

    if ( !isdefined( var_2 ) )
        return;

    var_3 = getanimlength( var_2 );
    var_4 = randomfloatrange( 0, var_3 - 10 );

    if ( !isdefined( var_3 ) || !isdefined( var_4 ) )
        return;

    waittillframeend;
    var_0 setanimtime( var_2, var_4 / var_3 );
}

_id_12837( var_0, var_1, var_2 )
{
    var_3 = level.scr_anim["br_cargo_train_anim"][var_1][0];

    if ( !isdefined( var_3 ) )
        return;

    waittillframeend;
    var_0 setanimtime( var_3, var_2 );

    if ( getdvarint( "scr_wztrain_immobilized", 0 ) == 1 )
        var_0 setanimrate( var_3, 0 );
}

_id_12825()
{
    var_0 = 1;

    if ( getdvarint( "scr_wztrain_anim_per_car", 0 ) )
        var_0 = 8;

    return var_0;
}

_id_12823( var_0 )
{
    var_1 = _id_12825();

    if ( var_1 == 1 )
    {
        if ( getdvarint( "scr_slower_wztrain", 0 ) )
            var_2 = "full_anim";
        else if ( isdefined( level._id_1303C.blueprintextract_trygetreward ) )
            var_2 = level._id_1303C.blueprintextract_trygetreward;
        else
            var_2 = "full_anim_290";
    }
    else if ( isdefined( level.scr_anim["br_cargo_train_anim"]["iw8_mp_verdansk_train_cars_290_0" + var_0] ) )
        var_2 = "iw8_mp_verdansk_train_cars_290_0" + var_0;
    else
        var_2 = "full_anim_290";

    return var_2;
}

_id_12822( var_0 )
{
    var_1 = _id_12825();

    if ( var_1 == 1 )
        return 0;
    else
        return var_0;
}

_id_12817( var_0 )
{
    if ( !isdefined( level._id_1303C.animents[0] ) )
        return;

    if ( !isdefined( level._id_1303C.animents[0].bomb_case_detonator_timer_bar_think ) )
        level._id_1303C.animents[0].bomb_case_detonator_timer_bar_think = 1;

    var_1 = level._id_1303C.animents[0].blueprintextract_trygetreward;
    var_2 = level.scr_anim["br_cargo_train_anim"][var_1][0];
    level._id_1303C.animents[0] thread _id_12818( var_0, var_2 );
}

_id_12818( var_0, var_1 )
{
    level notify( "train_braking" );
    self endon( "train_braking" );
    self endon( "train_accelerating" );
    var_2 = 0.1;
    var_3 = self.bomb_case_detonator_timer_bar_think / var_0 * var_2;
    level._id_1303C._id_12810[0].runplunderextractsitetimer setscriptablepartstate( "speed", "braking" );

    while ( self.bomb_case_detonator_timer_bar_think > 0 )
    {
        self.bomb_case_detonator_timer_bar_think = max( self.bomb_case_detonator_timer_bar_think - var_3, 0 );
        self setanimrate( var_1, self.bomb_case_detonator_timer_bar_think );
        wait( var_2 );
    }

    level._id_1303C._id_12810[0].runplunderextractsitetimer setscriptablepartstate( "speed", "stopped" );
}

_id_1280E( var_0, var_1 )
{
    if ( !isdefined( level._id_1303C.animents[0] ) )
        return;

    if ( !isdefined( level._id_1303C.animents[0].bomb_case_detonator_timer_bar_think ) )
        level._id_1303C.animents[0].bomb_case_detonator_timer_bar_think = 1;

    var_2 = level._id_1303C.animents[0].blueprintextract_trygetreward;
    var_3 = level.scr_anim["br_cargo_train_anim"][var_2][0];
    level._id_1303C.animents[0] thread _id_1280F( var_0, var_1, var_3 );
}

_id_1280F( var_0, var_1, var_2 )
{
    level notify( "train_accelerating" );
    self endon( "train_accelerating" );
    self endon( "train_braking" );
    var_3 = 0.1;
    var_4 = var_1 * var_3;
    level._id_1303C._id_12810[0].runplunderextractsitetimer setscriptablepartstate( "speed", "accel" );

    while ( self.bomb_case_detonator_timer_bar_think < var_0 )
    {
        self.bomb_case_detonator_timer_bar_think = min( self.bomb_case_detonator_timer_bar_think + var_1, var_0 );
        self setanimrate( var_2, self.bomb_case_detonator_timer_bar_think );
        wait( var_3 );
    }

    self setanimrate( var_2, var_0 );
    level._id_1303C._id_12810[0].runplunderextractsitetimer setscriptablepartstate( "speed", "moving" );
}

ffsm_landed_stateenter()
{
    level endon( "game_ended" );

    for (;;)
        wait 1;
}

any_player_nearby( var_0, var_1 )
{
    foreach ( var_3 in level.players )
    {
        if ( distancesquared( var_3.origin, var_0 ) < var_1 )
            return 1;
    }

    return 0;
}

_id_12EBD()
{
    level endon( "game_ended" );

    if ( getdvarint( "scr_wztrain_warpto", 0 ) == 0 )
        return;

    while ( !isdefined( level.player ) || !isalive( level.player ) )
        wait 0.1;

    level.player endon( "death_or_disconnect" );
    wait 1;
    level thread get_gunshot_alias();
    level.player waittill( "skydive_deployparachute" );
    wait 0.5;
    var_0 = level._id_1303C._id_12810[0].origin;
    level.player setorigin( var_0 + ( 0, 0, 4096 ) );
}

get_gunshot_alias()
{
    level endon( "game_ended" );
    level.player endon( "disconnect" );
    level.player notifyonplayercommand( "dpad_left_press", "+actionslot 3" );

    for (;;)
    {
        level.player waittill( "dpad_left_press" );
        var_0 = level._id_1303C._id_12810[1].origin;

        foreach ( var_2 in level.players )
            var_2 setorigin( var_0 + ( 0, 0, 200 ) );

        waitframe();
    }
}

get_combat_alias( var_0, var_1 )
{

}

call_exfil()
{
    level endon( "game_ended" );

    for (;;)
    {
        wait 1;

        foreach ( var_1 in level._id_1303C._id_12810 )
            var_1.runplunderextractsitetimer hide();

        wait 1;

        foreach ( var_1 in level._id_1303C._id_12810 )
            var_1.runplunderextractsitetimer show();
    }
}
