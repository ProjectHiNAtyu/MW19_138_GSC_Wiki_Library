// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    level.tower_ground_mortar_2 = spawnstruct();
    level.tower_ground_mortar_2.settings = spawnstruct();
    level.tower_ground_mortar_2.settings.waittill_any_return_5 = getdvarint( "scr_br_prop_hide_time", 30 );
    level.tower_ground_mortar_2.settings.waittill_scout_drone_defined = getdvarint( "scr_br_prop_whistle_time", 30 );
    level.tower_ground_mortar_2.settings.waitthencheckendgame = getdvarint( "scr_br_prop_num_changes", 2 );
    level.tower_ground_mortar_2.settings.waittill_any_timeout_no_endon_death_4 = getdvarint( "scr_br_prop_num_flahes", 1 );
    level.tower_ground_mortar_2.settings.waittill_any_timeout_no_endon_death_3 = getdvarint( "scr_br_prop_num_clones", 3 );
    level.tower_ground_mortar_2.settings.waittill_player_completes_scavenger_contract = getdvarfloat( "scr_br_prop_speed_scale", 1.4 );
    level.tower_ground_mortar_2.settings.show_getcash_hint = getdvarint( "scr_br_prop_mode", 0 );
    level.tower_ground_mortar_2.settings.start_conceal_add = getdvarint( "scr_br_prop_hunters", 20 );
    level.tower_ground_mortar_2.settings.start_coop_escape_end_camera = getdvarint( "scr_br_prop_num_per_area", 30 );

    if ( level.tower_ground_mortar_2.settings.show_getcash_hint == 1 )
    {
        scripts\mp\utility\game::registerroundswitchdvar( level.gametype, 1, 0, 9 );
        scripts\mp\utility\game::registertimelimitdvar( level.gametype, 4 );
        scripts\mp\utility\game::registerscorelimitdvar( level.gametype, 0 );
        scripts\mp\utility\game::registerroundlimitdvar( level.gametype, 4 );
        scripts\mp\utility\game::registerwinlimitdvar( level.gametype, 3 );
        scripts\mp\utility\game::registernumlivesdvar( level.gametype, 1 );
        scripts\mp\utility\game::registerhalftimedvar( level.gametype, 0 );
        level.objectivebased = 1;
        level.disablewinonscore = ::tr_circletick;
        level.manageminigunpickup = ::manageparachute;
        level.kicknullmusicondeath = ::kicknullmusicondeath;
    }

    level.race_requires_vehicle = 1;
    level.allowlatecomers = 1;
    level.branalytics_playercount = 1;
    level.custom_death_sound = ::trophy_protection_success;
    level.give_player_saw = ::give_player_knife_on_respawn;
    level.doclocksound = ::doclocksound;
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "onStartGameType", ::onstartgametype );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "modifyPlayerDamage", ::gamemodemodifyplayerdamage );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "onPlayerConnect", ::onplayerconnect );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "playerSkipLootPickup", ::validate_demeanor );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "onPlayerKilled", ::onplayerkilled );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "playerPreSpawnGulagJail", ::updatex1prematchloadoutarray );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "playerNakedDropLoadout", ::updatecollectionui );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "getInfilPlayers", ::manualturret_toggleallowuseactions );
    scripts\mp\gametypes\br_gametypes.gsc::zombienumhitshuman( "dropOnPlayerDeath", ::droponplayerdeath );
    scripts\mp\gametypes\br_gametypes.gsc::give_fists( "plunderSites" );
    scripts\mp\gametypes\br_gametypes.gsc::give_fists( "drogBagLoadout" );
    scripts\mp\gametypes\br_gametypes.gsc::give_fists( "oneLife" );
    scripts\mp\gametypes\br_gametypes.gsc::give_fists( "waitLoadoutDone" );
    scripts\mp\gametypes\br_gametypes.gsc::give_fists( "armor" );
    scripts\mp\gametypes\br_gametypes.gsc::give_fists( "squadLeader" );
    level.tower_ground_mortar_2.script_model_pilot_kill_watch = [];
    level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3 = [];
    level.tower_ground_mortar_2.ai_ground_set_goal_radii = [ "FLASH", "CLONE" ];
    level thread tank_check_for_damage();
    level thread playerzombiedelayturnonfx();
    level.teammaxfill = 0;
    game["attackers"] = "allies";
    game["defenders"] = "axis";
}

playerzombiedelayturnonfx()
{
    waittillframeend;
    level.onsuicidedeath = ::onsuicidedeath;
    level.onnormaldeath = ::onnormaldeath;
    level.onspawnplayer = ::onspawnplayer;
    level.ononeleftevent = ::ononeleftevent;
    level.ontimelimit = ::ontimelimit;
    level.ondeadevent = ::ondeadevent;
    level.bypassclasschoicefunc = ::tr_vehiclesearchparams;
    level.onplayerjointeam = ::onplayerjointeam;
    scripts\mp\tweakables::settweakablevalue( "player", "healthregentime", 0 );
    scripts\mp\tweakables::settweakablelastvalue( "player", "healthregentime", 0 );
    scripts\mp\utility\disconnect_event_aggregator::registerondisconnecteventcallback( ::onplayerdisconnect );
    scripts\mp\rank::registerscoreinfo( "still_alive", "value", 50 );
    scripts\mp\rank::registerscoreinfo( "still_alive_medium_bonus", "value", 50 );
    scripts\mp\rank::registerscoreinfo( "still_alive_large_bonus", "value", 100 );
    scripts\mp\rank::registerscoreinfo( "still_alive_extra_large_bonus", "value", 150 );
    scripts\mp\rank::registerscoreinfo( "clone_destroyed", "value", 50 );
    scripts\mp\rank::registerscoreinfo( "clone_was_destroyed", "value", 10 );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "vehicle_occupancy", "onEnterVehicle", ::vehicle_occupancy_mp_onentervehicle );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "vehicle_occupancy", "onExitVehicle", ::vehicle_occupancy_mp_onexitvehicle );
    vehomn_clearcontrols();
    playerzombiedroploot();
}

tank_check_for_damage()
{
    while ( !isdefined( game["music"] ) || !isdefined( game["music"]["match_ending_soon"] ) )
        waitframe();

    game["music"]["match_ending_soon"] = "prop_countdown";
}

onplayerconnect( var_0 )
{
    if ( !isdefined( var_0.pers["propSeconds"] ) )
        var_0.pers["propSeconds"] = 0;
}

onstartgametype()
{
    if ( level.tower_ground_mortar_2.settings.show_getcash_hint == 1 )
    {
        if ( [[ level.disablewinonscore ]]() )
        {
            game["status"] = "overtime";
            setdvar( "ui_overtime", 1 );
            setdvar( "overtimeTimeLimit", 3.5 );
        }

        if ( !isdefined( game["switchedsides"] ) )
            game["switchedsides"] = 0;

        if ( game["switchedsides"] )
        {
            var_0 = game["attackers"];
            var_1 = game["defenders"];
            game["attackers"] = var_1;
            game["defenders"] = var_0;
        }
        else
            level.prematchperiod = 30;
    }

    setspecialloadouts();
    setclientnamemode( "manual_change" );
    scripts\mp\utility\game::setobjectivetext( game["attackers"], &"OBJECTIVES_PH/ATTACKER" );
    scripts\mp\utility\game::setobjectivetext( game["defenders"], &"OBJECTIVES_PH/DEFENDER" );
    scripts\mp\utility\game::setobjectivescoretext( game["attackers"], &"OBJECTIVES_PH/ATTACKER_SCORE" );
    scripts\mp\utility\game::setobjectivescoretext( game["defenders"], &"OBJECTIVES_PH/DEFENDER_SCORE" );
    scripts\mp\utility\game::setobjectivehinttext( game["attackers"], &"OBJECTIVES_PH/ATTACKER_HINT" );
    scripts\mp\utility\game::setobjectivehinttext( game["defenders"], &"OBJECTIVES_PH/DEFENDER_HINT" );

    if ( level.tower_ground_mortar_2.settings.show_getcash_hint == 1 )
    {
        var_2 = game["roundsPlayed"] % 4 == 2 || game["roundsPlayed"] % 4 == 3;

        if ( var_2 )
        {
            game["switchedsides"] = !game["switchedsides"];
            game["switchedsides"] = !game["switchedsides"];
        }
        else
        {

        }
    }

    level._effect["propFlash"] = loadfx( "vfx/core/mp/equipment/vfx_concussion_grenade" );
    level._effect["propDeathFX"] = loadfx( "vfx/iw8/weap/_explo/claymore/vfx_explo_claymore" );

    if ( !isdefined( game["propScore"] ) )
    {
        game["propScore"] = [];
        game["propScore"]["allies"] = 0;
        game["propScore"]["axis"] = 0;
    }

    if ( !isdefined( game["propSurvivalTime"] ) )
    {
        game["propSurvivalTime"] = [];
        game["propSurvivalTime"]["allies"] = 0;
        game["propSurvivalTime"]["axis"] = 0;
    }

    if ( !isdefined( game["hunterKillTime"] ) )
    {
        game["hunterKillTime"] = [];
        game["hunterKillTime"]["allies"] = 0;
        game["hunterKillTime"]["axis"] = 0;
    }

    scripts\mp\flags::gameflaginit( "props_hide_over", 0 );
    scripts\mp\flags::gameflaginit( "props_hide_start", 0 );
    level thread _id_11F86();
    level thread waittill_player_completes_assassination_contract();
    level thread scripts\mp\gametypes\_prop_controls.gsc::overheatcooldown();
    level thread smoke_emitter();
    level thread getbrplayersnoteliminated();
    level thread _id_11ED7();
    level thread _id_124D4();
    level thread _id_127ED();
    level thread _id_124A0();
}

onnormaldeath( var_0, var_1, var_2, var_3, var_4, var_5 )
{
    waittill_any_8( var_1.pers["team"] );

    if ( game["state"] == "postgame" && game["teamScores"][var_1.team] > game["teamScores"][level.otherteam[var_1.team]] )
        var_1.finalkill = 1;
}

onsuicidedeath( var_0 )
{
    if ( var_0 scripts\mp\playerlogic::mayspawn() )
        return;

    var_1 = scripts\mp\utility\game::getotherteam( var_0.pers["team"] );

    foreach ( var_3 in var_1 )
        waittill_any_8( var_3 );
}

waittill_any_8( var_0 )
{
    if ( var_0 != game["attackers"] )
        return;

    level scripts\mp\gamescore::giveteamscoreforobjective( var_0, 1, 1 );
    game["propScore"][var_0] = game["propScore"][var_0] + 1;
}

manageparachute( var_0, var_1 )
{
    if ( !isstring( var_0 ) )
        return var_0;

    var_2 = var_0;

    if ( level.gameended )
    {
        var_3 = "roundsWon";

        if ( isdefined( level._id_1300F ) && level._id_1300F )
            var_3 = "teamScores";

        level.waittill_player_deposits = "none";

        if ( game[var_3]["allies"] == game[var_3]["axis"] )
        {
            level.waittill_player_deposits = "kills";

            if ( game["propScore"]["axis"] == game["propScore"]["allies"] )
            {
                level.waittill_player_deposits = "time";

                if ( game["hunterKillTime"]["axis"] == game["hunterKillTime"]["allies"] )
                {
                    level.waittill_player_deposits = "tie";
                    var_2 = "tie";
                }
                else if ( game["hunterKillTime"]["axis"] < game["hunterKillTime"]["allies"] )
                    var_2 = "axis";
                else
                    var_2 = "allies";
            }
            else if ( game["propScore"]["axis"] > game["propScore"]["allies"] )
                var_2 = "axis";
            else
                var_2 = "allies";

            if ( var_2 != "tie" )
                level thread monitor_outline_ents( var_2 );
        }
        else if ( game[var_3]["axis"] > game[var_3]["allies"] )
            var_2 = "axis";
        else
            var_2 = "allies";
    }

    if ( var_1 && ( var_2 == "allies" || var_2 == "axis" ) )
        tr_entergulag( var_2 );

    return var_2;
}

make_path_node_on_circular_path()
{
    var_0 = [];
    var_0["loadoutArchetype"] = "archetype_assault";
    var_0["loadoutPrimary"] = "none";
    var_0["loadoutPrimaryAttachment"] = "none";
    var_0["loadoutPrimaryAttachment2"] = "none";
    var_0["loadoutPrimaryCamo"] = "none";
    var_0["loadoutPrimaryReticle"] = "none";
    var_0["loadoutSecondary"] = "none";
    var_0["loadoutSecondaryAttachment"] = "none";
    var_0["loadoutSecondaryAttachment2"] = "none";
    var_0["loadoutSecondaryCamo"] = "none";
    var_0["loadoutSecondaryReticle"] = "none";
    var_0["loadoutMeleeSlot"] = "iw8_fists_mp";
    var_0["loadoutEquipmentPrimary"] = "none";
    var_0["loadoutEquipmentSecondary"] = "none";
    var_0["loadoutStreakType"] = "assault";
    var_0["loadoutKillstreak1"] = "none";
    var_0["loadoutKillstreak2"] = "none";
    var_0["loadoutKillstreak3"] = "none";
    var_0["loadoutSuper"] = "super_br_extract";
    var_0["loadoutPerks"] = [ "specialty_null" ];
    var_0["loadoutGesture"] = "playerData";
    return var_0;
}

setspecialloadouts()
{
    var_0 = game["defenders"];
    level.tr_detectwinners[var_0] = make_path_node_on_circular_path();
    var_1 = game["attackers"];
    level.tr_detectwinners[var_1] = make_path_node_on_circular_path();
    level.tr_detectwinners[var_1]["loadoutPrimary"] = "iw8_ar_akilo47";
    level.tr_detectwinners[var_1]["loadoutPrimaryAttachment"] = "xmags";
    level.tr_detectwinners[var_1]["loadoutPrimaryAttachment2"] = "laser";
    level.tr_detectwinners[var_1]["loadoutSecondary"] = "iw8_pi_mike1911";
    level.tr_detectwinners[var_1]["loadoutEquipmentSecondary"] = "equip_concussion";
    level.tr_detectwinners[var_1]["loadoutPerks"] = [ "specialty_restock", "specialty_hustle" ];
}

tr_vehiclesearchparams()
{
    self.pers["class"] = "gamemode";
    self.pers["lastClass"] = "";
    self.pers["gamemodeLoadout"] = level.tr_detectwinners[self.pers["team"]];
    self.class = self.pers["class"];
    self.lastclass = self.pers["lastClass"];
    return self.class;
}

waittill_player_completes_assassination_contract()
{
    level endon( "game_ended" );
    scripts\mp\spectating::updatespectatesettings();
}

_id_1300A( var_0 )
{
    level notify( "whistle_start_timer_beginning" );
    var_1 = int( var_0 );

    if ( var_1 >= 0 )
        thread _id_1300B( var_1 );
}

_id_1300B( var_0 )
{
    level endon( "whistle_start_timer_beginning" );
    waittillframeend;

    while ( var_0 > 0 && !level.gameended )
    {
        setomnvar( "ui_ph_whistle_countdown", var_0 );
        var_0--;
        wait 1;
    }

    setomnvar( "ui_ph_whistle_countdown", var_0 );
}

_id_12B90()
{
    return 1;
}

_id_11F86()
{
    if ( _id_12B90() && level.tower_ground_mortar_2.settings.waittill_any_return_5 > 0 )
    {
        level.tower_ground_mortar_2.fail_on_transmission_timeout = scripts\mp\hud_util::createservertimer( "default", 1.4 );
        level.tower_ground_mortar_2.fail_on_transmission_timeout scripts\mp\hud_util::setpoint( "CENTER", undefined, 0, 50 );
        level.tower_ground_mortar_2.fail_on_transmission_timeout.label = &"MP_PH/STARTS_IN";
        level.tower_ground_mortar_2.fail_on_transmission_timeout.alpha = 0;
        level.tower_ground_mortar_2.fail_on_transmission_timeout.archived = 0;
        level.tower_ground_mortar_2.fail_on_transmission_timeout.hidewheninmenu = 1;
        level.tower_ground_mortar_2.fail_on_transmission_timeout.sort = 1;
    }

    if ( _id_12B90() )
    {
        level.tower_ground_mortar_2._id_1300C = scripts\mp\hud_util::createservertimer( "default", 0.9 );
        level.tower_ground_mortar_2._id_1300C.x = -6;
        level.tower_ground_mortar_2._id_1300C.y = 2;
        level.tower_ground_mortar_2._id_1300C.alignx = "right";
        level.tower_ground_mortar_2._id_1300C.aligny = "top";
        level.tower_ground_mortar_2._id_1300C.horzalign = "right_adjustable";
        level.tower_ground_mortar_2._id_1300C.vertalign = "top_adjustable";
        level.tower_ground_mortar_2._id_1300C.label = &"MP_PH/WHISTLE_IN";
        level.tower_ground_mortar_2._id_1300C.alpha = 0;
        level.tower_ground_mortar_2._id_1300C.archived = 1;
        level.tower_ground_mortar_2._id_1300C.hidewheninmenu = 1;
        level.tower_ground_mortar_2._id_1300C settimer( 120 );
    }
    else
        _id_1300A( 120 );

    if ( _id_12B90() )
    {
        level._id_1300D = force_thermites( "default", 1 );
        level._id_1300D.label = &"MP_PH/WHISTLING";
        level._id_1300D.x = -5;
        level._id_1300D.y = 2;
        level._id_1300D.alignx = "right";
        level._id_1300D.aligny = "top";
        level._id_1300D.horzalign = "right_adjustable";
        level._id_1300D.vertalign = "top_adjustable";
        level._id_1300D.archived = 1;
        level._id_1300D.alpha = 0;
        level._id_1300D.glowalpha = 0.2;
        level._id_1300D.hidewheninmenu = 0;
    }

    if ( _id_12B90() )
    {
        if ( !isdefined( level.hidequestcircletoall ) )
            level.hidequestcircletoall = [];

        level.hidequestcircletoall = force_thermites( "default", 0.9 );
        level.hidequestcircletoall.label = &"MP_PH/ALIVE";
        level.hidequestcircletoall setvalue( 0 );
        level.hidequestcircletoall.x = -5;
        level.hidequestcircletoall.y = 14;
        level.hidequestcircletoall.alignx = "right";
        level.hidequestcircletoall.aligny = "top";
        level.hidequestcircletoall.horzalign = "right_adjustable";
        level.hidequestcircletoall.vertalign = "top_adjustable";
        level.hidequestcircletoall.archived = 1;
        level.hidequestcircletoall.fontscale = 1.0;
        level.hidequestcircletoall.alpha = 1;
        level.hidequestcircletoall.glowalpha = 0;
        level.hidequestcircletoall.hidewheninmenu = 0;
        level thread hidetimedrunhudfromplayer();
    }
}

force_thermites( var_0, var_1 )
{
    var_2 = newhudelem();
    var_2.elemtype = "font";
    var_2.font = var_0;
    var_2.fontscale = var_1;
    var_2.basefontscale = var_1;
    var_2.x = 0;
    var_2.y = 0;
    var_2.width = 0;
    var_2.height = int( level.fontheight * var_1 );
    var_2.xoffset = 0;
    var_2.yoffset = 0;
    var_2.children = [];
    var_2 scripts\mp\hud_util::setparent( level.uiparent );
    var_2.hidden = 0;
    var_2.archived = 0;
    return var_2;
}

hidetimedrunhudfromplayer()
{
    level endon( "game_ended" );

    for (;;)
    {
        var_0 = last_akimbo_ammo_taken( game["defenders"] );
        level.hidequestcircletoall setvalue( var_0.size );
        level scripts\engine\utility::_id_12E42( "player_spawned", "playerCountChanged", "propCountChanged", "playerDisconnected" );
    }
}

last_akimbo_ammo_taken( var_0 )
{
    var_1 = [];

    foreach ( var_3 in level.players )
    {
        if ( isdefined( var_3 ) && isalive( var_3 ) && ( !isdefined( var_3.sessionstate ) || var_3.sessionstate == "playing" ) )
        {
            if ( !isdefined( var_0 ) || var_3.team == var_0 )
                var_1[var_1.size] = var_3;
        }
    }

    return var_1;
}

onplayerdisconnect( var_0 )
{
    level notify( "playerDisconnected" );

    if ( isdefined( var_0.waittill_any_return_no_endon_death_4 ) )
        var_0 waittill_drone_timeout();
    else if ( isdefined( var_0.waitthensetgendersoundcontext ) )
        var_0 waittill_drone_defined();
}

relic_bang_and_boom( var_0, var_1 )
{
    if ( isbot( var_0 ) )
        return;

    kick( var_0 getentitynumber(), var_1 );
}

_id_12FF7()
{
    var_0 = scripts\engine\utility::_id_12E49( "weapon_fired", "sprint_begin", "specialGrenade", "end_weapon_check_usage" );

    if ( var_0 == "end_weapon_check_usage" )
    {
        if ( istrue( self.obj_heli_assault3_fob ) )
            return 1;

        relic_bang_and_boom( self, "EXE_PLAYERKICKED_INACTIVE" );
        return 0;
    }

    return 1;
}

vehomn_getleveldata( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );

    if ( !isdefined( var_0 ) )
        var_0 = 45;

    if ( !isdefined( var_1 ) )
        var_1 = 300;

    var_2 = self.origin;
    var_3 = squared( var_1 );
    var_4 = 0;

    for ( var_5 = 0; var_5 < var_0; var_5++ )
    {
        if ( !var_4 )
        {
            var_6 = distancesquared( var_2, self.origin );

            if ( var_6 >= var_3 )
                var_4 = 1;
        }

        wait 1;
    }

    if ( var_4 )
        return 1;

    return 0;
}

_id_12E88()
{
    scripts\mp\flags::gameflagwait( "br_ready_to_jump" );
}

_id_12479()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self.halfheight = 1;
    _id_12E88();
    childthread _id_12FF7();

    if ( !vehomn_getleveldata( 45, 300 ) )
    {
        if ( istrue( self.obj_heli_assault3_fob ) )
            return;

        relic_bang_and_boom( self, "EXE_PLAYERKICKED_INACTIVE" );
        return;
    }

    if ( !vehomn_getleveldata( 75, 150 ) )
    {
        if ( istrue( self.obj_heli_assault3_fob ) )
            return;

        relic_bang_and_boom( self, "EXE_PLAYERKICKED_INACTIVE" );
        return;
    }

    wait 30;
    self notify( "end_weapon_check_usage" );
}

onspawnplayer()
{
    scripts\mp\gametypes\br.gsc::onspawnplayer();
    self.breathingstoptime = 0;

    if ( update_sentry_settings() )
    {
        self._id_120A6 = 1;
        self.overrideweaponspeed_speedscale = level.tower_ground_mortar_2.settings.waittill_player_completes_scavenger_contract;

        if ( !isdefined( self.ai_hold_behavior ) )
            self.ai_hold_behavior = 0;

        if ( !isdefined( self.enemy_claymore_watchfortrigger ) )
            self.enemy_claymore_watchfortrigger = 0;

        if ( !isdefined( self.pers["ability"] ) )
            self.pers["ability"] = 0;

        self.fulton_initrepository = level.tower_ground_mortar_2.ai_ground_set_goal_radii[self.pers["ability"]];

        if ( _id_12B90() )
            thread scripts\mp\gametypes\_prop_controls.gsc::waittill_all_targets_activated_or_player_death();

        self.process_anim_ents = 0;
        var_0 = int( level.tower_ground_mortar_2.settings.waitthencheckendgame );
        var_1 = undefined;
        var_2 = undefined;

        if ( isdefined( self._id_122AF ) && isdefined( self.disable_health_regen ) )
        {
            var_0 = self.disable_health_regen;
            var_1 = self.ai_hold_behavior;
            var_2 = self.enemy_claymore_watchfortrigger;
        }

        scripts\mp\gametypes\_prop_controls.gsc::waittill_interrogation_dialogue_or_timeout( var_0 );
        scripts\mp\gametypes\_prop_controls.gsc::_id_11EC4( self.fulton_initrepository, var_1 );
        scripts\mp\gametypes\_prop_controls.gsc::_id_11EC4( "CLONE", var_2 );
        thread scripts\mp\gametypes\_prop_controls.gsc::enabledbasejumping();
        thread nuke_vault_door_alarm();
    }
    else
    {
        self._id_120A6 = undefined;
        self.ai_hold_behavior = undefined;
        self.enemy_claymore_watchfortrigger = undefined;
        self.overrideweaponspeed_speedscale = undefined;

        if ( !isdefined( self._id_1270C ) )
            self._id_1270C = 0;

        thread monitor_enemy_death();
        var_3 = 1;

        if ( var_3 && !isdefined( self.halfheight ) )
            thread _id_12479();
    }

    self._id_122AF = 1;
}

smoke_emitter()
{
    level endon( "game_ended" );
    scripts\mp\flags::gameflagwait( "props_hide_start" );

    if ( _id_12B90() )
    {
        if ( level.tower_ground_mortar_2.settings.waittill_any_return_5 > 0 )
        {
            level.tower_ground_mortar_2.fail_on_transmission_timeout settimer( level.tower_ground_mortar_2.settings.waittill_any_return_5 );
            level.tower_ground_mortar_2.fail_on_transmission_timeout.alpha = 1;
        }

        level.tower_ground_mortar_2._id_1300C settimer( level.tower_ground_mortar_2.settings.waittill_scout_drone_defined + level.tower_ground_mortar_2.settings.waittill_any_return_5 );
        level.tower_ground_mortar_2._id_1300C.alpha = 1;
    }
    else if ( level.tower_ground_mortar_2.settings.waittill_any_return_5 > 0 || level.tower_ground_mortar_2.settings.waittill_scout_drone_defined > 0 )
        _id_1300A( level.tower_ground_mortar_2.settings.waittill_scout_drone_defined + level.tower_ground_mortar_2.settings.waittill_any_return_5 );

    if ( level.tower_ground_mortar_2.settings.waittill_any_return_5 > 0 )
        wait( level.tower_ground_mortar_2.settings.waittill_any_return_5 );

    scripts\mp\flags::gameflagset( "props_hide_over" );

    if ( _id_12B90() )
    {
        level.tower_ground_mortar_2._id_1300C.alpha = 1;

        if ( level.tower_ground_mortar_2.settings.waittill_any_return_5 > 0 )
            level.tower_ground_mortar_2.fail_on_transmission_timeout.alpha = 0;
    }

    if ( level.tower_ground_mortar_2.settings.waittill_scout_drone_defined > 0 )
        waittill_plyer_has_ammo_count();
}

nuke_vault_door_alarm()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self waittill( "giveLoadout" );
    self allowprone( 0 );
    self allowsprint( 0 );
    scripts\mp\weapons::updatemovespeedscale();
    self disableweaponpickup();
    self takeallweapons();
    self allowspectateteam( game["attackers"], 1 );
    self playerhide();
    scripts\mp\class::loadout_giveperk( "specialty_quieter" );
    thread _id_11F83();
    thread scripts\mp\gametypes\_prop_controls.gsc::_id_11F76();
    thread _id_11F5C();
    thread scripts\mp\gametypes\_prop_controls.gsc::waittill_any_return_no_endon_death_1();
    thread waittill_player_uses_munition();
    thread waittill_player_pings_location();
    thread waittill_player_uses_assassination_contract();
    thread waittill_player_uses_scavenger_contract();
    self.prop thread padcorner3to0dist( game["defenders"], "outline_nodepth_cyan", self );
    self.extactioncomplete = undefined;
}

model_parts( var_0 )
{
    switch ( var_0 )
    {
        case 50:
            return 120;
        case 100:
            return 150;
        case 250:
            return 180;
        case 450:
            return 260;
        case 550:
            return 320;
        default:
            break;
    }

    return 120;
}

model_ent( var_0 )
{
    switch ( var_0 )
    {
        case 50:
            return -30;
        case 100:
            return -20;
        case 250:
            return 0;
        case 450:
            return 20;
        case 550:
            return 40;
        default:
            break;
    }

    return 0;
}

bonusdeathplunder()
{
    if ( !isdefined( self.prop._id_130B4 ) )
        return;

    self.prop.angles = self.angles;
    var_0 = anglestoforward( self.prop.angles ) * self.prop._id_130B4[0];
    var_1 = anglestoright( self.prop.angles ) * self.prop._id_130B4[1];
    var_2 = anglestoup( self.prop.angles ) * self.prop._id_130B4[2];
    self.prop.origin = self.prop.origin + var_0;
    self.prop.origin = self.prop.origin + var_1;
    self.prop.origin = self.prop.origin + var_2;
}

bombpuzzle_setup_marker_vfx()
{
    if ( !isdefined( self.prop.blueprintcreatingteam ) )
        return;

    self.prop.angles = self.angles;
    self.prop.angles = self.prop.angles + self.prop.blueprintcreatingteam;
    self.process_anim_ents = 1;
}

gettimeremaining()
{
    var_0 = 0;

    if ( isdefined( level.br_level ) && isdefined( level.br_level.checkpoint_create_carepackage ) )
    {
        for ( var_1 = 0; var_1 < level.br_level.br_circledelaytimes.size; var_1++ )
        {
            var_2 = level.br_level.br_circledelaytimes[var_1];
            var_3 = level.br_level.br_circleclosetimes[var_1];
            var_0 = var_0 + var_2 + var_3;
        }

        var_0 = var_0 * 1000;
        var_4 = gettime() - level.tower_ground_mortar_2.settings._id_13009;
        var_0 = var_0 - var_4;

        if ( var_0 < 0 )
            var_0 = 0;
    }

    return int( var_0 );
}

waittill_plyer_has_ammo_count()
{
    level endon( "game_ended" );
    level.tower_ground_mortar_2.settings._id_13009 = gettime();
    var_0 = gettime();
    var_1 = level.tower_ground_mortar_2.settings.waittill_scout_drone_defined * 1000;
    var_2 = 20000;
    var_3 = var_2;
    var_4 = 500;
    var_5 = 5000;
    var_6 = 0;
    var_7 = getentarray( "minimap_corner", "targetname" )[0].origin;
    wait( level.tower_ground_mortar_2.settings.waittill_scout_drone_defined );

    if ( !_id_12B90() )
        setomnvar( "ui_war_active_sector", 0 );

    for (;;)
    {
        if ( var_0 + var_1 - var_4 < gettime() )
        {
            var_6++;
            var_8 = sortbydistance( level.players, var_7 );

            foreach ( var_10 in var_8 )
            {
                if ( !isdefined( var_10 ) )
                    continue;

                if ( _id_12B90() )
                {
                    level.tower_ground_mortar_2._id_1300C.alpha = 0;
                    level._id_1300D.alpha = 0.6;
                }

                if ( var_10 update_sentry_settings() && isalive( var_10 ) )
                {
                    if ( _id_12B90() )
                    {
                        level._id_1300D.alpha = 1;
                        level._id_1300D fadeovertime( 0.75 );
                        level._id_1300D.alpha = 0.6;
                    }

                    playsoundatpos( var_10.origin + ( 0, 0, 60 ), "prop_whistle" );
                    wait 1.5;
                }
            }

            if ( !_id_12B90() )
                setomnvar( "ui_war_active_sector", 2 );

            var_0 = gettime();

            if ( var_6 % 2 == 0 )
                var_1 = max( var_1 - 5000, var_2 );

            if ( var_3 >= gettimeremaining() - var_5 )
            {
                if ( _id_12B90() )
                    level._id_1300D.alpha = 0;

                return;
            }
            else
            {
                if ( var_3 * 2 + getteamplayersalive( game["defenders"] ) * 2500 >= gettimeremaining() - var_5 )
                {
                    if ( _id_12B90() )
                        level.tower_ground_mortar_2._id_1300C.label = &"MP_PH/FINAL_WHISTLE";
                    else
                        setomnvar( "ui_war_active_sector", 1 );

                    var_3 = var_3 + getteamplayersalive( game["defenders"] ) * 2500;
                }

                if ( _id_12B90() )
                    level.tower_ground_mortar_2._id_1300C settimer( int( var_1 / 1000 ) );
                else
                    _id_1300A( int( var_1 / 1000 ) );

                if ( _id_12B90() )
                {
                    level._id_1300D.alpha = 0;
                    level.tower_ground_mortar_2._id_1300C.alpha = 1;
                }
            }
        }

        wait 0.5;
    }
}

markedentities_removeentsbyindex( var_0 )
{
    var_1 = [];

    foreach ( var_3 in level.participants )
    {
        if ( !isdefined( var_3.team ) )
            continue;

        if ( scripts\mp\utility\player::isreallyalive( var_3 ) && scripts\mp\utility\entity::isteamparticipant( var_3 ) && var_3.team == var_0 )
            var_1[var_1.size] = var_3;
    }

    return var_1;
}

forbiddencachespawns()
{
    self._id_12326 = markedentities_removeentsbyindex( game["defenders"] );
}

_id_11F5C()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    wait 0.5;
    self.prop._id_120B0 = 1;
    self.prop thread scripts\mp\damage::monitordamage( self.prop.health, "standard", undefined, ::damagewatch );
}

damagewatch( var_0 )
{
    if ( !isdefined( var_0.attacker ) )
        return 0;

    if ( !isdefined( self.owner ) )
        return 0;

    if ( isplayer( var_0.attacker ) )
    {
        if ( var_0.attacker.pers["team"] == self.owner.pers["team"] )
            return 0;

        var_0.attacker thread scripts\mp\damagefeedback::updatedamagefeedback( "standard" );

        if ( var_0.objweapon.basename == "concussion_grenade_mp" )
        {
            var_1 = spawnstruct();
            var_1.origin = var_0.point;
            self.owner thread scripts\mp\equipment\concussion_grenade::applyconcussion( var_1, var_0.attacker );

            if ( istrue( self.owner.lock ) )
                self.owner scripts\mp\gametypes\_prop_controls.gsc::_id_12A54();
        }
    }

    self.owner dodamage( var_0.damage, var_0.point, var_0.attacker, var_0.inflictor, var_0.meansofdeath, var_0.objweapon );
    return 0;
}

waitthenshowinfecttext()
{
    thread waittill_2( [ self.prop, self.waiting_to_connect, self.waittill_any_5 ] );
}

waittill_2( var_0 )
{
    foreach ( var_2 in var_0 )
    {
        if ( isdefined( var_2 ) )
            var_2 unlink();
    }

    waitframe();

    foreach ( var_2 in var_0 )
    {
        if ( isdefined( var_2 ) )
            var_2 delete();
    }
}

waittill_player_uses_munition()
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self.get_circle_back_nodes_on_same_side = "prop_death";
    self.waittill_all_valid_ai_are_gone = "propDeathFX";
    self waittill( "death" );
    var_0 = self.body;
    playsoundatpos( self.prop.origin + ( 0, 0, 4 ), self.get_circle_back_nodes_on_same_side );
    playfx( scripts\engine\utility::getfx( self.waittill_all_valid_ai_are_gone ), self.prop.origin + ( 0, 0, 4 ) );

    if ( isdefined( var_0 ) )
        var_0 delete();

    waitthenshowinfecttext();
    self setcamerathirdperson( 0, 0 );
    usemilestonephases( 0 );
}

waittill_player_pings_location()
{
    self notify( "propWatchDeleteDisconnect" );
    self endon( "propWatchDeleteDisconnect" );
    level endon( "game_ended" );
    self waittill( "disconnect" );

    foreach ( var_1 in level.players )
    {
        if ( istrue( var_1.waittill_player_completes_assassination_contract ) && isdefined( var_1._id_1232E ) && self == var_1._id_1232E )
            var_1 notify( "endPropSpectate" );
    }

    waitthenshowinfecttext();
    waittill_active_agent_count_under();
}

waittill_player_uses_assassination_contract()
{
    self notify( "propWatchDeleteRoundEnd" );
    self endon( "propWatchDeleteRoundEnd" );
    self endon( "disconnect" );
    level waittill( "game_ended" );
    scripts\engine\utility::waittill_notify_or_timeout( "end_killcam", 5 );
    waitthenshowinfecttext();
    waittill_active_agent_count_under();
}

waittill_active_agent_count_under()
{
    if ( isdefined( self.waittill_all_current_vo_plays ) )
    {
        foreach ( var_1 in self.waittill_all_current_vo_plays )
        {
            if ( isdefined( var_1 ) )
                var_1 delete();
        }
    }
}

empdrone_gameendedthink()
{
    foreach ( var_1 in level.players )
        var_1 waittill_active_agent_count_under();
}

waittill_player_uses_scavenger_contract()
{
    self endon( "death_or_disconnect" );
    self endon( "joined_team" );
    self endon( "joined_spectators" );
    self allowprone( 0 );
    self allowsprint( 0 );
}

getbrplayersnoteliminated()
{
    level endon( "game_ended" );
    level waittill( "prematch_over" );
}

tac_rover()
{
    foreach ( var_5, var_1 in level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3 )
    {
        if ( var_5 != "any" )
        {
            foreach ( var_4, var_3 in level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3["any"] )
                level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_5][var_4] = scripts\engine\utility::array_combine( level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_5][var_4], var_3 );
        }
    }
}

wave_airstrikes_allowed( var_0 )
{
    var_1 = level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_0];
    var_2 = 10 * isdefined( var_1[50] );
    var_3 = 30 * isdefined( var_1[100] );
    var_4 = 40 * isdefined( var_1[250] );
    var_5 = 20 * isdefined( var_1[450] );
    var_6 = 10 * isdefined( var_1[550] );
    var_7 = var_2 + var_3 + var_4 + var_5 + var_6;
    var_8 = randomint( var_7 );

    if ( var_8 < var_2 )
        return 50;

    var_8 = var_8 - var_2;

    if ( var_8 < var_3 )
        return 100;

    var_8 = var_8 - var_3;

    if ( var_8 < var_4 )
        return 250;

    var_8 = var_8 - var_4;

    if ( var_8 < var_5 )
        return 450;

    var_8 = var_8 - var_5;
    return 550;
}

max_projectile_check( var_0 )
{
    var_1 = var_0 waittill_any_7();
    var_2 = level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_1];
    var_3 = wave_airstrikes_allowed( var_1 );
    var_4 = scripts\engine\utility::array_randomize( getarraykeys( var_2 ) );
    var_5 = [ var_3 ];

    foreach ( var_7 in var_4 )
    {
        if ( var_7 != var_3 )
            var_5[var_5.size] = var_7;
    }

    var_9 = undefined;

    for ( var_10 = 0; var_10 < var_5.size; var_10++ )
    {
        var_7 = var_5[var_10];

        if ( !isdefined( var_2[var_7] ) || !var_2[var_7].size )
            continue;

        var_11 = scripts\engine\utility::array_randomize( var_2[var_7] );

        for ( var_12 = 0; var_12 < var_11.size; var_12++ )
        {
            var_9 = var_11[var_12];
            var_13 = 0;

            if ( isdefined( var_0._id_12B72 ) && var_0._id_12B72.size )
            {
                for ( var_14 = 0; var_14 < var_0._id_12B72.size; var_14++ )
                {
                    if ( var_9.modelname == var_0._id_12B72[var_14].modelname )
                    {
                        var_13 = 1;
                        break;
                    }
                }
            }

            if ( !var_13 )
                return var_9;
        }
    }

    return var_9;
}

vehomn_clearcontrols()
{
    var_0 = scripts\cp_mp\utility\game_utility::getmapname();
    var_1 = "mp/" + var_0 + "_ph.csv";
    var_2 = 0;

    if ( tableexists( var_1 ) )
    {
        var_2 = tablelookupgetnumrows( var_1 );

        for ( var_3 = 0; var_3 < var_2; var_3++ )
        {
            var_4 = tablelookupbyrow( var_1, var_3, 0 );

            if ( var_4 == "prop" )
            {
                var_5 = tablelookupbyrow( var_1, var_3, 1 );
                var_6 = tablelookupbyrow( var_1, var_3, 2 );
                var_7 = int( tablelookupbyrow( var_1, var_3, 3 ) );
                var_8 = int( tablelookupbyrow( var_1, var_3, 4 ) );
                var_9 = int( tablelookupbyrow( var_1, var_3, 5 ) );
                var_10 = int( tablelookupbyrow( var_1, var_3, 6 ) );
                var_11 = int( tablelookupbyrow( var_1, var_3, 7 ) );
                var_12 = int( tablelookupbyrow( var_1, var_3, 8 ) );
                var_13 = tablelookupbyrow( var_1, var_3, 9 );
                var_14 = tablelookupbyrow( var_1, var_3, 10 );
                var_15 = tablelookupbyrow( var_1, var_3, 11 );

                if ( var_15 == "" )
                    var_15 = "any";

                var_16 = undefined;

                if ( isdefined( var_7 ) && isdefined( var_8 ) && isdefined( var_9 ) )
                    var_16 = ( var_7, var_8, var_9 );

                var_17 = undefined;

                if ( isdefined( var_10 ) && isdefined( var_11 ) && isdefined( var_12 ) )
                    var_17 = ( var_10, var_11, var_12 );

                var_18 = milestonephasepercent_lzs( var_6 );

                if ( !isdefined( var_13 ) || var_13 == "" )
                    var_13 = model_ent( var_18 );
                else
                    var_13 = int( var_13 );

                if ( !isdefined( var_14 ) || var_14 == "" )
                    var_14 = model_parts( var_18 );
                else
                    var_14 = int( var_14 );

                ammotype( var_5, var_18, var_16, var_17, var_6, var_13, var_14, var_15 );
                continue;
            }

            if ( var_4 == "loc" )
            {
                var_15 = tablelookupbyrow( var_1, var_3, 11 );
                var_19 = int( tablelookupbyrow( var_1, var_3, 12 ) );
                var_20 = int( tablelookupbyrow( var_1, var_3, 13 ) );
                var_21 = int( tablelookupbyrow( var_1, var_3, 14 ) );
                playerthrowsmokesignal( var_15, var_19, var_20, var_21 );
                continue;
            }
        }
    }

    if ( var_2 == 0 )
        ammotype( "tag_origin", 250, ( 0, 0, 0 ), ( 0, 0, 0 ), "medium", model_ent( 250 ), model_parts( 250 ), "any" );

    tac_rover();
}

_id_11F83()
{
    var_0 = self.waittill_any_return_7;

    if ( !isdefined( var_0 ) )
        var_0 = max_projectile_check( self );

    self.waiting_to_connect = spawn( "script_model", self.origin );
    self.waiting_to_connect.targetname = "propAnchor";
    self.waiting_to_connect linkto( self );
    self.waittill_any_5 = spawn( "script_model", self.origin );
    self.waittill_any_5 setmodel( "generic_prop_raven_x3" );
    self.waittill_any_5.targetname = "propEnt";
    self.waittill_any_5 linkto( self.waiting_to_connect );
    self.prop = spawn( "script_model", self.waittill_any_5.origin );
    self.prop.targetname = "prop";
    self.prop setmodel( var_0.modelname );
    self.prop setcandamage( 1 );
    self.prop._id_130B4 = var_0._id_130B4;
    self.prop.blueprintcreatingteam = var_0.blueprintcreatingteam;
    self.prop.angles = self.angles;
    bonusdeathplunder();
    bombpuzzle_setup_marker_vfx();
    self.prop linkto( self.waittill_any_5, "J_prop_1" );
    self.prop.owner = self;
    self.prop.health = 10000;
    self.waittill_any_5 scriptmodelplayanim( "prop_hunt_prop_spin", "propSpinAnim", undefined, 1.5 );
    self.waittill_any_5 scriptmodelpauseanim( 1 );
    self._id_126F1 = var_0.waittill_any_timeout_no_endon_death_5;
    self._id_126F0 = var_0.waittill_any_return_4;
    self setcamerathirdperson( 1, self._id_126F1, self._id_126F0 );
    usemilestonephases( 1 );
    self.prop.info = var_0;
    self.waittill_any_return_7 = var_0;

    if ( !isdefined( self._id_122AF ) )
        self._id_12B72 = [];

    self.maxhealth = milestonephasepercent_drops( var_0 );
    self.health = self.maxhealth;
}

usemilestonephases( var_0 )
{

}

milestonephasepercent_drops( var_0 )
{
    return int( var_0.waittill_num_and_all_spawns_dead_and_time_and_player_reset );
}

milestonephasepercent_lzs( var_0 )
{
    var_1 = 0;

    switch ( var_0 )
    {
        case "xsmall":
            var_1 = 50;
            break;
        case "small":
            var_1 = 100;
            break;
        case "medium":
            var_1 = 250;
            break;
        case "large":
            var_1 = 450;
            break;
        case "xlarge":
            var_1 = 550;
            break;
        default:
            var_2 = scripts\cp_mp\utility\game_utility::getmapname();
            var_3 = "mp/" + var_2 + "_ph.csv";
            var_1 = 100;
            break;
    }

    return var_1;
}

ammotype( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7 )
{
    if ( !isdefined( level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_7] ) )
        level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_7] = [];

    if ( !isdefined( level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_7][var_1] ) )
        level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_7][var_1] = [];

    var_8 = spawnstruct();
    var_8.modelname = var_0;
    var_8.waittill_num_and_all_spawns_dead_and_time_and_player_reset = int( var_1 );
    var_8.waittill_objective_start = var_4;
    var_8.location = var_7;

    if ( isdefined( var_2 ) )
        var_8._id_130B4 = var_2;

    if ( isdefined( var_3 ) )
        var_8.blueprintcreatingteam = var_3;

    var_8.waittill_any_timeout_no_endon_death_5 = var_6;
    var_8.waittill_any_return_4 = var_5;
    var_10 = level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_7][var_1].size;
    level.tower_ground_mortar_2.waittill_any_return_no_endon_death_3[var_7][var_1][var_10] = var_8;
}

tr_createquestlocale( var_0, var_1 )
{
    if ( istrue( level.hvi_escort_intro ) )
        return;

    level.hvi_escort_intro = 1;
    tr_entergulag( var_0 );
    thread scripts\mp\gamelogic::endgame( var_0, var_1 );
    level thread monitor_outline_ents( var_0 );
}

tr_entergulag( var_0 )
{
    level.finalkillcam_winner = var_0;

    if ( level.finalkillcam_winner == game["defenders"] )
        level._id_120AB = 1;
}

monitor_outline_ents( var_0 )
{
    level endon( "game_ended" );
    var_1 = game["roundsWon"][var_0] + 1;
    setteamscore( var_0, var_1 );
}

_id_11ED7()
{
    level endon( "game_ended" );
    var_0 = game["roundsWon"][game["defenders"]];
    var_1 = game["roundsWon"][game["attackers"]];
    setteamscore( game["defenders"], var_0 );
    setteamscore( game["attackers"], var_1 );
}

ononeleftevent( var_0 )
{
    if ( istrue( level.gameended ) )
        return;

    if ( var_0 == game["attackers"] )
        return;

    var_1 = undefined;

    foreach ( var_3 in level.players )
    {
        if ( isdefined( var_0 ) && var_3.team != var_0 )
            continue;

        if ( !scripts\mp\utility\player::isreallyalive( var_3 ) && !var_3 scripts\mp\playerlogic::mayspawn() )
            continue;

        if ( isdefined( var_1 ) )
            return;

        var_1 = var_3;
    }

    if ( !isdefined( var_1 ) )
        return;

    var_1 thread givelastonteamwarning();
}

givelastonteamwarning()
{
    self endon( "death_or_disconnect" );
    level endon( "game_ended" );
    scripts\mp\utility\player::waittillrecoveredhealth( 3 );
    var_0 = scripts\mp\utility\game::getotherteam( self.pers["team"] );
    level thread scripts\mp\hud_util::teamplayercardsplash( "callout_lastteammemberalive", self, self.pers["team"] );
    level thread scripts\mp\hud_util::teamplayercardsplash( "callout_lastenemyalive", self, var_0 );

    if ( update_sentry_settings() )
    {
        level notify( "noPropsToSpectate" );
        level.spawntimestamp = 1;
    }

    level notify( "last_alive", self );
}

ontimelimit()
{
    if ( !istrue( level.key_hint ) )
    {
        var_0 = scripts\mp\utility\game::gettimepassed();
        game["propSurvivalTime"][game["defenders"]] = game["propSurvivalTime"][game["defenders"]] + var_0;
        game["hunterKillTime"][game["attackers"]] = game["hunterKillTime"][game["attackers"]] + var_0;
        dont_shoot_parachutes();
        tr_createquestlocale( game["defenders"], game["end_reason"]["time_limit_reached"] );
    }
}

dont_shoot_parachutes()
{
    var_0 = markedentities_removeentsbyindex( game["defenders"] );

    if ( var_0.size < 1 )
        return;

    var_1 = markedentities_removeentsbyindex( game["attackers"] );

    if ( var_1.size < 1 )
        return;

    var_2 = domlocale_onrespawn( var_0, var_1 );

    if ( scripts\mp\utility\entity::isgameparticipant( var_2 ) )
        var_3 = var_2 getentitynumber();
    else
        var_3 = -1;

    var_4 = var_1[0];
    var_4.deathtime = gettime() - 1000;
    scripts\mp\final_killcam::recordfinalkillcam( 5.0, var_4, var_2, var_3, -1, 0, "none", 0, 0, "none", "normal", 0 );
}

domlocale_onrespawn( var_0, var_1 )
{
    var_2 = undefined;
    var_3 = 1073741824;

    foreach ( var_5 in var_0 )
    {
        var_6 = undefined;
        var_7 = 1073741824;

        foreach ( var_9 in var_1 )
        {
            var_10 = getpathdist( var_5.origin, var_9.origin, 999999 );

            if ( var_10 < var_7 )
            {
                var_7 = var_10;
                var_6 = var_9;
            }
        }

        if ( var_7 < var_3 )
        {
            var_3 = var_7;
            var_2 = var_5;
        }
    }

    if ( !isdefined( var_2 ) )
        var_2 = scripts\engine\utility::random( var_0 );

    return var_2;
}

tr_circletick()
{
    if ( game["roundsWon"]["allies"] == scripts\mp\utility\dvars::getwatcheddvar( "winlimit" ) - 1 && game["roundsWon"]["axis"] == scripts\mp\utility\dvars::getwatcheddvar( "winlimit" ) - 1 )
        return 1;

    return 0;
}

update_hint_logic_offhand()
{
    scripts\mp\equipment::incrementequipmentammo( "equip_concussion" );
    scripts\mp\class::loadout_removeperk( "specialty_selectivehearing" );
}

monitor_enemy_death()
{
    self endon( "death_or_disconnect" );
    level endon( "game_ended" );
    self waittill( "giveLoadout" );

    if ( !istrue( self.gulag ) )
        update_hint_logic_offhand();

    self._id_126F1 = undefined;
    self setcamerathirdperson( 0, 0 );
    usemilestonephases( 0 );
    self allowprone( 1 );
    self allowsprint( 1 );
    scripts\mp\weapons::updatemovespeedscale();
    self enableweaponpickup();
    self playershow();
    self.extactioncomplete = 1;
    br_loadout_option();
    thread br_movingcirclegulagcloseoffset();
}

_id_124D4()
{
    level endon( "game_ended" );
    level.scoreinfo["kill"]["value"] = 300;
    scripts\mp\flags::gameflagwait( "props_hide_over" );

    for (;;)
    {
        wait 10;

        foreach ( var_1 in level.players )
        {
            if ( !isdefined( var_1.team ) )
                continue;

            if ( !var_1 update_sentry_settings() )
                continue;

            if ( !scripts\mp\utility\player::isreallyalive( var_1 ) )
                continue;

            var_1 thread monitor_death_thread( "still_alive" );

            switch ( var_1.prop.info.waittill_num_and_all_spawns_dead_and_time_and_player_reset )
            {
                case 250:
                    var_1 thread monitor_death_thread( "still_alive_medium_bonus" );
                    break;
                case 450:
                    var_1 thread monitor_death_thread( "still_alive_large_bonus" );
                    break;
                case 550:
                    var_1 thread monitor_death_thread( "still_alive_extra_large_bonus" );
                    break;
                default:
                    break;
            }
        }
    }
}

_id_127ED()
{
    level endon( "game_ended" );
    _id_12E88();

    for (;;)
    {
        foreach ( var_1 in level.players )
        {
            if ( !isdefined( var_1.team ) )
                continue;

            if ( var_1.team == game["attackers"] )
                continue;

            if ( !scripts\mp\utility\player::isreallyalive( var_1 ) )
                continue;

            if ( isdefined( var_1.pers["propSeconds"] ) )
                var_1.pers["propSeconds"]++;
        }

        wait 1;
    }
}

gamemodemodifyplayerdamage( var_0 )
{
    var_1 = var_0.damage;

    if ( istrue( self.waittill_player_completes_assassination_contract ) )
    {
        self notify( "endPropSpectate" );

        if ( var_0.meansofdeath == "MOD_TRIGGER_HURT" )
            return 0;
    }

    if ( isdefined( var_0.victim.team ) )
    {
        if ( var_0.victim update_sentry_settings() )
            var_1 = showempminimap( var_0 );
        else
            var_1 = showemergencyhint( var_0 );

        if ( var_1 == 0 )
            return 0;
    }

    if ( isdefined( var_0.attacker ) && isplayer( var_0.attacker ) && isalive( var_0.attacker ) )
    {
        if ( !isdefined( var_0.attacker.obj_heli_assault3_fob ) )
            var_0.attacker.obj_heli_assault3_fob = 1;

        if ( level.matchrules_damagemultiplier )
            var_1 = var_1 * level.matchrules_damagemultiplier;

        if ( level.matchrules_vampirism )
            var_0.attacker.health = int( min( float( var_0.attacker.maxhealth ), float( var_0.attacker.health + 20 ) ) );
    }

    return var_1;
}

showempminimap( var_0 )
{
    if ( isdefined( var_0.meansofdeath ) && var_0.meansofdeath == "MOD_FALLING" )
        return 0;

    return var_0.damage;
}

showemergencyhint( var_0 )
{
    if ( isdefined( var_0.meansofdeath ) && var_0.meansofdeath == "MOD_FALLING" )
        return 0;

    if ( var_0.objweapon.basename == "concussion_grenade_mp" )
        return 0;

    if ( issubstr( var_0.objweapon.basename, "destructible" ) )
        return 0;

    return var_0.damage;
}

br_loadout_option()
{
    var_0 = self getweaponslistprimaries();

    foreach ( var_2 in var_0 )
        self givemaxammo( var_2 );

    var_4 = self getweaponammostock( "concussion_grenade_mp" );
    var_4 = var_4 - self._id_1270C;
    var_4 = int( max( var_4, 0 ) );
    self setweaponammostock( "concussion_grenade_mp", var_4 );

    if ( var_4 > 0 )
        thread scripts\mp\gametypes\_prop_controls.gsc::_id_12F62();
}

br_movingcirclegulagcloseoffset()
{
    self endon( "death_or_disconnect" );
    self notify( "attackerRegenAmmo" );
    self endon( "attackerRegenAmmo" );
    level endon( "game_ended" );

    for (;;)
    {
        self waittill( "reload" );
        var_0 = self getcurrentprimaryweapon();
        var_1 = weaponmaxammo( var_0 );

        if ( self getweaponammostock( var_0 ) < var_1 )
            self setweaponammostock( var_0, var_1 );
    }
}

display_hint_for_all()
{
    self endon( "disconnect" );
    level endon( "game_ended" );
    wait 0.1;

    if ( self.pers["lives"] == 1 )
    {
        self.pers["lives"]--;
        level.saw_pickup_think[self.team]--;
        scripts\mp\gamelogic::updategameevents();
        level notify( "propCountChanged" );
        return;
    }
}

vars_print()
{
    var_0 = game["attackers"];

    if ( self.team == game["attackers"] )
        var_0 = game["defenders"];

    scripts\mp\menus::addtoteam( var_0 );
}

onplayerkilled( var_0 )
{
    var_1 = 0;
    level notify( "playerCountChanged" );

    if ( !scripts\mp\flags::gameflag( "prematch_done" ) )
    {
        vars_print();
        return;
    }

    if ( !var_0.victim update_sentry_settings() )
        thread _id_11AAA();
    else if ( !scripts\mp\flags::gameflag( "props_hide_over" ) )
    {
        thread _id_11AAA();
        return;
    }

    if ( isdefined( var_0.attacker ) && isplayer( var_0.attacker ) && var_0.attacker != var_0.victim && var_0.victim.team != var_0.attacker.team )
        var_1 = 1;

    if ( var_1 )
        var_0.attacker thread unset_relic_amped( "prop_finalblow" );

    foreach ( var_3 in level.players )
    {
        if ( istrue( var_3.waittill_player_completes_assassination_contract ) && isdefined( var_3._id_1232E ) && var_0.victim == var_3._id_1232E )
            var_3 notify( "endPropSpectate" );

        if ( var_3 != var_0.attacker && var_3 update_sentry_settings() && isalive( var_3 ) && var_0.victim update_sentry_settings() )
            var_3 thread unset_relic_amped( "prop_survived" );
    }
}

unset_relic_amped( var_0 )
{
    var_1 = undefined;

    switch ( var_0 )
    {
        case "still_alive":
            var_1 = &"SPLASHES_PH/SCORE_STILL_ALIVE";
            break;
        case "still_alive_medium_bonus":
            var_1 = &"SPLASHES_PH/SCORE_STILL_ALIVE_MED_BONUS";
            break;
        case "still_alive_large_bonus":
            var_1 = &"SPLASHES_PH/SCORE_STILL_ALIVE_LARGE_BONUS";
            break;
        case "still_alive_extra_large_bonus":
            var_1 = &"SPLASHES_PH/SCORE_STILL_ALIVE_EXTRA_LARGE_BONUS";
            break;
        case "clone_destroyed":
            var_1 = &"SPLASHES_PH/SCORE_DECOY_KILLED";
            break;
        case "clone_was_destroyed":
            var_1 = &"SPLASHES_PH/SCORE_DECOY_WAS_KILLED";
            break;
        case "prop_finalblow":
            var_1 = &"SPLASHES_PH/PROP_FINALBLOW";
            break;
        case "prop_survived":
            var_1 = &"SPLASHES_PH/PROP_SURVIVED";
            break;
        default:
            return;
    }

    self iprintlnbold( var_1 );
}

_id_11AAA()
{
    thread _id_12E1F();
}

_id_12E1F()
{
    self endon( "started_spawnPlayer" );
    self endon( "disconnect" );
    level endon( "game_ended" );

    for (;;)
    {
        wait 0.05;

        if ( isdefined( self ) && ( self.sessionstate == "spectator" || !scripts\mp\utility\player::isreallyalive( self ) ) )
        {
            self.pers["lives"] = 1;
            scripts\mp\playerlogic::spawnclient();
            continue;
        }

        return;
    }
}

ondeadevent( var_0 )
{
    if ( var_0 == game["defenders"] )
        level thread waittill_any_return_no_endon_death_2();
}

onplayerjointeam( var_0 )
{
    if ( level.teambased )
        var_0 scripts\mp\gametypes\br.gsc::_id_11EE5( 1 );

    if ( !var_0 update_sentry_settings() )
    {
        if ( isdefined( var_0.waittill_any_return_no_endon_death_4 ) )
            var_0 waittill_drone_timeout();
        else if ( isdefined( var_0.waitthensetgendersoundcontext ) )
            var_0 waittill_drone_defined();
    }
}

waittill_any_return_no_endon_death_2()
{
    if ( istrue( level.pickedpball ) )
        return;

    if ( istrue( level.key_hint ) )
        return;

    level.pickedpball = 1;
    var_0 = scripts\mp\utility\game::gettimepassed();
    game["propSurvivalTime"][game["defenders"]] = game["propSurvivalTime"][game["defenders"]] + var_0;
    game["hunterKillTime"][game["attackers"]] = game["hunterKillTime"][game["attackers"]] + var_0;
    level.key_hint = 1;
    wait 3;
    thread tr_createquestlocale( game["attackers"], game["end_reason"][game["defenders"] + "_eliminated"] );
}

trophy_protection_success( var_0, var_1, var_2 )
{
    if ( var_1 == "MOD_EXECUTION" )
        return;

    if ( update_sentry_settings() )
        return;

    var_3 = randomintrange( 1, 8 );
    var_4 = "generic";

    if ( scripts\mp\utility\player::isfemale() )
        var_4 = "female";

    if ( var_1 == "MOD_FALLING" || var_1 == "MOD_SUICIDE" && isplayer( self ) )
    {
        if ( self.team == "axis" )
            scripts\mp\utility\sound::playplayerandnpcsounds( self, "plr_death_explosion", var_4 + "_death_russian_" + var_3 );
        else
            scripts\mp\utility\sound::playplayerandnpcsounds( self, "plr_death_explosion", var_4 + "_death_american_" + var_3 );
    }
    else if ( isplayer( self ) )
    {
        if ( self.team == "axis" )
            scripts\mp\utility\sound::playplayerandnpcsounds( self, "plr_death_generic", var_4 + "_death_russian_" + var_3 );
        else
            scripts\mp\utility\sound::playplayerandnpcsounds( self, "plr_death_generic", var_4 + "_death_american_" + var_3 );
    }
    else if ( self.team == "axis" )
        self playsound( var_4 + "_death_russian_" + var_3 );
    else
        self playsound( var_4 + "_death_american_" + var_3 );
}

kicknullmusicondeath( var_0, var_1, var_2, var_3, var_4 )
{
    if ( istrue( var_3 ) && isdefined( level.waittill_player_deposits ) )
    {
        if ( level.waittill_player_deposits == "kills" )
        {
            self setclientomnvar( "ui_round_end_reason", game["end_reason"]["prop_tiebreaker_kills"] );
            self setclientomnvar( "ui_round_end_friendly_score", game["propScore"][var_4] );
            self setclientomnvar( "ui_round_end_enemy_score", game["propScore"][level.otherteam[var_4]] );
        }
        else if ( level.waittill_player_deposits == "time" )
        {
            var_5 = game["hunterKillTime"][var_4] / 1000;
            var_6 = game["hunterKillTime"][level.otherteam[var_4]] / 1000;
            var_7 = int( scripts\engine\math::round_float( var_5 ) );
            var_8 = int( scripts\engine\math::round_float( var_6 ) );

            if ( var_7 == var_8 )
            {
                if ( var_5 > var_6 )
                    var_7++;
                else
                    var_8++;
            }

            self setclientomnvar( "ui_round_end_reason", game["end_reason"]["prop_tiebreaker_time"] );
            self setclientomnvar( "ui_round_end_friendly_score", var_7 );
            self setclientomnvar( "ui_round_end_enemy_score", var_8 );
        }

        return 1;
    }

    return 0;
}

vehicle_compass_cp_shouldbevisibletoplayer()
{
    level endon( "game_ended" );
    self endon( "disconnect" );

    for (;;)
    {
        var_0 = scripts\engine\utility::_id_12E48( "joined_spectators", "spectating_cycle", "death" );

        if ( var_0 == "death" )
            continue;

        waittillframeend;
        var_1 = self getspectatingplayer();

        if ( !isdefined( var_1 ) )
            continue;
    }
}

paddedquadgridcenterpoints( var_0, var_1, var_2, var_3 )
{
    if ( !isdefined( var_3 ) )
        var_3 = 1;

    self hudoutlinedisable();

    foreach ( var_5 in level.players )
    {
        if ( isdefined( var_2 ) && var_2 == var_5 )
            continue;

        var_6 = var_5.sessionstate == "spectator";

        if ( var_5.team == var_0 && !var_6 )
            self hudoutlineenableforclient( var_5, var_1 );

        if ( var_3 && ( var_5.team == "spectator" || var_6 ) )
            self hudoutlineenableforclient( var_5, var_1 );
    }
}

padcorner3to0dist( var_0, var_1, var_2, var_3 )
{
    self notify( "showToTeam" );
    self endon( "showToTeam" );
    self endon( "clear" );
    self endon( "death" );
    self endon( "maxDelete" );

    if ( !isdefined( var_3 ) )
        var_3 = 1;

    paddedquadgridcenterpoints( var_0, var_1, var_2, var_3 );

    for (;;)
    {
        level waittill( "add_to_team" );
        paddedquadgridcenterpoints( var_0, var_1, var_2, var_3 );
    }
}

doclocksound( var_0 )
{
    foreach ( var_2 in level.players )
    {
        if ( var_2 update_sentry_settings() )
        {
            if ( isdefined( var_2._id_122CD ) && isdefined( var_2._id_122CD.spawnpoint ) && var_2._id_122CD.spawnpoint == var_0 )
                return 0;
        }
    }

    return 1;
}

give_player_knife_on_respawn( var_0 )
{
    if ( scripts\mp\flags::gameflag( "prematch_done" ) )
        return 0;

    if ( !scripts\mp\utility\game::gamehasstarted() )
        return 0;

    if ( var_0 update_sentry_settings() )
        return !level.ingraceperiod;

    return 0;
}

update_sentry_settings()
{
    return isdefined( self.team ) && self.team == game["defenders"];
}

validate_demeanor( var_0 )
{
    return update_sentry_settings() || level.play_travel_vo;
}

monitor_death_thread( var_0 )
{
    var_1 = scripts\mp\rank::getscoreinfovalue( var_0 );
    scripts\mp\rank::giverankxp( var_0, var_1 );
    scripts\mp\utility\points::giveunifiedpoints( var_0, undefined, undefined, 1 );

    if ( isdefined( self.awardsthislife[var_0] ) )
        self.awardsthislife[var_0]++;
    else
        self.awardsthislife[var_0] = 1;

    unset_relic_amped( var_0 );
}

updatex1prematchloadoutarray()
{
    if ( update_sentry_settings() )
        vars_print();
}

updatecollectionui()
{
    tr_vehiclesearchparams();
    self.prevweaponobj = undefined;
    var_0 = scripts\mp\class::loadout_getclassstruct();
    var_0 = scripts\mp\class::loadout_updateclass( var_0, "gamemode" );
    scripts\mp\class::preloadandqueueclassstruct( var_0, 1, 1 );
    self takeallweapons();
    scripts\mp\class::giveloadout( self.team, "gamemode", 1, 1 );
    self givestartammo( var_0.loadoutprimaryobject );
    self givestartammo( var_0.loadoutsecondaryobject );
    scripts\mp\gametypes\br_weapons.gsc::br_ammo_player_clear();
    scripts\mp\gametypes\br_weapons.gsc::br_ammo_give_type( self, "brloot_ammo_762", 200, 0 );
    scripts\mp\gametypes\br_weapons.gsc::br_ammo_update_weapons( self );
    self notify( "ammo_update" );
    update_hint_logic_offhand();
}

vehicle_occupancy_mp_onentervehicle( var_0, var_1, var_2, var_3 )
{
    scripts\mp\vehicles\vehicle_occupancy_mp::vehicle_occupancy_mp_onentervehicle( var_0, var_1, var_2, var_3 );

    if ( var_2 update_sentry_settings() )
        var_2 setcamerathirdperson( 0 );
}

vehicle_occupancy_mp_onexitvehicle( var_0, var_1, var_2, var_3 )
{
    scripts\mp\vehicles\vehicle_occupancy_mp::vehicle_occupancy_mp_onexitvehicle( var_0, var_1, var_2, var_3 );

    if ( !istrue( var_3.playerdisconnect ) && !istrue( var_3.playerdeath ) && var_2 update_sentry_settings() )
        var_2 setcamerathirdperson( 1, var_2._id_126F1, var_2._id_126F0 );
}

droponplayerdeath( var_0 )
{
    if ( istrue( level.usegulag ) && scripts\mp\gametypes\br_public.gsc::isplayeringulag() )
        return 1;

    if ( update_sentry_settings() )
        return 1;

    return 0;
}

manualturret_toggleallowuseactions()
{
    var_0 = scripts\engine\utility::array_randomize( level.players );
    var_1 = level.tower_ground_mortar_2.settings.start_conceal_add;

    if ( level.players.size < var_1 )
        var_1 = 1;

    var_2 = 0;
    var_3 = [];
    var_4 = [];

    foreach ( var_6 in var_0 )
    {
        if ( var_2 < var_1 )
            var_3[var_3.size] = var_6;
        else
            var_4[var_4.size] = var_6;

        var_2++;
    }

    thread _id_11F73( var_3 );
    thread _id_11F84( var_4 );
    return var_3;
}

unset_relic_fastbleedout()
{
    self endon( "disconnect" );
    self notify( "death_or_disconnect" );
    self notify( "death" );
    waittillframeend;
    scripts\mp\gametypes\br_infils.gsc::play_vo_internal();
}

_id_11F73( var_0 )
{
    if ( !istrue( level.br_infils_disabled ) )
    {
        scripts\mp\flags::gameflagwait( "prematch_fade_done" );
        waitframe();
    }

    foreach ( var_2 in var_0 )
    {
        if ( !isdefined( var_2 ) )
            continue;

        if ( var_2 update_sentry_settings() )
        {
            var_2 vars_print();
            var_2 tr_vehiclesearchparams();
            var_2.forcespawnorigin = var_2.origin;
            var_2.forcespawnangles = var_2.angles;
            var_2 thread unset_relic_fastbleedout();
        }

        if ( istrue( level.br_infils_disabled ) )
        {
            var_2 scripts\mp\gametypes\br_weapons.gsc::br_ammo_player_clear();
            var_2 scripts\mp\gametypes\br_weapons.gsc::br_ammo_give_type( var_2, "brloot_ammo_762", 200, 0 );
            scripts\mp\gametypes\br_weapons.gsc::br_ammo_update_weapons( var_2 );
            var_2 notify( "ammo_update" );
        }
    }
}

milestonephasepercent_helis()
{
    if ( !isdefined( level.tower_ground_mortar_2.settings.waypoint_inactive_vfx ) )
        level.tower_ground_mortar_2.settings.waypoint_inactive_vfx = randomint( level.tower_ground_mortar_2.script_model_pilot_kill_watch.size );
    else
        level.tower_ground_mortar_2.settings.waypoint_inactive_vfx = ( level.tower_ground_mortar_2.settings.waypoint_inactive_vfx + 1 ) % level.tower_ground_mortar_2.script_model_pilot_kill_watch.size;

    var_0 = level.tower_ground_mortar_2.script_model_pilot_kill_watch[level.tower_ground_mortar_2.settings.waypoint_inactive_vfx];
    return var_0;
}

milestonephasepercent_vips( var_0, var_1 )
{
    var_2 = 10;
    var_3 = 200.0;
    var_4 = 100.0;
    var_5 = 10.0;
    var_6 = 360.0 / var_2;
    var_7 = int( var_0 / var_2 );
    var_8 = var_0 - var_7 * var_2;
    var_9 = var_8 * var_6 + var_7 * var_5;
    var_10 = var_3 + var_7 * var_4;
    var_11 = ( 0.0, var_9, 0.0 );
    var_12 = anglestoforward( var_11 );
    var_13 = var_1 + var_12 * var_10;
    var_13 = getgroundposition( var_13, 15, 12000, 12000 );
    return var_13;
}

vector_length( var_0 )
{
    self cancelmantle();
    self setorigin( var_0, 1 );
}

_id_12E01( var_0 )
{
    foreach ( var_2 in var_0 )
    {
        if ( !isdefined( var_2 ) )
            continue;

        var_2 scripts\mp\gametypes\br_infils.gsc::hvt_death_player_vo();

        if ( !var_2 update_sentry_settings() )
        {
            var_2 vars_print();
            var_2.forcespawnorigin = var_2.waittill_pickup_or_timeout;
            var_2 thread unset_relic_fastbleedout();
        }
        else if ( !isalive( var_2 ) )
        {
            var_2.forcespawnorigin = var_2.waittill_pickup_or_timeout;
            var_2 scripts\mp\gametypes\br_infils.gsc::play_vo_internal();
        }
        else
        {
            var_2 vector_length( var_2.waittill_pickup_or_timeout );
            var_2.br_infilstarted = 1;
            var_2 scripts\mp\gametypes\_prop_controls.gsc::waitteardowninfilmapomnvars( 1 );
            var_2 scripts\mp\gametypes\_prop_controls.gsc::waittill_interrogation_dialogue_or_timeout( int( level.tower_ground_mortar_2.settings.waitthencheckendgame ) );
            var_2 scripts\mp\gametypes\_prop_controls.gsc::_id_11EC4( var_2.fulton_initrepository );
            var_2 scripts\mp\gametypes\_prop_controls.gsc::_id_11EC4( "CLONE" );
        }

        var_2 notify( "beginC130" );
    }
}

_id_11F84( var_0 )
{
    var_1 = milestonephasepercent_helis();
    var_2 = 0;

    foreach ( var_4 in var_0 )
    {
        if ( !isdefined( var_4 ) )
            continue;

        var_4 scripts\mp\utility\player::hidehudenable();
        var_5 = milestonephasepercent_vips( var_2, var_1.origin );
        var_4.waittill_pickup_or_timeout = var_5;
        var_2++;

        if ( var_2 >= level.tower_ground_mortar_2.settings.start_coop_escape_end_camera )
        {
            var_1 = milestonephasepercent_helis();
            var_2 = 0;
        }
    }

    var_7 = 1;
    var_8 = 1.5;
    var_9 = 1;
    thread scripts\mp\gametypes\br_infils.gsc::infilallfadetoblack( var_7, var_8, var_9, "prop_respawn_finished", var_0, 1 );

    foreach ( var_4 in var_0 )
    {
        if ( !isdefined( var_4 ) )
            continue;

        var_4 predictstreampos( var_4.waittill_pickup_or_timeout, 1 );
    }

    wait( var_7 );
    waitframe();
    empdrone_gameendedthink();
    _id_12E01( var_0 );
    level notify( "prop_respawn_finished" );
    wait( var_8 );

    foreach ( var_4 in var_0 )
    {
        if ( !isdefined( var_4 ) )
            continue;

        var_4 clearpredictedstreampos();
        var_4 scripts\mp\gametypes\br_infils.gsc::hvt_death_player_vo();

        if ( scripts\mp\gametypes\br.gsc::get_int_or_0( var_4.hidehudenabled ) > 0 )
            var_4 scripts\mp\utility\player::hidehuddisable();

        var_4.checkredmassacre = 1;
    }

    scripts\mp\flags::gameflagset( "props_hide_start" );
}

playerthrowsmokesignal( var_0, var_1, var_2, var_3 )
{
    var_4 = getmaxobjectivecount( var_1, var_2, var_3 );
    var_4 setmapcirclecolorindex( 4 );
    var_4 hide( 1 );
    var_4.inuse = 0;
    var_4.count = 0;
    var_4.name = var_0;
    var_4.radius = var_3;
    var_4.watchweapondrop = var_3 * var_3;
    var_5 = scripts\mp\objidpoolmanager::requestobjectiveid( 1 );
    var_4.objectiveiconid = var_5;

    if ( var_5 != -1 )
    {
        scripts\mp\objidpoolmanager::objective_add_objective( var_5, "active", ( 0, 0, 0 ), "ui_mp_br_compass_icon_quest_assassin" );
        scripts\mp\objidpoolmanager::update_objective_setbackground( var_5, 1 );
        objective_showtoplayersinmask( var_5 );
        scripts\mp\objidpoolmanager::update_objective_position( var_5, ( var_1, var_2, 0 ) );
    }

    level.tower_ground_mortar_2.script_model_pilot_kill_watch[level.tower_ground_mortar_2.script_model_pilot_kill_watch.size] = var_4;
}

playerzombiedroploot()
{
    level.tower_ground_mortar_2.waitthensetvisibleteam = [];
    var_0 = level.maxteamsize - level.tower_ground_mortar_2.settings.start_conceal_add;

    for ( var_1 = 0; var_1 < var_0; var_1++ )
    {
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1] = getmaxobjectivecount( 0, 0, 500 );
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1] setmapcirclecolorindex( 1 );
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1] hide( 1 );
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1].inuse = 0;
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1].count = 0;
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1].radius = 500;
        level.tower_ground_mortar_2.waitthensetvisibleteam[var_1].watchweapondrop = 250000;
    }
}

_id_124A0()
{
    var_0 = game["defenders"];

    while ( level.teamdata[var_0]["players"].size == 0 )
        waitframe();

    for (;;)
    {
        var_1 = level.teamdata[var_0]["players"];

        if ( isdefined( level.tower_ground_mortar_2.interaction_point_has_changed ) )
            var_1 = level.tower_ground_mortar_2.interaction_point_has_changed;

        foreach ( var_3 in var_1 )
        {
            if ( isdefined( var_3.waittill_any_return_no_endon_death_4 ) )
            {
                var_4 = level.tower_ground_mortar_2.script_model_pilot_kill_watch[var_3.waittill_any_return_no_endon_death_4];
                var_5 = distance2dsquared( var_4.origin, var_3.origin );

                if ( var_5 <= var_4.watchweapondrop )
                    continue;
                else
                    var_3 waittill_drone_timeout();
            }
            else if ( isdefined( var_3.waitthensetgendersoundcontext ) )
            {
                var_6 = level.tower_ground_mortar_2.waitthensetvisibleteam[var_3.waitthensetgendersoundcontext];
                var_5 = distance2dsquared( var_6.origin, var_3.origin );

                if ( var_5 > var_6.watchweapondrop )
                    var_3 waittill_drone_defined();
            }

            var_7 = undefined;
            var_8 = undefined;

            for ( var_9 = 0; var_9 < level.tower_ground_mortar_2.script_model_pilot_kill_watch.size; var_9++ )
            {
                var_4 = level.tower_ground_mortar_2.script_model_pilot_kill_watch[var_9];
                var_5 = distance2dsquared( var_4.origin, var_3.origin );

                if ( var_5 <= var_4.watchweapondrop && ( !isdefined( var_8 ) || var_5 < var_8 ) )
                {
                    var_8 = var_5;
                    var_7 = var_9;
                }
            }

            if ( isdefined( var_7 ) )
            {
                if ( isdefined( var_3.waitthensetgendersoundcontext ) )
                    var_3 waittill_drone_defined();

                var_3 waiting_for_tactical_restock( var_7 );
                continue;
            }

            if ( !isdefined( var_3.waitthensetgendersoundcontext ) )
                var_3 waiting_for_lethal_restock();
        }

        waitframe();
    }
}

waittill_any_7()
{
    if ( isdefined( self.waittill_any_return_no_endon_death_4 ) )
        return level.tower_ground_mortar_2.script_model_pilot_kill_watch[self.waittill_any_return_no_endon_death_4].name;

    return "any";
}

waiting_for_tactical_restock( var_0 )
{
    self.waittill_any_return_no_endon_death_4 = var_0;
    var_1 = level.tower_ground_mortar_2.script_model_pilot_kill_watch[var_0];
    var_1.count++;

    if ( var_1.count == 1 )
    {
        var_1.inuse = 1;
        var_1 show();
        scripts\mp\objidpoolmanager::update_objective_ownerteam( var_1.objectiveiconid, game["defenders"] );
    }
}

waittill_drone_timeout()
{
    var_0 = self.waittill_any_return_no_endon_death_4;
    var_1 = level.tower_ground_mortar_2.script_model_pilot_kill_watch[var_0];
    var_1.count--;

    if ( var_1.count == 0 )
    {
        var_1.inuse = 0;
        var_1 hide( 1 );
        scripts\mp\objidpoolmanager::update_objective_ownerteam( var_1.objectiveiconid, undefined );
    }

    self.waittill_any_return_no_endon_death_4 = undefined;
}

waiting_for_lethal_restock()
{
    var_0 = matchstarttimer_black_screen();
    self.waitthensetgendersoundcontext = var_0;
    var_1 = level.tower_ground_mortar_2.waitthensetvisibleteam[var_0];
    var_1.count++;

    if ( var_1.count == 1 )
    {
        var_1.inuse = 1;
        var_1 show();
        var_1.watchweapondrop = 250000;
    }

    var_2 = ( self.origin[0], self.origin[1], 500 );
    var_2 = var_2 + scripts\engine\math::random_vector_2d() * randomfloatrange( 0, 500 );
    var_1.origin = var_2;
}

matchstarttimer_black_screen()
{
    for ( var_0 = 0; var_0 < level.tower_ground_mortar_2.waitthensetvisibleteam.size; var_0++ )
    {
        var_1 = level.tower_ground_mortar_2.waitthensetvisibleteam[var_0];

        if ( !var_1.inuse )
            return var_0;
    }
}

waittill_drone_defined()
{
    var_0 = self.waitthensetgendersoundcontext;
    var_1 = level.tower_ground_mortar_2.waitthensetvisibleteam[var_0];
    var_1.count--;

    if ( var_1.count == 0 )
    {
        var_1.inuse = 0;
        var_1 hide( 1 );
    }

    self.waitthensetgendersoundcontext = undefined;
}
