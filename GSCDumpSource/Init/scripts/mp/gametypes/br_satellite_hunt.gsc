// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    if ( getdvarint( "scr_enable_br_satellite_hunt", 0 ) == 0 )
        return;

    level thread playing_bomb_counter_beep();
    level thread playerzombiehitground();
    level playerhandlesponsor();
    scripts\engine\utility::add_fx( "satellite_cache_impact", "vfx/iw8_br/equipment/vfx_satellite_crash_impact.vfx" );
    level.num_nodes_random_search = getdvarint( "scr_harp_radarViewTime", 90 );
    scripts\mp\killstreaks\killstreaks::registerkillstreak( "harp", scripts\cp_mp\killstreaks\uav::tryuseuavfromstruct );
    level.uavsettings["harp"] = spawnstruct();
    level.uavsettings["harp"].health = level.uavsettings["directional_uav"].health;
    level.uavsettings["harp"].maxhealth = level.uavsettings["directional_uav"].maxhealth;
    level.uavsettings["harp"].modelbase = level.uavsettings["directional_uav"].modelbase;
    level.uavsettings["harp"].modelbasealt = level.uavsettings["directional_uav"].modelbasealt;
    level.uavsettings["harp"].fxid_explode = level.uavsettings["directional_uav"].fxid_explod;
    level.uavsettings["harp"].fx_leave_tag = level.uavsettings["directional_uav"].fx_leave_tag;
    level.uavsettings["harp"].fxid_contrail = level.uavsettings["directional_uav"].fxid_contrail;
    level.uavsettings["harp"].fx_contrail_tag = level.uavsettings["directional_uav"].fx_contrail_tag;
    level.uavsettings["harp"].sound_explode = level.uavsettings["directional_uav"].sound_explode;
    level.uavsettings["harp"].calloutdestroyed = level.uavsettings["directional_uav"].calloutdestroyed;
    level.uavsettings["harp"].addfunc = level.uavsettings["directional_uav"].addfunc;
    level.uavsettings["harp"].removefunc = level.uavsettings["directional_uav"].removefunc;
    level.uavsettings["harp"].streakname = "harp";
    level.uavsettings["harp"].teamsplash = "used_harp";
    level.uavsettings["harp"].votimeout = "harp_timeout";
    level.uavsettings["harp"].timeout = level.num_nodes_random_search;
    scripts\cp_mp\utility\script_utility::registersharedfunc( "killstreak", "harpSpawned", ::num_nodes_search_player );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "killstreak", "harpTimeout", ::num_of_frame_frozen );
    level.claymore_crate_update_hint_logic_alt = 0;
    scripts\mp\gametypes\br_gametype_truckwar.gsc::played_fulton_crate_anim();
    level thread scripts\mp\gametypes\br_gametype_truckwar.gsc::_id_12956();
    level thread chopper_can_see();
}

playing_bomb_counter_beep()
{
    game["dialog"]["satellite_located"] = "satellite_located";
    game["dialog"]["uplink_secured"] = "uplink_secured";
    game["dialog"]["harp_friendly_use"] = "harp_friendly_use";
    game["dialog"]["harp_timeout"] = "harp_timeout";
}

num_nodes_search_player( var_0 )
{
    level thread scripts\mp\gametypes\br_public.gsc::cloudanimfx( "harp_friendly_use", var_0.team, 1 );
}

num_of_frame_frozen( var_0 )
{
    level thread scripts\mp\gametypes\br_public.gsc::cloudanimfx( level.uavsettings["harp"].votimeout, var_0.team, 1 );
}

chopper_can_see()
{
    wait 5.0;
    scripts\mp\utility\sound::anim_spawnposition_override( "br_event_satellite_sfx" );
}

weapon_should_not_get_ammo( var_0, var_1 )
{
    var_2 = scripts\engine\trace::ray_trace( var_0, var_1 );

    for ( var_3 = []; isdefined( var_2["entity"] ) && var_3.size < 25; var_2 = scripts\engine\trace::ray_trace( var_0, var_1, var_3 ) )
        var_3[var_3.size] = var_2["entity"];

    return var_2;
}

playerhandlesponsor()
{
    var_0 = getdvar( "scr_satellite_exclusive_items", "brloot_offhand_advancedvehicledrop,brloot_killstreak_harp,brloot_offhand_advancedsupplydrop" );
    var_1 = getdvar( "scr_satellite_exclusive_item_drop_chances", "20,40,40" );
    var_2 = getdvar( "scr_satellite_excusive_item_drop_limits", "4,999,999" );
    var_0 = strtok( var_0, "," );
    var_1 = strtok( var_1, "," );
    var_2 = strtok( var_2, "," );
    var_3 = [];

    for ( var_4 = 0; var_4 < var_0.size; var_4++ )
    {
        var_5 = spawnstruct();
        var_5.type = var_0[var_4];
        var_5.heli_land_logic = int( var_1[var_4] );
        var_5.helibankplunder = int( var_2[var_4] );
        var_5.heli_lookat_monitor = 0;
        var_3[var_5.type] = var_5;
    }

    level._id_11C54 = var_3;
}

heavystatehealthadd( var_0, var_1, var_2, var_3 )
{
    if ( !isdefined( var_2 ) )
        var_2 = ( 0, 0, 0 );

    var_4 = ( 0, 0, 500 );
    var_5 = weapon_should_not_get_ammo( var_1 + var_4, var_1 - var_4 );
    var_6 = var_5["position"] + ( 0, 0, 23 );
    var_7 = var_2 + ( 0, -90, 110 );
    do_satellite_falling( var_0, var_3, var_6 );
    var_8 = _id_12247( var_0, var_6, var_7 );
    var_8 radiusdamage( var_6, 500, 1000, 50 );
    var_8 setscriptablepartstate( "model", "crashed" );
    var_8 playsound( "br_sat_sat_impact" );
    playfx( scripts\engine\utility::getfx( "satellite_cache_impact" ), var_6, anglestoforward( ( 0, var_2[1], 0 ) ), ( 0, 0, 1 ) );
    level thread scripts\mp\gametypes\br_public.gsc::cloudanimfx( "satellite_located", var_0, 1 );
    set_backup_location( var_0, var_8 );
    level thread _id_12F09( var_8, ::stim_crate_update_hint_logic );

    if ( isdefined( level.helidrivableenablesiteondeath ) )
        level.helidrivableenablesiteondeath = scripts\engine\utility::array_add( level.helidrivableenablesiteondeath, var_8 );
}

do_satellite_falling( var_0, var_1, var_2 )
{
    var_3 = var_1 - var_2;
    var_4 = anglestoup( vectortoangles( var_3 ) );
    var_5 = vectortoangles( var_4 );
    var_6 = spawn_falling_satellite( var_1, var_5 );
    var_6 endon( "death" );
    var_6 setscriptablepartstate( "model", "falling" );
    var_7 = distance( var_1, var_2 );
    var_8 = var_7 / 3000;
    var_9 = var_8 * 0.75;
    var_6 moveto( var_2, var_8, var_9, 0.05 );
    var_6 playloopsound( "br_sat_sat_lp" );
    level thread _id_11C50( var_6 );
    level thread _id_11C53( var_6 );
    wait( var_8 );
    var_6 setscriptablepartstate( "model", "impact" );
    satellite_vehicle_impact_crush( var_2 );
    var_6 stoploopsound();
    var_6 notify( "stop_satellite_flight_rumble" );
    var_6 notify( "stop_satellite_vehicle_crush" );
    var_6 delete();
}

satellite_vehicle_impact_crush( var_0 )
{
    var_1 = scripts\engine\trace::sphere_trace_get_all_results( var_0, var_0, 60 );

    foreach ( var_3 in var_1 )
    {
        var_4 = var_3["entity"];
        try_crush_vehicle( var_4, var_0 );
    }
}

_id_11C53( var_0 )
{
    var_0 endon( "death" );
    var_0 endon( "stop_satellite_vehicle_crush" );

    for (;;)
    {
        var_0 waittill( "touch", var_1 );
        try_crush_vehicle( var_1, var_0.origin );
    }
}

try_crush_vehicle( var_0, var_1 )
{
    if ( !isdefined( var_0 ) || !isalive( var_0 ) )
        return;

    if ( !var_0 scripts\common\vehicle::isvehicle() && !isdefined( var_0.classname ) )
        return;

    if ( var_0.classname == "script_vehicle" )
        var_0 dodamage( 10 * var_0.health, var_1 );
}

spawn_falling_satellite( var_0, var_1 )
{
    var_2 = spawn( "script_model", var_0 );
    var_2.angles = var_1;
    var_2 setmodel( "p9_ang_satellite_recovery_unit_full" );
    return var_2;
}

_id_12247( var_0, var_1, var_2 )
{
    var_3 = spawn( "script_model", var_1 );
    var_3.angles = var_2;
    var_3 setmodel( "p9_ang_satellite_recovery_unit_full_02" );
    var_3.id = "care_package";
    var_3.raid_seq3_objectives_func = 1;
    var_3.team = var_0;
    var_4 = scripts\mp\utility\teams::getfriendlyplayers( var_0 );

    if ( var_4.size > 0 )
        var_3 setotherent( var_4[0] );

    return var_3;
}

_id_11C50( var_0 )
{
    var_0 endon( "death" );
    var_0 endon( "stop_satellite_flight_rumble" );
    var_1 = -10000;

    for (;;)
    {
        var_2 = ( var_0.origin[0], var_0.origin[1], var_1 );
        var_3 = physicstrace( var_0.origin, var_2 );
        playrumbleonposition( "artillery_rumble_heavy", var_0.origin );
        playrumbleonposition( "artillery_rumble_heavy", var_3 );
        wait 0.7;
    }
}

set_backup_location( var_0, var_1 )
{
    var_1 makeusable();

    foreach ( var_3 in scripts\mp\utility\teams::getfriendlyplayers( var_0 ) )
    {
        var_1 setotherent( var_3 );
        break;
    }

    var_1 setscriptablepartstate( "objective", "active" );
    var_1 setcursorhint( "HINT_NOICON" );
    var_1 sethintonobstruction( "show" );
    var_1 sethinttag( "tag_use" );
    var_1 sethintdisplayrange( 128 );
    var_1 sethintdisplayfov( 180 );
    var_1 setuserange( 128 );
    var_1 setusefov( 180 );
    var_1 setusepriority( -1 );
    var_1 setuseholdduration( "duration_none" );
    var_1 sethintstring( &"SATELLITE_HUNT/SATELLITE_CACHE_USE_HINT" );
    var_1.userate = 1;
    var_1.usetime = 0;
}

set_actualstarttime( var_0 )
{
    var_0 notify( "satellite_cache_unusable" );
    var_0 makeunusable();
    var_0 setscriptablepartstate( "objective", "inactive" );
}

_id_12F09( var_0, var_1 )
{
    var_0 endon( "death" );
    var_0 endon( "satellite_cache_unusable" );

    for (;;)
    {
        var_0 waittill( "trigger", var_2 );
        var_3 = _id_12963( var_0, var_2 );

        if ( var_3 )
        {
            if ( isdefined( var_1 ) )
                thread [[ var_1 ]]( var_0, var_2 );
        }
    }
}

_id_12963( var_0, var_1 )
{
    var_0 endon( "death" );
    var_0.inuse = 0;
    var_0.playerusing = undefined;
    var_0.curprogress = 0;
    var_2 = 0;

    while ( isdefined( var_1 ) && var_1 usebuttonpressed() )
    {
        if ( var_0.usetime <= 0 )
            return 1;

        var_0.curprogress = var_0.curprogress + level.framedurationseconds * var_0.userate;
        var_1 scripts\mp\gameobjects::updateuiprogress( var_0, 1 );

        if ( var_0.curprogress >= var_0.usetime )
        {
            var_2 = 1;
            break;
        }

        waitframe();
    }

    var_1 scripts\mp\gameobjects::updateuiprogress( var_0, 0 );
    return var_2;
}

stim_crate_update_hint_logic( var_0, var_1 )
{
    var_2 = _id_12248( var_0 );
    set_actualstarttime( var_0 );
    var_0 setscriptablepartstate( "model", "open" );

    if ( isdefined( var_1 ) )
    {
        var_1 scripts\cp\helicopter\chopper_boss::stop_player_trigger_monitor();
        var_3 = [];

        for ( var_4 = 0; var_4 < var_2.size; var_4++ )
        {
            var_3[var_3.size] = "item" + var_4;
            var_3[var_3.size] = var_2[var_4].type;
        }

        var_3[var_3.size] = "time_msfrommatchstart";
        var_3[var_3.size] = scripts\mp\matchdata::gettimefrommatchstart( gettime() );
        var_3[var_3.size] = "pos_x";
        var_3[var_3.size] = var_0.origin[0];
        var_3[var_3.size] = "pos_y";
        var_3[var_3.size] = var_0.origin[1];
        var_3[var_3.size] = "pos_z";
        var_3[var_3.size] = var_0.origin[2];
        var_1 dlog_recordplayerevent( "dlog_event_br_crash_site_recovery", var_3 );
    }
}

_id_12248( var_0 )
{
    var_1 = little_bird_mg_initcollision( var_0 );

    if ( !isdefined( var_1 ) || var_1.size <= 0 )
        return [];

    var_2 = spawnstruct();
    var_3 = anglestoforward( ( 0, var_0.angles[1] - -90, 0 ) );
    var_2.origin = var_0.origin + var_3 * 45;
    var_2.angles = ( 0, var_0.angles[1], 0 );
    var_2.itemsdropped = 0;
    var_4 = var_2 scripts\mp\gametypes\br_lootcache.gsc::selfrevivethink( var_1, 1, undefined );
    _id_127C4( var_4 );
    return var_4;
}

little_bird_mg_initcollision( var_0 )
{
    var_1 = verifybunkercode( "satellite_cache", 0 );

    if ( !isdefined( var_1 ) )
        var_1 = [];

    var_2 = dom_ontimerexpired();

    if ( isdefined( var_2 ) )
        var_1[var_1.size] = var_2;

    return var_1;
}

dom_ontimerexpired()
{
    var_0 = 0;

    foreach ( var_2 in level._id_11C54 )
    {
        if ( var_2.heli_lookat_monitor >= var_2.helibankplunder )
            continue;

        var_0 = var_0 + var_2.heli_land_logic;
    }

    if ( var_0 <= 0 )
        return undefined;

    var_4 = randomint( var_0 );
    var_5 = 0;

    foreach ( var_2 in level._id_11C54 )
    {
        if ( var_2.heli_lookat_monitor >= var_2.helibankplunder )
            continue;

        var_5 = var_5 + var_2.heli_land_logic;

        if ( var_4 < var_5 )
            return var_2.type;
    }

    return undefined;
}

_id_127C4( var_0 )
{
    foreach ( var_2 in var_0 )
    {
        var_3 = level._id_11C54[var_2.type];

        if ( !isdefined( var_3 ) )
            continue;

        var_3.heli_lookat_monitor++;
    }
}

playerzombiehitground()
{
    scripts\mp\flags::gameflagwait( "prematch_done" );
    level.isblocked = [];
    level.isblindedby = [];
    level._id_122B0 = [];
    level.helidrivableenablesiteondeath = [];

    switch ( level.mapname )
    {
        case "mp_br_mechanics":
            level thread playervisibilityrespawntags();
            break;
        case "mp_don4":
            level thread playerwager();
            break;
    }

    level thread playerzombiejump();
    level thread playerusehealslot();
    level thread _id_12B23();
}

ammobox_canweaponacceptmoreattachments( var_0, var_1, var_2 )
{
    if ( !isdefined( level.isblocked[var_0] ) )
        level.isblocked[var_0] = [];

    var_3 = level.isblocked[var_0].size;

    if ( !isdefined( var_2 ) )
        var_2 = ( 0, 0, 0 );

    var_4 = spawnstruct();
    var_4.origin = var_1;
    var_4.angles = var_2;
    level.isblocked[var_0][var_3] = var_4;
}

ammobox_bufferedattachmentweapon( var_0, var_1, var_2 )
{
    var_3 = spawnstruct();
    var_3.crashorigin = var_1;
    var_3.spawnorigin = var_0;
    var_3.farobjectiveiconid = var_2;
    level.isblindedby[level.isblindedby.size] = var_3;
}

playerwager()
{
    ammobox_canweaponacceptmoreattachments( "airport", ( -23095, 15097, -6 ) );
    ammobox_canweaponacceptmoreattachments( "airport", ( -14014, 20695, -390 ) );
    ammobox_canweaponacceptmoreattachments( "airport", ( -8879, 17588, -262 ) );
    ammobox_canweaponacceptmoreattachments( "downtown", ( 24481, -17510, -150 ) );
    ammobox_canweaponacceptmoreattachments( "downtown", ( 28377, -15532, -180 ) );
    ammobox_canweaponacceptmoreattachments( "downtown", ( 30944, -9443, -366 ) );
    ammobox_canweaponacceptmoreattachments( "militarybase", ( 3026, 51369, 1094 ) );
    ammobox_canweaponacceptmoreattachments( "militarybase", ( 2222, 46081, 1466 ) );
    ammobox_canweaponacceptmoreattachments( "militarybase", ( 7569, 47423, 1079 ) );
    ammobox_canweaponacceptmoreattachments( "summit", ( -31645, 45925, 3131 ) );
    ammobox_canweaponacceptmoreattachments( "summit", ( -18635, 62607, 1968 ) );
    ammobox_canweaponacceptmoreattachments( "summit", ( -22281, 53130, 2690 ) );
    ammobox_canweaponacceptmoreattachments( "saltmine", ( 33699, 38645, 770 ) );
    ammobox_canweaponacceptmoreattachments( "saltmine", ( 37949, 42069, 2059 ) );
    ammobox_canweaponacceptmoreattachments( "saltmine", ( 28480, 38949, 765 ) );
    ammobox_canweaponacceptmoreattachments( "array", ( 23659, 24841, 1358 ) );
    ammobox_canweaponacceptmoreattachments( "array", ( 29272, 18345, 1210 ) );
    ammobox_canweaponacceptmoreattachments( "stadium", ( 24237, 5066, -557 ) );
    ammobox_canweaponacceptmoreattachments( "stadium", ( 36604, 6026, -462 ) );
    ammobox_canweaponacceptmoreattachments( "stadium", ( 28682, 212, -526 ) );
    ammobox_canweaponacceptmoreattachments( "farmland", ( 51891, -17870, -332 ) );
    ammobox_canweaponacceptmoreattachments( "farmland", ( 46236, -13936, -17 ) );
    ammobox_canweaponacceptmoreattachments( "farmland", ( 43967, -4737, 337 ) );
    ammobox_canweaponacceptmoreattachments( "superfactory", ( -14036, 9027, 226 ) );
    ammobox_canweaponacceptmoreattachments( "superfactory", ( -14812, 4964, -342 ) );
    ammobox_canweaponacceptmoreattachments( "superfactory", ( -7048, 7646, -269 ) );
    ammobox_canweaponacceptmoreattachments( "boneyard", ( -25772, -9352, 9 ) );
    ammobox_canweaponacceptmoreattachments( "boneyard", ( -28848, -18447, -176 ) );
    ammobox_canweaponacceptmoreattachments( "trainstation", ( -15159, -14136, 258 ) );
    ammobox_canweaponacceptmoreattachments( "trainstation", ( -8952, -15887, -310 ) );
    ammobox_canweaponacceptmoreattachments( "port", ( 38675, -27620, -512 ) );
    ammobox_canweaponacceptmoreattachments( "port", ( 33792, -24817, -508 ) );
    ammobox_canweaponacceptmoreattachments( "lumber", ( 50312, 2539, 78 ) );
    ammobox_canweaponacceptmoreattachments( "lumber", ( 53346, 5901, 88 ) );
    ammobox_canweaponacceptmoreattachments( "hillspromenade", ( -4195, -29916, 334 ) );
    ammobox_canweaponacceptmoreattachments( "hillspromenade", ( -6128, -21873, -226 ) );
    ammobox_canweaponacceptmoreattachments( "superfactory", ( -28088, 9552, -262 ) );
    ammobox_bufferedattachmentweapon( ( -42206, 30546, 15594 ), ( -21206, 55546, 3258 ), ( 0, 63, 0 ) );
    ammobox_bufferedattachmentweapon( ( -7587, 73408, 15594 ), ( -28587, 48408, 2621 ), ( 0, 231, 0 ) );
    ammobox_bufferedattachmentweapon( ( 5434, 42408, 15594 ), ( -15434, 62784, 1890 ), ( 0, 133, 0 ) );
    ammobox_bufferedattachmentweapon( ( 1358, 45734, 15594 ), ( -19642, 20734, -390 ), ( 0, 238, 0 ) );
    ammobox_bufferedattachmentweapon( ( -38950, -9330, 15594 ), ( -17950, 15670, -267 ), ( 0, 57, 0 ) );
    ammobox_bufferedattachmentweapon( ( 15000, 40711, 15594 ), ( -6147, 20711, -298 ), ( 0, 218, 0 ) );
    ammobox_bufferedattachmentweapon( ( 21050, 72623, 15594 ), ( 50, 47623, 1786 ), ( 0, 240, 0 ) );
    ammobox_bufferedattachmentweapon( ( 27637, 73473, 15594 ), ( 6637, 48473, 1082 ), ( 0, 226, 0 ) );
    ammobox_bufferedattachmentweapon( ( 25637, 73557, 15594 ), ( 3434, 53557, 1082 ), ( 0, 234, 0 ) );
    ammobox_bufferedattachmentweapon( ( -1855, -41818, 15594 ), ( 22914, -16594, -158 ), ( 0, 49, 0 ) );
    ammobox_bufferedattachmentweapon( ( 48000, 15912, 15594 ), ( 26741, -5912, -398 ), ( 0, 233, 0 ) );
    ammobox_bufferedattachmentweapon( ( -3944, -4366, 15594 ), ( 27516, -14650, -206 ), ( 0, 337, 0 ) );
    ammobox_bufferedattachmentweapon( ( 55974, 63705, 15594 ), ( 34974, 38705, 767 ), ( 0, 227, 0 ) );
    ammobox_bufferedattachmentweapon( ( 16974, 21705, 15594 ), ( 36216, 41247, 1382 ), ( 0, 55, 0 ) );
    ammobox_bufferedattachmentweapon( ( 9008, 10518, 15594 ), ( 30008, 35518, 639 ), ( 0, 54, 0 ) );
    ammobox_bufferedattachmentweapon( ( 710, -3670, 15594 ), ( 21710, 22670, 1658 ), ( 0, 45, 0 ) );
    ammobox_bufferedattachmentweapon( ( 51763, 46740, 15594 ), ( 30763, 21740, 728 ), ( 0, 230, 0 ) );
    ammobox_bufferedattachmentweapon( ( 39099, 28563, 15594 ), ( 28099, 3563, -520 ), ( 0, 246, 0 ) );
    ammobox_bufferedattachmentweapon( ( 10099, -14500, 15594 ), ( 33112, 6457, -539 ), ( 0, 42, 0 ) );
    ammobox_bufferedattachmentweapon( ( 13642, -25493, 15594 ), ( 34642, -493, -672 ), ( 0, 60, 0 ) );
    ammobox_bufferedattachmentweapon( ( 73223, 10097, 15594 ), ( 52223, -15097, -336 ), ( 0, 229, 0 ) );
    ammobox_bufferedattachmentweapon( ( 63223, 8097, 15594 ), ( 44410, -13675, -49 ), ( 0, 228, 0 ) );
    ammobox_bufferedattachmentweapon( ( 64356, 13848, 15594 ), ( 43356, -12848, -51 ), ( 0, 241, 0 ) );
    ammobox_bufferedattachmentweapon( ( -28813, -21412, 15594 ), ( -7813, 3588, -296 ), ( 0, 49, 0 ) );
    ammobox_bufferedattachmentweapon( ( 10603, 36659, 15594 ), ( -11603, 11659, -249 ), ( 0, 230, 0 ) );
    ammobox_bufferedattachmentweapon( ( 4603, 26659, 15594 ), ( -17047, 8088, -263 ), ( 0, 219, 0 ) );
    ammobox_bufferedattachmentweapon( ( -49541, -35754, 15594 ), ( -28541, -10754, -70 ), ( 0, 48, 0 ) );
    ammobox_bufferedattachmentweapon( ( -2089, 12133, 15594 ), ( -23089, -12867, -135 ), ( 0, 220, 0 ) );
    ammobox_bufferedattachmentweapon( ( -34198, -43327, 15594 ), ( -13198, -18327, -310 ), ( 0, 54, 0 ) );
    ammobox_bufferedattachmentweapon( ( -26949, -33422, 15594 ), ( -5949, -8422, -359 ), ( 0, 49, 0 ) );
    ammobox_bufferedattachmentweapon( ( 9586, -52505, 15594 ), ( 30586, -27505, -508 ), ( 0, 44, 0 ) );
    ammobox_bufferedattachmentweapon( ( -15193, -45559, 15594 ), ( 36193, -20559, -508 ), ( 0, 25, 0 ) );
    ammobox_bufferedattachmentweapon( ( 30115, -26887, 15594 ), ( 51115, -1887, 156 ), ( 0, 50, 0 ) );
    ammobox_bufferedattachmentweapon( ( 69480, 32243, 15594 ), ( 48480, 7243, 35 ), ( 0, 237, 0 ) );
    ammobox_bufferedattachmentweapon( ( -26000, -47000, 15594 ), ( -6755, -29018, 90 ), ( 0, 49, 0 ) );
    ammobox_bufferedattachmentweapon( ( -32000, 0, 15594 ), ( -11306, -20228, -304 ), ( 0, 314, 0 ) );
    ammobox_bufferedattachmentweapon( ( -43000, -12000, 15594 ), ( -23028, 8447, -260 ), ( 0, 47, 0 ) );
    ammobox_bufferedattachmentweapon( ( 25000, -15642, 15594 ), ( 45195, 4358, -42 ), ( 0, 38, 0 ) );
    ammobox_bufferedattachmentweapon( ( 22000, -25000, 15594 ), ( 42167, -6352, 279 ), ( 0, 20, 0 ) );
    ammobox_bufferedattachmentweapon( ( -47000, -39000, 15594 ), ( -27520, -19542, -200 ), ( 0, 50, 0 ) );
}

playervisibilityrespawntags()
{
    ammobox_canweaponacceptmoreattachments( "test", ( 5100, -583, 58 ), ( 0, randomintrange( 0, 360 ), 0 ) );
    ammobox_canweaponacceptmoreattachments( "test", ( 5300, -583, 58 ), ( 0, randomintrange( 0, 360 ), 0 ) );
    ammobox_canweaponacceptmoreattachments( "test", ( 5500, -583, 58 ), ( 0, randomintrange( 0, 360 ), 0 ) );
    ammobox_canweaponacceptmoreattachments( "test", ( 5700, -583, 58 ), ( 0, randomintrange( 0, 360 ), 0 ) );
    ammobox_canweaponacceptmoreattachments( "test", ( 5900, -583, 58 ), ( 0, randomintrange( 0, 360 ), 0 ) );
    ammobox_bufferedattachmentweapon( ( -10000, -376, 8178 ), ( 5100, -450, 58 ) );
    ammobox_bufferedattachmentweapon( ( -10000, -376, 8178 ), ( 5300, -450, 58 ) );
    ammobox_bufferedattachmentweapon( ( -10000, -376, 8178 ), ( 5500, -450, 58 ) );
    ammobox_bufferedattachmentweapon( ( -10000, -376, 8178 ), ( 5700, -450, 58 ) );
    ammobox_bufferedattachmentweapon( ( -10000, -376, 8178 ), ( 5900, -450, 58 ) );
}

playerzombiejump()
{
    var_0 = getdvarint( "scr_satellite_link_per_zone", 1 );

    if ( var_0 <= 0 )
        return;

    if ( !isdefined( level.isblocked ) )
        return;

    var_1 = getdvarint( "scr_satellite_link_total_zones", 15 );

    if ( var_1 <= 0 )
        return;

    var_2 = getarraykeys( level.isblocked );
    var_2 = scripts\engine\utility::array_randomize( var_2 );
    var_3 = [];
    var_4 = 0;

    for ( var_5 = 0; var_4 < var_1 && var_5 < var_2.size; var_5++ )
    {
        var_6 = var_2[var_5 % var_2.size];
        var_7 = int( min( level.isblocked[var_6].size, var_0 ) );

        if ( var_7 <= 0 )
            continue;

        var_8 = randomintrange( 0, var_7 + 1 );
        var_9 = int( min( var_1 - var_4, var_8 ) );
        var_3[var_6] = var_9;
        var_4 = var_4 + var_9;
    }

    for ( var_5 = 0; var_4 < var_1 && var_5 < var_2.size; var_5++ )
    {
        var_6 = var_2[var_5 % var_2.size];

        if ( var_3[var_6] < level.isblocked[var_6].size )
        {
            var_9 = int( min( var_1 - var_4, level.isblocked[var_6].size - var_3[var_6] ) );
            var_3[var_6] = var_3[var_6] + var_9;
            var_4 = var_4 + var_9;
        }
    }

    foreach ( var_14, var_11 in var_3 )
    {
        var_12 = level.isblocked[var_14];

        if ( !isarray( var_12 ) )
            continue;

        var_13 = scripts\engine\utility::array_randomize( var_12 );

        for ( var_5 = 0; var_5 < var_13.size && var_5 < var_0; var_5++ )
            _id_122F7( var_13[var_5].origin, var_13[var_5].angles, 1 );
    }
}

playerusehealslot()
{
    var_0 = getdvarint( "scr_satellite_link_per_zone", 1 );

    if ( var_0 <= 0 )
        return;

    var_1 = level.struct_class_names["targetname"]["satellite_link_station"];

    if ( !isdefined( var_1 ) )
        return;

    foreach ( var_3 in var_1 )
    {
        var_4 = level.struct_class_names["targetname"][var_3.target];

        if ( !isarray( var_4 ) )
            continue;

        var_4 = scripts\engine\utility::array_randomize( var_4 );

        for ( var_5 = 0; var_5 < var_4.size && var_5 < var_0; var_5++ )
        {
            var_6 = var_4[var_5];

            if ( !isdefined( var_6 ) )
                continue;

            _id_122F7( var_6.origin, var_6.angles );
        }
    }
}

_id_122F7( var_0, var_1, var_2 )
{
    if ( !isdefined( var_2 ) )
        var_2 = 0;

    if ( !isdefined( var_1 ) )
        var_1 = ( 0, 0, 0 );

    var_3 = ( 0, 0, 500 );
    var_4 = scripts\engine\trace::ray_trace( var_0 + var_3, var_0 - var_3 );
    var_5 = spawn( "trigger_radius", var_4["position"], 0, int( 128 ), int( 72 ) );
    var_6 = scripts\mp\gametypes\obj_dom.gsc::setupobjective( var_5 );
    var_6 scripts\mp\gameobjects::allowuse( "any" );
    var_6 scripts\mp\gameobjects::cancontestclaim( 1 );
    var_6 scripts\mp\gameobjects::setusetime( 10 );
    var_6.usecondition = ::handledeathfromabove;
    var_6.onbeginuse = ::handlecommand_br;
    var_6.onenduse = ::domflag_onenduse;
    var_6.onuse = ::domflag_onuse;
    var_6.onuseupdate = ::domflag_onuseupdate;
    var_6.lockupdatingicons = 1;
    var_6.docustommusicloopafternuke = 1;
    var_6._id_11D01 = var_2;
    getbnetigrbattlepassxpmultiplier( var_6.objidnum, 450, 500 );
    objective_setshowoncompass( var_6.objidnum, 0 );
    objective_state( var_6.objidnum, "invisible" );
    objective_icon( var_6.objidnum, "ui_mp_br_mapmenu_icon_uplink_objective" );
    var_6.flagmodel setmodel( "p9_wz_sat_link_objective_satellite_01" );
    var_6.flagmodel.angles = ( var_4["normal"][0], var_1[1], var_4["normal"][2] );
    var_6.flagmodel playloopsound( "br_sat_uplink_inactive_loop" );
    level._id_122B0[level._id_122B0.size] = var_6;
}

_id_12B23()
{
    level endon( "game_ended" );

    if ( getdvarint( "satellite_link_objective_pruning", 0 ) == 0 )
        return;

    var_0 = 1;
    var_1 = 1;
    var_2 = 25;
    var_3 = 5000;
    var_4 = var_3 * var_3;

    for (;;)
    {
        if ( isdefined( level.players ) && level.players.size > 0 && isdefined( level._id_122B0 ) && level._id_122B0.size > 0 )
        {
            for ( var_5 = 0; var_5 < level._id_122B0.size; var_5++ )
            {
                var_6 = level._id_122B0[var_5];

                if ( istrue( var_6.trigger.trigger_off ) )
                    continue;

                objective_removeallfrommask( var_6.objidnum );
                var_7 = level.players;

                for ( var_8 = 0; var_8 < var_7.size; var_8++ )
                {
                    var_9 = var_7[var_8];

                    if ( isdefined( var_9 ) )
                    {
                        var_10 = distance2dsquared( var_9.origin, var_6.flagmodel.origin );

                        if ( var_10 <= var_4 )
                            objective_addclienttomask( var_6.objidnum, var_9 );
                    }

                    if ( var_8 % var_2 == 0 )
                        waitframe();
                }

                if ( istrue( var_6.trigger.trigger_off ) )
                    continue;

                objective_showtoplayersinmask( var_6.objidnum );

                if ( var_5 % var_1 == 0 )
                    waitframe();
            }
        }

        wait( var_0 );
    }
}

handledeathfromabove( var_0 )
{
    return 1;
}

handlecommand_br( var_0 )
{
    self.flagmodel playloopsound( "br_sat_uplink_loop" );
}

domflag_onuseupdate( var_0, var_1, var_2, var_3 )
{
    if ( var_1 > 0.05 && var_2 && !istrue( self.didstatusnotify ) )
        self.didstatusnotify = 1;
}

domflag_onuse( var_0 )
{
    self.flagmodel endon( "death" );
    thread handledevcommand_publicevents();
    var_1 = "none";

    if ( isdefined( var_0.team ) )
        var_1 = var_0.team;

    var_2 = [ "time_msfrommatchstart", scripts\mp\matchdata::gettimefrommatchstart( gettime() ), "pos_x", self.flagmodel.origin[0], "pos_y", self.flagmodel.origin[1], "pos_z", self.flagmodel.origin[2] ];
    var_0 dlog_recordplayerevent( "dlog_event_br_sat_link_secure", var_2 );
    level thread scripts\mp\gametypes\br_public.gsc::cloudanimfx( "uplink_secured", var_1, 1 );
    self.flagmodel playsound( "br_sat_uplink_connect" );
    self.flagmodel setscriptablepartstate( "model", "open" );
    scripts\mp\gameobjects::disableobject();

    foreach ( var_4 in scripts\mp\utility\teams::getfriendlyplayers( var_1 ) )
    {
        if ( !var_4 scripts\mp\gametypes\br_public.gsc::isplayeringulag() && var_4 scripts\cp_mp\utility\player_utility::_isalive() )
        {
            var_4 scripts\mp\gametypes\br_plunder.gsc::updateprestreamrespawn( 25 );
            var_4 thread scripts\mp\hud_message::showsplash( "br_satlink_satellite_incoming" );
        }
    }

    while ( self.flagmodel getscriptablepartstate( "model" ) != "captured" )
        waitframe();

    wait( randomfloatrange( 1, 2 ) );

    if ( !self._id_11D01 )
        level thread heliexplode( var_1, self.curorigin );
    else
        level thread heli_setup_and_attack_logic( var_1, self.curorigin );
}

domflag_onenduse( var_0, var_1, var_2 )
{
    scripts\mp\gametypes\obj_dom.gsc::dompoint_onuseend( var_0, var_1, var_2 );
    self.flagmodel stoploopsound();

    if ( !var_2 )
        self.flagmodel playloopsound( "br_sat_uplink_inactive_loop" );
    else if ( isdefined( var_1 ) )
        var_1 scripts\cp\helicopter\chopper_boss::sunpoissonfiltering();
}

handledevcommand_publicevents()
{
    self endon( "removed" );
    waittillframeend;
    domflagupdateicons();
}

domflagupdateicons()
{
    objective_showtoplayersinmask( self.objidnum );
    objective_removeallfrommask( self.objidnum );
}

heli_setup_and_attack_logic( var_0, var_1, var_2 )
{
    if ( !isdefined( var_2 ) )
        var_2 = 7500;

    var_3 = level.isblindedby;
    var_4 = [];
    var_5 = var_2 * var_2;

    foreach ( var_7 in var_3 )
    {
        if ( isdefined( var_7.used ) )
            continue;

        if ( distance2dsquared( var_1, var_7.crashorigin ) > var_5 )
            continue;

        var_4[var_4.size] = var_7;
    }

    if ( var_4.size <= 0 )
        return;

    var_4 = scripts\engine\utility::array_randomize( var_4 );
    var_9 = [];

    foreach ( var_11 in var_4 )
    {
        if ( !isdefined( level.br_circle.dangercircleent ) || scripts\mp\gametypes\br_circle.gsc::ispointincurrentsafecircle( var_11.crashorigin ) )
            var_9[var_9.size] = var_11;
    }

    if ( var_9.size > 0 )
        var_4 = var_9;

    var_7 = var_4[0];
    var_7.used = 1;
    level heavystatehealthadd( var_0, var_7.crashorigin, var_7.farobjectiveiconid, var_7.spawnorigin );
}

heliexplode( var_0, var_1, var_2 )
{
    if ( !isdefined( var_2 ) )
        var_2 = 7500;

    var_3 = level.struct_class_names["targetname"]["satellite_fall_location"];

    if ( !isdefined( var_3 ) )
        return;

    var_4 = [];
    var_5 = var_2 * var_2;

    foreach ( var_7 in var_3 )
    {
        if ( isdefined( var_7.used ) )
            continue;

        if ( distance2dsquared( var_1, var_7.origin ) > var_5 )
            continue;

        var_4[var_4.size] = var_7;
    }

    if ( var_4.size <= 0 )
        return;

    var_4 = scripts\engine\utility::array_randomize( var_4 );
    var_7 = var_4[0];
    var_7.used = 1;
    var_9 = level.struct_class_names["targetname"][var_7.target];

    if ( !isdefined( var_9 ) || !isdefined( var_9[0] ) )
        return;

    level heavystatehealthadd( var_0, var_7.origin, var_7.angles, var_9[0].origin );
}

dangercircletick( var_0, var_1 )
{
    if ( getdvarint( "scr_enable_br_satellite_hunt", 0 ) == 0 )
        return;

    var_2 = var_1 + 3000;
    var_3 = var_2 * var_2;

    foreach ( var_5 in level._id_122B0 )
    {
        if ( distance2dsquared( var_5.curorigin, var_0 ) > var_3 )
            give_player_grenade_on_respawn( var_5 );
    }

    var_7 = var_1 + 3000;
    var_8 = var_7 * var_7;

    for ( var_9 = level.helidrivableenablesiteondeath.size - 1; var_9 >= 0; var_9-- )
    {
        var_10 = level.helidrivableenablesiteondeath[var_9];

        if ( distance2dsquared( var_10.origin, var_0 ) > var_8 )
        {
            var_10 delete();
            level.helidrivableenablesiteondeath = scripts\engine\utility::array_remove_index( level.helidrivableenablesiteondeath, var_9, 0 );
        }
    }
}

give_player_grenade_on_respawn( var_0 )
{
    if ( !isdefined( var_0 ) || istrue( var_0.disabled ) )
        return;

    var_0.trigger triggerdisable();
    var_0.disabled = 1;
    var_0.flagmodel stoploopsound();
    var_0 scripts\mp\gameobjects::disableobject();
}
