// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    if ( !getdvarint( "scr_br_alt_mode_zxp", 0 ) )
        return;

    level.cleanupswaploadoutflags.binoculars_processlosqueue = 1;
    level.cleanupswaploadoutflags._id_1311D = 1;
    level.cleanupswaploadoutflags._id_130FF = forceextractscriptable();
    level.cleanupswaploadoutflags._id_130F3 = getdvarint( "scr_br_zxp_health", 300 );
    level.cleanupswaploadoutflags._id_13127 = getdvarint( "scr_br_zxp_zombiesDamageZombies", 0 );
    level.cleanupswaploadoutflags._id_13128 = getdvarint( "scr_br_zxp_zombiesDamageZombiesDamage", 80 );
    level.cleanupswaploadoutflags._id_1312E = getdvarint( "scr_br_zxp_zombieIgnoreVehicleExplosions", 1 );
    level.cleanupswaploadoutflags.binoculars_onstateinvalidupdate = getdvarint( "scr_br_zxp_allow_zombie_uav", 1 );
    level.cleanupswaploadoutflags._id_1310B = getdvarfloat( "scr_br_zxp_ping_rate", -1 );
    level.cleanupswaploadoutflags._id_1310C = getdvarfloat( "scr_br_zxp_ping_time", 0.5 );
    level.cleanupswaploadoutflags._id_13108 = getdvarint( "scr_br_zxp_num_consume", 2 );
    level.cleanupswaploadoutflags._id_1311B = getdvarfloat( "scr_br_zxp_regen_rate_scale_in_gas", 1.0 );
    level.cleanupswaploadoutflags._id_1311C = getdvarfloat( "scr_br_zxp_regen_rate_scale_out_gas", 0.5 );
    level.cleanupswaploadoutflags._id_13119 = getdvarfloat( "scr_br_zxp_regen_delay_scale_in_gas", 1.0 );
    level.cleanupswaploadoutflags._id_1311A = getdvarfloat( "scr_br_zxp_regen_delay_scale_out_gas", 1.5 );
    level.cleanupswaploadoutflags._id_13118 = getdvarint( "scr_br_zxp_powers", 1 );
    level.cleanupswaploadoutflags.vip_onentergulag = getdvarint( "scr_br_zxp_powers_cooldown", 1 );
    level.cleanupswaploadoutflags._id_13105 = getdvarfloat( "scr_br_zxp_numHits", 3 );
    level.cleanupswaploadoutflags._id_13106 = getdvarfloat( "scr_br_zxp_numHitsJugg", 20 );
    level.cleanupswaploadoutflags._id_130F5 = getdvarint( "scr_br_zxp_ignoreArmor", 1 );
    level.cleanupswaploadoutflags._id_1311E = getdvarint( "scr_br_zxp_respawn_shutdown_jugg", 1 );
    level.cleanupswaploadoutflags._id_13104 = getdvarfloat( "scr_br_zxp_numHitsHeli", 2 );
    level.cleanupswaploadoutflags._id_13102 = getdvarfloat( "scr_br_zxp_numHitsAtv", 2 );
    level.cleanupswaploadoutflags._id_13103 = getdvarfloat( "scr_br_zxp_numHitsCar", 3 );
    level.cleanupswaploadoutflags._id_13107 = getdvarfloat( "scr_br_zxp_numHitsTruck", 4 );
    level.cleanupswaploadoutflags._id_13132 = getdvarint( "scr_br_zxp_spawn_air", 1 );
    level.cleanupswaploadoutflags._id_1313F = getdvarint( "scr_br_zxp_vehicle_laststand", 0 );
    level.cleanupswaploadoutflags._id_13131 = getdvarint( "scr_br_zxp_zombie_spawn_above", 0 );
    level.cleanupswaploadoutflags.pickclassbr = getdvarint( "scr_br_zxp_human_spawn_air", 1 );
    level.cleanupswaploadoutflags.currentvalue = getdvarint( "scr_br_zxp_buyback_human", 1 );
    level.cleanupswaploadoutflags.registerhints = getdvarint( "scr_br_zxp_jugg_num_players", 3 );
    level.cleanupswaploadoutflags.registerlocation = getdvarint( "scr_br_zxp_jugg_health_icon", 0 );
    level.cleanupswaploadoutflags.physicssettled = getdvarint( "scr_br_zxp_server_hud", 0 );
    level.cleanupswaploadoutflags.registerquestcategorytablevalues = getdvarint( "scr_br_zxp_jump_trace_up1_offset", 20 );
    level.cleanupswaploadoutflags.registerscriptableinstance = getdvarint( "scr_br_zxp_jump_trace_up2_offset", 30 );
    level.cleanupswaploadoutflags._id_13141 = getdvarint( "scr_br_zxp_zombie_vision", 1 );
    level.cleanupswaploadoutflags._id_13142 = getdvarint( "scr_br_zxp_zombie_vision_overlay", 1 );
    level.cleanupswaploadoutflags._id_12B69 = getdvarint( "scr_br_zxp_use_armor_headshot_scale", 0 );
    level.cleanupswaploadoutflags._id_130F2 = getdvarfloat( "scr_br_zxp_zombie_headshot_scalar", 0.65 );
    level.cleanupswaploadoutflags.registerleveldataforvehicle = 0;
    level._id_12050 = 1;
    game["dialog"]["zmb_player_into_zombie"] = "zombie_player_into_zombie";
    game["dialog"]["zmb_teammate_into_zombie"] = "zombie_teammate_into_zombie";
    game["dialog"]["zmb_need_someone_alive"] = "zombie_near_end";
    level._effect["zombie_trans"] = loadfx( "vfx/iw8_br/gameplay/zombie/vfx_zmb_transition_to_human.vfx" );
    level._effect["zombie_splat"] = loadfx( "vfx/iw8_br/gameplay/zombie/vfx_zmb_freefall_splat.vfx" );
    level.cleanupswaploadoutflags.empvfx = loadfx( "vfx/iw8_br/gameplay/zombie/vfx_zmb_zombie_emp_blast.vfx" );
    level.cleanupswaploadoutflags.play_go_to_safehouse = loadfx( "vfx/iw8_br/gameplay/zombie/vfx_zmb_human_push_blast" );
    thread playerzombiedelayturnonfx();
}

playerzombiedelayturnonfx()
{
    waittillframeend;

    if ( level.cleanupswaploadoutflags.registerhints > 0 && level.cleanupswaploadoutflags.registerlocation )
        level.registerhint = undefined;

    thread _id_11F9A();
    thread _id_1315E();
}

validatefunc()
{
    var_0 = self;

    if ( !isdefined( var_0.pick_flagcarrier ) )
        var_0 vehicle_damage_givescoreandxpatframeend();

    wait 0.5;
    var_0 updateassassinationthreatlevel();
    wait 2;
    var_0 vehicle_damage_givescore( 0 );
}

modifyplayerdamage( var_0 )
{
    var_1 = 250.0;
    var_2 = 100;
    var_3 = var_0.damage;
    var_4 = isplayer( var_0.attacker ) && var_0.attacker scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder();
    var_5 = isdefined( var_0.attacker ) && var_0.attacker infilvideoplay();
    var_6 = isplayer( var_0.victim ) && var_0.victim scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder();
    var_7 = scripts\mp\utility\weapon::getweaponbasenamescript( var_0.objweapon );

    if ( var_4 && var_6 && var_0.meansofdeath == "MOD_MELEE" )
    {
        if ( !level.cleanupswaploadoutflags._id_13127 )
            var_3 = 0;
        else
            var_3 = level.cleanupswaploadoutflags._id_13128;
    }
    else if ( isdefined( var_0.attacker ) && istrue( var_0.attacker.isjuggernaut ) && var_6 && var_0.meansofdeath == "MOD_MELEE" )
        var_3 = var_0.victim.maxhealth / 3;
    else if ( var_6 && var_0.meansofdeath == "MOD_FALLING" )
        var_3 = 0;
    else if ( var_6 && isdefined( var_0.inflictor ) && isdefined( var_0.inflictor.streakinfo ) && ( var_0.inflictor.streakinfo.streakname == "toma_strike" || var_0.inflictor.streakinfo.streakname == "precision_airstrike" || var_0.inflictor.streakinfo.streakname == "manual_turret" ) )
    {
        var_8 = var_0.victim.maxhealth;
        var_9 = var_0.attacker.maxhealth;
        var_3 = var_0.damage * int( floor( var_8 / var_9 ) );
    }
    else if ( level.cleanupswaploadoutflags._id_1312E && var_6 && isexplosivedamagemod( var_0.meansofdeath ) && isdefined( var_0.inflictor ) && var_0.inflictor scripts\cp_mp\vehicles\vehicle::isvehicle() )
        var_3 = 0;
    else if ( var_6 && ( var_0.meansofdeath == "MOD_GRENADE_SPLASH" || var_0.meansofdeath == "MOD_EXPLOSIVE" ) )
        var_3 = var_0.damage * getdvarfloat( "scr_br_zxp_explosive_dmg_multiplier", 3.0 );
    else if ( var_4 && !var_6 && var_0.meansofdeath == "MOD_MELEE" )
    {
        var_10 = var_0.victim.maxhealth;
        var_11 = level.cleanupswaploadoutflags._id_13105;

        if ( istrue( var_0.victim.isjuggernaut ) )
            var_11 = level.cleanupswaploadoutflags._id_13106;

        if ( !level.cleanupswaploadoutflags._id_130F5 )
            var_10 = var_10 + var_0.victim.br_maxarmorhealth;

        var_3 = int( ceil( var_10 / var_11 ) );
    }
    else if ( var_6 && var_5 && istrue( var_0.victim._id_12D03 ) )
        var_3 = 0;
    else if ( var_4 && !var_6 && var_0.meansofdeath == "MOD_IMPACT" && var_7 == "rock_mp" )
    {
        var_12 = spawnstruct();
        var_12.origin = var_0.point;
        var_0.victim thread scripts\mp\equipment\concussion_grenade::applyconcussion( var_12, var_0.attacker );
    }
    else if ( var_6 )
    {
        var_13 = 0.7;
        var_14 = scripts\mp\utility\weapon::getweaponrootname( var_0.objweapon );
        var_15 = weaponclass( var_7 );
        var_16 = scripts\mp\gametypes\br.gsc::progression_update( var_0.idflags );

        if ( !var_16 )
        {
            switch ( var_15 )
            {
                case "sniper":
                    if ( var_0.shitloc == "head" || var_0.shitloc == "helmet" )
                    {
                        if ( scripts\mp\gametypes\br.gsc::randomize_target( var_14 ) )
                            var_3 = int( ceil( level.cleanupswaploadoutflags._id_130F3 * var_13 ) );
                        else
                            var_3 = level.cleanupswaploadoutflags._id_130F3;
                    }

                    break;
                default:
                    if ( var_0.shitloc == "head" || var_0.shitloc == "helmet" )
                    {
                        var_17 = var_2;

                        if ( level.cleanupswaploadoutflags._id_12B69 )
                            var_17 = var_1;

                        var_3 = int( ceil( var_3 / var_17 * level.cleanupswaploadoutflags._id_130F3 * level.cleanupswaploadoutflags._id_130F2 ) );
                    }

                    break;
            }
        }

        var_18 = "scr_br_zxp_scale_" + var_15;
        var_19 = 0;

        if ( var_15 == "spread" )
            var_19 = 0.7;

        var_20 = getdvarfloat( var_18, var_19 );

        if ( var_20 != 0 )
            var_3 = int( ceil( var_3 * var_20 ) );

        var_21 = "scr_br_zxp_scale_" + var_14;
        var_19 = 0;

        if ( var_14 == "iw8_sh_charlie725" )
            var_19 = 1.43;

        var_22 = getdvarfloat( var_21, var_19 );

        if ( var_22 != 0 )
            var_3 = int( ceil( var_3 * var_22 ) );
    }

    return var_3;
}

infilvideoplay()
{
    return scripts\common\vehicle::isvehicle() || isdefined( self.classname ) && self.classname == "script_vehicle";
}

showintelinstancetoplayer( var_0 )
{
    var_1 = var_0.damage;
    var_2 = var_0.victim;
    var_3 = isplayer( var_0.attacker ) && var_0.attacker scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder();
    var_4 = var_2.vehiclename;

    if ( var_3 && var_0.meansofdeath == "MOD_MELEE" )
    {
        switch ( var_4 )
        {
            case "atv":
                var_1 = var_2.maxhealth / level.cleanupswaploadoutflags._id_13102;
                break;
            case "tac_rover":
            case "jeep":
                var_1 = var_2.maxhealth / level.cleanupswaploadoutflags._id_13103;
                break;
            case "cargo_truck_mg":
            case "cargo_truck":
                var_1 = var_2.maxhealth / level.cleanupswaploadoutflags._id_13107;
                break;
            case "little_bird_mg":
            case "little_bird":
                var_1 = var_2.maxhealth / level.cleanupswaploadoutflags._id_13104;
                break;
            default:
                break;
        }

        var_1 = int( ceil( var_1 ) );
    }

    return var_1;
}

setincomingcallback( var_0, var_1 )
{
    var_2 = var_0 vehicle_collision_dvarupdate( var_1 );

    if ( scripts\mp\flags::gameflag( "prematch_done" ) && !var_2 )
        scripts\mp\gametypes\br.gsc::set_spawner_type( var_0 );

    return !var_2;
}

_id_122C5( var_0 )
{
    if ( istrue( var_0.br_infilstarted ) && scripts\mp\flags::gameflag( "prematch_done" ) && var_0 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
    {
        var_0 usablecarriables();
        return 1;
    }

    return 0;
}

set_spotlight_target_loc()
{
    return 0;
}

vehicle_collision_dvarupdate( var_0 )
{
    if ( !istrue( var_0 ) )
    {
        if ( scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
        {
            thread unpause_dmz_scoring();
            return 0;
        }
    }

    if ( !istrue( self.br_infilstarted ) || !scripts\mp\flags::gameflag( "prematch_done" ) || level.gameended || !level.cleanupswaploadoutflags._id_1311D )
        return 0;

    thread vehicle_damage_givescore( 0 );
    return 1;
}

unpause_dmz_scoring()
{
    self endon( "disconnect" );
    self setscriptablepartstate( "zombie", "off" );
    self setscriptablepartstate( "compassicon", "defaulticon" );
    self setscriptablepartstate( "skydiveVfx", "default", 0 );

    if ( level.cleanupswaploadoutflags._id_13141 )
    {
        update_health_think();

        if ( !level.cleanupswaploadoutflags._id_13142 )
            self setscriptablepartstate( "headVFX", "neutral" );

        self visionsetnakedforplayer( "", 0 );
    }

    waittillframeend;
    usepingsystem( 0, 1 );
    updatescavengerhud( 0 );
}

update_health_think()
{
    foreach ( var_1 in level.players )
    {
        if ( !var_1 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
            var_1 hudoutlinedisableforclient( self );
    }
}

usepingsystem( var_0, var_1 )
{
    self.iszombie = var_0;
    useprophudserver( var_0 );

    if ( isdefined( level.cleanupswaploadoutflags.setbettermissionrewards ) )
        scripts\mp\gametypes\br_gametype_zxp.gsc::vehicle_collision_loadtable( var_0 );

    if ( var_0 )
    {
        self notify( "zombie_set" );

        if ( level.cleanupswaploadoutflags.physicssettled )
            vehicle_damage_givescoreandxpatframeend();

        self.start_bomb_vest_global_timer = 0;
        self.bcdisabled = 1;
        self.killstreaktoscorestreak_scoretokill = 1;
        usefuncoverride( 0 );
        scripts\cp\equipment\cp_incendiarylauncher::calloutmarkerping_removecallout( 7 );
        scripts\cp\equipment\cp_incendiarylauncher::calloutmarkerping_removecallout( 9 );
        scripts\cp\equipment\cp_incendiarylauncher::calloutmarkerping_removecallout( 10 );
        scripts\cp\equipment\cp_incendiarylauncher::calloutmarkerping_removecallout( 11 );
        _id_12B3F( "numVaccine", self.start_bomb_vest_global_timer );
    }
    else
    {
        self notify( "zombie_unset" );
        self.start_bomb_vest_global_timer = undefined;
        self.bcdisabled = undefined;
        self.killstreaktoscorestreak_scoretokill = undefined;
        scripts\cp\equipment\cp_incendiarylauncher::calloutmarkerping_removecallout( 7 );

        if ( isdefined( level.cleanupswaploadoutflags.setbettermissionrewards ) )
            scripts\mp\gametypes\br_gametype_zxp.gsc::update_current_solution();
    }

    level notify( "players_remaining_changed" );
    self notify( "stop_battlechatter" );

    if ( istrue( var_1 ) )
    {
        self lerpfovbypreset( "default" );

        if ( level.cleanupswaploadoutflags._id_13142 )
            thread scripts\mp\supers\super_deadsilence::superdeadsilence_endhudsequence();
    }
}

forceextractscriptable()
{
    var_0 = [];
    var_0["loadoutArchetype"] = "archetype_assault";
    var_0["loadoutPrimary"] = "iw8_fists";
    var_0["loadoutPrimaryAttachment"] = "none";
    var_0["loadoutPrimaryAttachment2"] = "none";
    var_0["loadoutPrimaryCamo"] = "none";
    var_0["loadoutPrimaryReticle"] = "none";
    var_0["loadoutSecondary"] = "none";
    var_0["loadoutSecondaryAttachment"] = "none";
    var_0["loadoutSecondaryAttachment2"] = "none";
    var_0["loadoutSecondaryCamo"] = "none";
    var_0["loadoutSecondaryReticle"] = "none";
    var_0["loadoutMeleeSlot"] = "none";
    var_0["loadoutEquipmentPrimary"] = "none";
    var_0["loadoutEquipmentSecondary"] = "none";
    var_0["loadoutStreakType"] = "assault";
    var_0["loadoutKillstreak1"] = "none";
    var_0["loadoutKillstreak2"] = "none";
    var_0["loadoutKillstreak3"] = "none";
    var_0["loadoutSuper"] = "super_br_extract";
    var_0["loadoutPerks"] = [ "specialty_null" ];
    var_0["loadoutGesture"] = "playerData";
    var_0["loadoutExecution"] = "none";
    return var_0;
}

phfrozen( var_0 )
{
    var_1 = getarraykeys( level.teamdata );

    foreach ( var_3 in var_1 )
    {
        var_4 = level.teamdata[var_3]["players"];

        foreach ( var_6 in var_4 )
        {
            if ( var_6 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
            {
                if ( level.cleanupswaploadoutflags.physicssettled )
                    var_6 vehicle_compass_setteamfriendlyto();

                var_6 updatespecificfobindanger();
                continue;
            }

            var_6 updatespecificfobindanger();
        }
    }
}

vehicle_damage_givescoreandxpatframeend()
{
    var_0 = -60;
    var_1 = 120;
    var_2 = 180;
    self.phonehint = unlockprop( var_0, var_1, "right", "middle", "center", "middle", &"MP_ZXP/NUM_CONSUMED", 0 );
    self.phoneisnotringing = unlockprop( var_0, var_1, "left", "middle", "center", "middle", &"MP_ZXP/NUM_TO_CONSUME", level.cleanupswaploadoutflags._id_13108 );
    self.pick_flagcarrier = unlockprop( 0, var_2, "center", "middle", "center", "middle", &"MP_ZXP/ZOMBIE" );
}

unlockprop( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7 )
{
    var_8 = scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_8.x = var_0;
    var_8.y = var_1;
    var_8.alignx = var_2;
    var_8.aligny = var_3;
    var_8.horzalign = var_4;
    var_8.vertalign = var_5;
    var_8.alpha = 0;
    var_8.glowalpha = 0;
    var_8.hidewheninmenu = 1;
    var_8.archived = 0;

    if ( isdefined( var_6 ) )
        var_8.label = var_6;

    if ( isdefined( var_7 ) )
        var_8 setvalue( var_7 );

    return var_8;
}

useprophudserver( var_0 )
{
    if ( istrue( var_0 ) )
        self.game_extrainfo = self.game_extrainfo | 4096;
    else
        self.game_extrainfo = self.game_extrainfo & ~4096;
}

vehicle_damage_givescore( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self endon( "zombie_unset" );

    if ( level.gameended )
        return;

    if ( !isdefined( level.teamdata[self.team]["lastZombieTime"] ) && !isdefined( level._id_11AFA ) )
        scripts\mp\gametypes\br_public.gsc::cloudanimfx( "zmb_need_someone_alive", self.team );

    _id_11F04( self.team );
    usefuncoverride( 1 );
    vehicle_damage_inithitdamage( 1 );
    waittillframeend;
    usepingsystem( 1 );
    self._id_11AA7 = 1;

    if ( isdefined( level._id_11AFA ) )
        usablecarriables();
    else if ( var_0 )
        vehicle_compass_br_shouldbevisibletoplayer();
    else
        usablecarriables();

    if ( scripts\mp\gametypes\br_gametypes.gsc::progress_obj( "playerGetZombieSpawnLocation" ) )
        [var_2, var_3] = scripts\mp\gametypes\br_gametypes.gsc::_id_11BE4( "playerGetZombieSpawnLocation" );
    else
        [var_2, var_3] = unset_relic_vampire();

    [var_2, var_6] = vehicle_damage_giveaward( var_2, var_3 );
    scripts\mp\gametypes\br_gulag.gsc::gulagfadetoblack();
    wait 1;
    scripts\mp\class::loadout_emptycacheofloadout( "gamemode" );
    self.pers["gamemodeLoadout"] = level.cleanupswaploadoutflags._id_130FF;
    self.class = "gamemode";
    self.forcespawnangles = var_3;
    self.forcespawnorigin = var_6;
    scripts\mp\playerlogic::spawnplayer( undefined, 0 );
    thread scripts\mp\music_and_dialog::_id_130D1();
    scripts\cp_mp\execution::_clearexecution();
    scripts\mp\gametypes\br_pickups.gsc::initplayer( 1 );
    scripts\mp\gametypes\br_spectate.gsc::unload_vehicles_on_weapons_free();
    self notify( "endSuperJumpFov" );
    var_7 = getcompleteweaponname( "iw8_fists_mp" );
    scripts\cp_mp\utility\inventory_utility::_takeweapon( var_7 );
    var_8 = getcompleteweaponname( "iw8_fists_mp_zmb" );
    scripts\cp_mp\utility\inventory_utility::_giveweapon( var_8, undefined, undefined, 1 );
    self detachall();
    self setmodel( "fullbody_zombie_a" );
    self setviewmodel( "vm_arms_zombie_a" );
    scripts\mp\utility\player::_setsuit( "iw8_zombie_mp" );
    vandalize_spotlight_speed( var_2, var_3, var_6 );
    self skydive_interrupt();
    self.is_bomb_use_allowed = 5;
    self skydive_setbasejumpingstatus( 0 );
    self skydive_setdeploymentstatus( 0 );
    self skydive_beginfreefall();
    thread scripts\cp_mp\utility\inventory_utility::_switchtoweaponimmediate( var_8 );
    updatescavengerhud( 1 );
    thread vehicle_damage_cp_init( var_8 );
    thread scripts\mp\gametypes\br.gsc::checkpoint_fx_play();
    thread vehicle_damage_isburningdown();

    if ( level.cleanupswaploadoutflags.binoculars_onstateinvalidupdate )
        thread vehicle_damage_givescoreandxp();

    if ( istrue( level.cleanupswaploadoutflags._id_130E8 ) )
        thread scripts\mp\gametypes\br_gametype_zxp.gsc::vehicle_damage_ondeathscore();

    thread vehicle_createspawnselectiontankmarker();
    scripts\mp\utility\perk::giveperk( "specialty_tracker" );
    scripts\mp\utility\perk::giveperk( "specialty_sprintmelee" );
    scripts\mp\utility\perk::giveperk( "specialty_sprintads" );
    scripts\common\utility::allow_crate_use( 0 );
    scripts\common\utility::allow_vehicle_use( 0 );
    self lerpfovbypreset( "zombiedefault" );

    if ( level.cleanupswaploadoutflags._id_13142 )
        self setclientomnvar( "ui_deadsilence_overlay", 0 );

    thread vehicle_compass_setplayerfriendlyto();
    self setscriptablepartstate( "compassicon", "zombie" );

    if ( getdvarint( "scr_br_zxp_force_netfield_high_lod_zombies", 0 ) )
        self forcenetfieldhighlod( 1 );

    if ( isdefined( level._id_11AFA ) )
        scripts\mp\hud_message::showsplash( "br_reveal_stop_exfil" );
    else
        scripts\mp\hud_message::showsplash( "br_gametype_zxp_change" );

    if ( !scripts\mp\utility\perk::_hasperk( "specialty_pistoldeath" ) )
        scripts\mp\utility\perk::giveperk( "specialty_pistoldeath" );

    self.maxhealth = level.cleanupswaploadoutflags._id_130F3;
    self.health = self.maxhealth;
    scripts\mp\gametypes\br_armor.gsc::monitor_bush_trig( 0 );
    self._id_11AA7 = undefined;
    wait 3;

    if ( !isdefined( level._id_11AFA ) && scripts\mp\utility\game::missions_clearinappropriaterewards() != "brz" )
    {
        foreach ( var_10 in level.teamdata[self.team]["players"] )
        {
            if ( self == var_10 )
            {
                scripts\mp\gametypes\br_public.gsc::cloud_cover( "zmb_player_into_zombie", var_10 );
                continue;
            }

            scripts\mp\gametypes\br_public.gsc::cloud_cover( "zmb_teammate_into_zombie", var_10 );
        }
    }
}

usb_left( var_0 )
{
    if ( scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
    {
        if ( istrue( self._id_130F6 ) )
            return int( level.cleanupswaploadoutflags._id_1311B * var_0 );
        else
            return int( level.cleanupswaploadoutflags._id_1311C * var_0 );
    }

    return undefined;
}

updatescavengerhud( var_0 )
{
    scripts\mp\gametypes\br_public.gsc::update_enemies_remaining( var_0 );

    if ( var_0 )
    {
        if ( level.cleanupswaploadoutflags.physicssettled )
        {
            self.phonehint.alpha = 1;
            self.phoneisnotringing.alpha = 1;
            self.pick_flagcarrier.alpha = 1;
        }

        self disableweaponpickup();
    }
    else
    {
        vehicle_compass_setteamfriendlyto();
        self enableweaponpickup();
    }
}

_id_11F04( var_0 )
{
    level.teamdata[var_0]["lastZombieTime"] = gettime();
}

usefuncoverride( var_0 )
{
    self.processedsplash = var_0;
}

vehicle_damage_inithitdamage( var_0 )
{
    var_1 = self.team;
    scripts\mp\utility\teams::_id_12BBA( "mode", var_1, self );
    vehicle_collision_getignoreevent();

    if ( istrue( var_0 ) )
        [[ level.updategameevents ]]();
}

vehicle_compass_setteamfriendlyto()
{
    if ( isdefined( self.phonehint ) )
        thread get_total_from_call_count( self.phonehint, 1.5 );

    if ( isdefined( self.phoneisnotringing ) )
        thread get_total_from_call_count( self.phoneisnotringing, 1.5 );

    if ( isdefined( self.pick_flagcarrier ) )
        self.pick_flagcarrier destroy();

    self.phonehint = undefined;
    self.phoneisnotringing = undefined;
    self.pick_flagcarrier = undefined;
}

get_total_from_call_count( var_0, var_1 )
{
    wait( var_1 );

    if ( isdefined( var_0 ) )
        var_0 destroy();
}

updatearenaomnvarplayers()
{
    return isdefined( self._id_13160 );
}

usb_keys( var_0 )
{
    if ( scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
    {
        if ( istrue( self._id_130F6 ) )
            return 1 / level.cleanupswaploadoutflags._id_13119 * var_0;
        else
            return 1 / level.cleanupswaploadoutflags._id_1311A * var_0;
    }

    return undefined;
}

onuse( var_0 )
{
    thread supportbox_updateheadicon( var_0 );
}

supportbox_updateheadicon( var_0 )
{
    if ( !isdefined( var_0 ) )
    {
        thread scripts\mp\gametypes\br_gametype_zxp.gsc::removetags( self );
        return;
    }

    if ( !playercanusetags( var_0 ) )
        return;

    thread scripts\mp\gametypes\br_gametype_zxp.gsc::removetags( self );
    var_0.start_bomb_vest_global_timer++;

    if ( level.cleanupswaploadoutflags.physicssettled )
        var_0 update_gamebattles_char_loc();

    var_0 _id_12B3F( "numVaccine", var_0.start_bomb_vest_global_timer );

    if ( isdefined( level.cleanupswaploadoutflags.setbettermissionrewards ) && var_0.start_bomb_vest_global_timer >= level.cleanupswaploadoutflags._id_13108 )
        var_0 thread scripts\mp\gametypes\br_gametype_zxp.gsc::vehicle_compass_mp_init();
}

playercanusetags( var_0 )
{
    return var_0 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder();
}

update_gamebattles_char_loc()
{
    var_0 = ( 0, 1, 0 );
    self.phonehint setvalue( self.start_bomb_vest_global_timer );
    self.phonehint thread phase_three_combat( var_0 );
    self.phoneisnotringing thread phase_three_combat( var_0 );
}

phase_three_combat( var_0 )
{
    self endon( "death" );

    if ( istrue( self.waittillspectating ) )
        return;

    var_1 = 0.5;
    var_2 = 4;
    self.waittillspectating = 1;
    var_3 = self.fontscale;
    var_4 = self.color;

    if ( isdefined( var_0 ) )
        self.color = var_0;

    self changefontscaleovertime( var_1 );
    self.fontscale = var_2;
    wait( var_1 );
    self changefontscaleovertime( var_1 );
    self.fontscale = var_3;
    wait( var_1 );
    self.color = var_4;
    self.waittillspectating = undefined;
}

updateassassinationthreatlevel()
{
    var_0 = spawnstruct();
    var_0.current = self getcurrentprimaryweapon();
    var_0.wait_for_player_in_gas = [];
    var_0.bloadinghvt = [];
    var_0.blockachievementstimestamp = [];
    var_0.blockade_get_bomb_icon_on_cell_phone = [];
    var_0.offhands = [];
    var_0.init_client = [];
    var_1 = [];
    var_2 = self getweaponslistprimaries();

    foreach ( var_4 in var_2 )
    {
        if ( !scripts\mp\utility\weapon::putinlaststand( var_4 ) && !issubstr( var_4.basename, "iw8_fists_mp" ) && !scripts\mp\utility\weapon::propwatchcleanuponroundend( var_4.basename ) )
            var_1[var_1.size] = var_4;
    }

    foreach ( var_7 in var_1 )
    {
        var_8 = createheadicon( var_7 );
        var_0.bloadinghvt[var_8] = weaponclipsize( var_7 );
        var_0.blockade_get_bomb_icon_on_cell_phone[var_8] = self getweaponammostock( var_7 );

        if ( scripts\mp\utility\weapon::printcodechosen( var_7 ) )
            var_0.blockachievementstimestamp[var_8] = self getweaponammoclip( var_7, "left" );

        if ( getsubstr( var_8, 0, 4 ) == "alt_" )
            continue;

        var_0.wait_for_player_in_gas[var_0.wait_for_player_in_gas.size] = var_7;
    }

    var_10 = self getweaponslistoffhands();

    foreach ( var_12 in var_10 )
    {
        if ( var_12.basename == "bandage_br" )
            continue;

        var_13 = self getweaponammoclip( var_12 );

        if ( var_13 <= 0 )
            continue;

        var_0.offhands[var_0.offhands.size] = var_12;
        var_14 = createheadicon( var_12 );
        var_0.bloadinghvt[var_14] = var_13;
    }

    foreach ( var_18, var_17 in self.equipment )
        var_0.init_client[var_17] = var_18;

    var_0.super = undefined;

    if ( isdefined( self.super ) && !self.super.usepercent )
        var_0.super = self.equipment["super"];

    self._id_13160 = var_0;
}

vehicle_compass_br_shouldbevisibletoplayer()
{
    if ( scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
        self waittill( "spawnZombie" );
}

usablecarriables()
{
    self notify( "spawnZombie" );
    self _meth_87A8( "zombie" );
    self setclothtype( "cloth" );
    scripts\mp\deathicons::outofboundstriggersspawned( self );
}

modetype( var_0, var_1, var_2 )
{
    var_3 = var_0 + var_1 * var_2;

    if ( scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_3, 1 ) )
    {
        var_4 = vectortoangles( var_1 * -1 );
        return [ var_3, var_4 ];
    }
    else
        return [ undefined, undefined ];
}

vehicle_damage_applytabletovehicle()
{
    var_0 = undefined;
    var_1 = undefined;
    var_2 = getdvarfloat( "scr_br_zxp_respawnTeamOffset", 10000 );

    if ( var_2 >= 0 )
    {
        var_3 = scripts\mp\gametypes\br_gulag.gsc::unset_relic_headbullets( 0 );

        if ( isdefined( var_3 ) )
        {
            var_0 = minigameinfo( var_3.origin, var_2 );
            var_0 = scripts\mp\gametypes\br_public.gsc::helihint_deposit( var_0 );
            var_1 = scripts\mp\gametypes\br_gulag.gsc::loot_getitemcountlefthand( var_0, var_3.origin );
        }
    }

    return [ var_0, var_1 ];
}

minigameinfo( var_0, var_1 )
{
    var_2 = 3.14159;
    var_3 = scripts\mp\gametypes\br_circle.gsc::getsafecircleorigin();
    var_4 = vectornormalize( var_0 - var_3 );
    var_5 = vectortoangles( var_4 );
    var_6 = randomfloatrange( getdvarfloat( "scr_br_respawn_rand_ang_min", 10.0 ), getdvarfloat( "scr_br_respawn_rand_ang_max", 60.0 ) );
    var_7 = var_4;
    var_8 = var_0 + var_7 * var_1;

    if ( scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_8, 0 ) )
        return var_8;

    var_7 = var_7 * -1;
    var_8 = var_0 + var_7 * var_1;

    if ( scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_8, 0 ) )
        return var_8;

    var_7 = vectornormalize( var_3 - var_0 );
    var_8 = var_0 + var_7 * var_1;

    if ( scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_8, 0 ) )
        return var_8;

    var_9 = var_1;
    var_10 = distance2d( var_0, var_3 );
    var_11 = var_9 / var_10;

    if ( var_11 > var_2 )
        var_11 = var_2;

    var_12 = var_11 * 180 / var_2;
    var_8 = rotatepointaroundvector( ( 0, 0, 1 ), var_0 - var_3, var_12 ) + var_3;

    if ( scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_8, 0 ) )
        return var_8;

    var_8 = scripts\mp\gametypes\br_circle.gsc::getrandompointincircle( var_0, var_1 );

    if ( scripts\mp\gametypes\br_c130.gsc::ispointinbounds( var_8, 0 ) )
        return var_8;

    return undefined;
}

unset_relic_vampire()
{
    var_0 = 50;
    var_1 = 10000;
    [var_3, var_4] = vehicle_damage_applytabletovehicle();

    if ( isdefined( var_3 ) )
        return [ var_3, var_4 ];

    if ( !isdefined( level.br_circle ) || !isdefined( level.br_circle.dangercircleent ) || istrue( level.cleanupswaploadoutflags._id_13131 ) )
        return [ self.origin, self getplayerangles() ];

    var_5 = scripts\mp\gametypes\br_circle.gsc::getdangercircleradius();
    var_6 = scripts\mp\gametypes\br_circle.gsc::getdangercircleorigin();
    var_7 = var_5 + var_0;
    var_8 = ( self.origin[0], self.origin[1], 0 );
    var_9 = vectornormalize( var_8 - var_6 );
    [var_11, var_4] = modetype( var_6, var_9, var_7 );

    if ( !isdefined( var_11 ) )
    {
        var_9 = var_9 * -1;
        [var_11, var_4] = modetype( var_6, var_9, var_7 );
    }

    if ( !isdefined( var_11 ) )
    {
        var_9 = ( 1, 0, 0 );
        [var_11, var_4] = modetype( var_6, var_9, var_7 );
    }

    if ( !isdefined( var_11 ) )
    {
        var_9 = ( -1, 0, 0 );
        [var_11, var_4] = modetype( var_6, var_9, var_7 );
    }

    if ( !isdefined( var_11 ) )
    {
        var_9 = ( 0, 1, 0 );
        [var_11, var_4] = modetype( var_6, var_9, var_7 );
    }

    if ( !isdefined( var_11 ) )
    {
        var_9 = ( 0, -1, 0 );
        [var_11, var_4] = modetype( var_6, var_9, var_7 );
    }

    if ( !isdefined( var_11 ) )
    {
        var_11 = self.origin;
        var_4 = self.angles;
    }

    var_3 = scripts\mp\gametypes\br_public.gsc::helihint_deposit( var_11, var_1 );
    return [ var_3, var_4 ];
}

vehicle_damage_giveaward( var_0, var_1 )
{
    var_2 = var_0;

    if ( level.cleanupswaploadoutflags._id_13132 )
    {
        var_3 = getdvarint( "scr_br_zxp_respawnZombieHeight", 10000 );
        var_4 = ( 0, 0, var_3 );
        var_0 = scripts\mp\gametypes\br.gsc::getoffsetspawnorigin( var_0, var_4 );
        var_5 = spawnstruct();
        var_5.origin = var_0;
        var_5.angles = var_1;
        var_5.height = var_3;
        var_2 = scripts\mp\gametypes\br_gulag.gsc::updatex1stashhud( var_5 );
    }
    else
    {
        self setpredictedstreamloaddist( 0.0 );
        scripts\mp\gametypes\br_public.gsc::vandalize_internal( var_2 );
    }

    return [ var_0, var_2 ];
}

vandalize_spotlight_speed( var_0, var_1, var_2 )
{
    scripts\mp\gametypes\br_gulag.gsc::vcloseangles( var_2, var_1 );
    var_3 = spawn( "script_model", var_2 );
    var_3 setmodel( "tag_origin" );
    var_3.angles = var_1;
    var_3 hide();
    var_3 showtoplayer( self );
    self playerlinktoabsolute( var_3, "tag_origin" );
    self playerhide();
    thread scripts\mp\gametypes\br_gulag.gsc::uniquepoolid( var_3 );
    waitframe();
    scripts\mp\gametypes\br_public.gsc::vehicle_collision_updateinstanceend();
    scripts\mp\gametypes\br_public.gsc::unload_vehicles_on_weapons_free_thread();
    var_3.origin = var_0;
    waitframe();
    self unlink();
    self clearsoundsubmix( "deaths_door_mp" );
    self clearsoundsubmix( "fade_to_black_all_except_music_and_scripted5", 2 );
    self clearclienttriggeraudiozone( 1 );
    self playershow();
    var_4 = 0;

    if ( isdefined( level.targs_done ) )
        var_4 = level.targs_done;

    thread scripts\cp_mp\parachute::startfreefall( var_4, 0, undefined, undefined, 1 );
    self setclientomnvar( "ui_br_transition_type", 0 );
    self setclientomnvar( "ui_show_spectateHud", -1 );
    scripts\mp\gametypes\br_gulag.gsc::_id_11A7E();
    wait 0.5;
    scripts\mp\gametypes\br_gulag.gsc::gulagfadefromblack();
    waitframe();
    var_3 delete();
    self notify( "can_show_splashes" );
}

vehicle_compass_setplayerfriendlyto()
{
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );

    if ( level.cleanupswaploadoutflags._id_13141 )
    {
        self hudoutlinedisable();

        if ( !level.cleanupswaploadoutflags._id_13142 )
            self setscriptablepartstate( "headVFX", "zombieVision" );

        self visionsetnakedforplayer( "mp_don3_wz_zmb", 0 );
        vehicle_damage_deregistervisualpercentcallback();
    }

    waitframe();

    if ( getdvarint( "scr_br_zxp_loop_zombie_fx", 1 ) )
        self setscriptablepartstate( "zombie", "on_loop" );
    else
        self setscriptablepartstate( "zombie", "on" );
}

vehicle_damage_deregistervisualpercentcallback()
{
    foreach ( var_1 in level.players )
    {
        if ( !var_1 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
            scripts\mp\utility\outline::outlineenableforplayer( var_1, self, "outline_depth_zombievision", "top" );
    }
}

vehicle_createspawnselectiontankmarker()
{
    level endon( "game_ended" );
    self endon( "zombie_unset" );
    self endon( "disconnect" );
    self._id_130F6 = undefined;

    for (;;)
    {
        if ( vehicle_damage_disablestatedamagefloor() )
        {
            if ( !isdefined( self._id_130F6 ) || !self._id_130F6 )
            {
                self._id_130F6 = 1;
                vehicle_compass_updatevisibilityforplayer();
            }
        }
        else if ( !isdefined( self._id_130F6 ) || self._id_130F6 )
        {
            self._id_130F6 = 0;
            vehicle_cp_create();
        }

        waitframe();
    }
}

vehicle_compass_updatevisibilityforplayer()
{
    self notify( "zombie_enter_gas" );
    self unsetperk( "specialty_radarblip", 1 );
}

vehicle_cp_create()
{
    self notify( "zombie_exit_gas" );

    if ( level.cleanupswaploadoutflags._id_1310B >= 0 )
    {
        if ( level.cleanupswaploadoutflags._id_1310B == 0 )
            self setperk( "specialty_radarblip", 1 );
        else
            thread vehicle_damage_getpristinestatehealthadd();
    }
}

vehicle_damage_getpristinestatehealthadd()
{
    if ( level.cleanupswaploadoutflags._id_1310B <= 0 )
        return;

    self endon( "zombie_unset" );
    self endon( "zombie_enter_gas" );
    self endon( "disconnect" );
    level endon( "game_ended" );

    for (;;)
    {
        self setperk( "specialty_radarblip", 1 );
        wait( level.cleanupswaploadoutflags._id_1310C );
        self unsetperk( "specialty_radarblip", 1 );
        wait( level.cleanupswaploadoutflags._id_1310B );
    }
}

vehicle_damage_disablestatedamagefloor()
{
    if ( !isdefined( level.br_circle ) || !isdefined( level.br_circle.dangercircleent ) )
        return 0;

    var_0 = scripts\mp\gametypes\br_circle.gsc::getdangercircleorigin();
    var_1 = scripts\mp\gametypes\br_circle.gsc::getdangercircleradius();
    return distance2dsquared( var_0, self.origin ) > var_1 * var_1;
}

vehicle_damage_givescoreandxp()
{
    self endon( "disconnect" );
    self._id_120BD = 1;
    self.radarmode = "normal_radar";
    self.hasradar = 1;
    self waittill( "zombie_unset" );
    self._id_120BD = undefined;
    self.hasradar = 0;
}

vehicle_damage_isburningdown()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );

    for (;;)
    {
        if ( self issupersprinting() )
            self refreshsprinttime();

        waitframe();
    }
}

vehicle_damage_cp_init( var_0 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    wait 1;

    while ( !self isonground() )
    {
        unset_vehicle_only_wave( var_0 );
        waitframe();
    }

    self setclientomnvar( "ui_br_altimeter_state", 0 );
    self skydive_interrupt();
    playfxontag( level._effect["zombie_splat"], self, "j_mainroot" );
    self playsoundtoplayer( "zxp_spawn_splat_plr", self, self );
    self playsound( "zxp_spawn_splat_npc", self, self );

    if ( isbot( self ) )
        return;

    self freezecontrols( 1 );
    var_1 = gettime() + 2000;

    while ( self getcurrentprimaryweapon().classname == "none" && gettime() < var_1 )
    {
        unset_vehicle_only_wave( var_0 );
        waitframe();
    }

    var_2 = lbravo_spawner_jammer1( self, 0 );

    if ( !isdefined( var_2 ) )
        var_2 = ( 0, 0, 1 );

    var_3 = anglestoforward( self.angles );
    var_4 = vectortoangles( var_2 );
    var_5 = angleclamp180( var_4[0] + 90 );
    var_4 = ( 0, var_4[1], 0 );
    var_6 = anglestoforward( var_4 );
    var_7 = vectordot( var_6, var_3 );
    var_8 = var_7 * var_5;
    var_9 = getdvarint( "scr_br_zxp_zombie_splat_down_clamp", 20 );
    var_10 = getdvarint( "scr_br_zxp_zombie_splat_up_clamp", -70 );

    if ( var_8 > 0 )
        var_8 = min( var_9, var_8 );
    else
        var_8 = max( var_10, var_8 );

    self setplayerangles( ( var_8, self.angles[1], 0 ) );

    if ( self getcurrentprimaryweapon().classname != "none" )
        self forceplaygestureviewmodel( "ges_zombie_splat" );

    wait 1;
    self skydive_setbasejumpingstatus( 0 );
    self skydive_setdeploymentstatus( 0 );
    wait 0.5;
    self freezecontrols( 0 );
    self freezelookcontrols( 1 );
    self allowsprint( 0 );
    thread vehicle_damage_getpristinestateminhealth();
    unset_vehicle_only_wave( var_0 );
    wait 1.0;
    self freezelookcontrols( 0 );
    wait 1.0;
    self allowsprint( 1 );
}

unset_vehicle_only_wave( var_0 )
{
    if ( !self hasweapon( var_0 ) )
        scripts\cp_mp\utility\inventory_utility::_giveweapon( var_0, undefined, undefined, 1 );

    if ( self getcurrentprimaryweapon().classname == "none" )
        thread scripts\cp_mp\utility\inventory_utility::_switchtoweaponimmediate( var_0 );
}

spectatenumber( var_0 )
{
    foreach ( var_2 in level.players )
    {
        if ( !isalive( var_2 ) )
            continue;

        if ( scripts\engine\utility::array_contains( var_0, var_2.team ) )
        {
            var_2 scripts\mp\hud_message::showsplash( "br_gametype_zxp_jugg_team" );
            continue;
        }

        var_2 scripts\mp\hud_message::showsplash( "br_gametype_zxp_jugg_other" );
    }
}

build_our_weapon( var_0 )
{
    spectatenumber( var_0 );

    foreach ( var_2 in var_0 )
    {
        var_3 = level.teamdata[var_2]["alivePlayers"];

        foreach ( var_5 in var_3 )
        {
            if ( isalive( var_5 ) && !var_5 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
            {
                if ( level.cleanupswaploadoutflags.pick_from_preset_solutions )
                    var_5 updateassassinationthreatlevel();

                var_5 ui_damage_num_next_index();
            }
        }
    }
}

ui_damage_num_next_index()
{
    if ( istrue( self.inlaststand ) )
        scripts\mp\laststand::is_same_combat_action( "self_revive_success", self );

    scripts\cp_mp\killstreaks\juggernaut::tryusejuggernaut( 1 );

    if ( level.cleanupswaploadoutflags.registerhints > 0 && level.cleanupswaploadoutflags.registerlocation )
    {
        objective_icon( self.juggcontext.juggobjid, "icon_waypoint_jugg" );
        objective_state( self.juggcontext.juggobjid, "current" );
        objective_setzoffset( self.juggcontext.juggobjid, 70 );
        objective_setprogress( self.juggcontext.juggobjid, 0.99 );
        objective_setshowprogress( self.juggcontext.juggobjid, 1 );
        objective_setprogressteam( self.juggcontext.juggobjid, self.team );
        objective_setbackground( self.juggcontext.juggobjid, 1 );
        _func_421( self.juggcontext.juggobjid, 1 );
    }
}

onplayerdamaged( var_0 )
{
    if ( level.cleanupswaploadoutflags.registerhints > 0 && level.cleanupswaploadoutflags.registerlocation && istrue( var_0.victim.isjuggernaut ) )
    {
        var_1 = var_0.victim.health / var_0.victim.maxhealth;
        objective_setprogress( var_0.victim.juggcontext.juggobjid, var_1 );

        if ( isdefined( var_0.attacker ) )
            var_0.attacker thread updateleaders( var_0.victim.juggcontext.juggobjid, var_0.victim );
    }
}

updateleaders( var_0, var_1 )
{
    self endon( "disconnect" );
    self notify( "playerPinObjective" );
    self endon( "playerPinObjective" );
    objective_pinforclient( var_0, self );
    var_1 scripts\engine\utility::waittill_notify_or_timeout( "death", 1 );
    objective_unpinforclient( var_0, self );
}

_id_11F9A()
{
    if ( !level.cleanupswaploadoutflags._id_13118 )
        return;

    level.cleanupswaploadoutflags._id_130C9 = spawnstruct();
    level.cleanupswaploadoutflags._id_130C9.powers = [];
    ammorestock_used( level.cleanupswaploadoutflags._id_130C9, "jump", [ "+speed_throw", "+toggleads_throw", "+ads_akimbo_accessible" ], ::vehicle_damage_enginevisualcallback, 0, undefined, ::vehicle_damage_getburndowntime, undefined, &"MP_ZXP/CHARGED_JUMP", undefined, 6, "jumpStatus", "jumpProgress" );
    ammorestock_used( level.cleanupswaploadoutflags._id_130C9, "jumpStop", [ "-speed_throw", "-toggleads_throw", "-ads_akimbo_accessible" ], ::vehicle_damage_getinstancedataforvehicle, 0 );
    ammorestock_used( level.cleanupswaploadoutflags._id_130C9, "gas", "+smoke", ::vehicle_cp_createlate, 0, ::vehicle_create, ::vehicle_cp_deletenextframe, ::vehicle_cp_deletenextframelate, &"MP_ZXP/GAS_GRENADE", undefined, 15, "gasGrenadeStatus", "gasGrenadeProgress" );
    ammorestock_used( level.cleanupswaploadoutflags._id_130C9, "emp", "+frag", ::vehicle_compass_updateallvisibilityforplayer, 0, undefined, undefined, undefined, &"MP_ZXP/EMP", undefined, 15, "empStatus", "empProgress" );

    if ( getdvarint( "scr_br_zxp_bumper_ping_support", 1 ) )
        ammorestock_used( level.cleanupswaploadoutflags._id_130C9, "gas_or_emp", [ "+equip_toggle_throw" ], ::vehicle_createlate, 0, undefined, ::vehicle_createspawnselectionlittlebirdmarker );
}

ammorestock_used( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11, var_12 )
{
    var_13 = "scr_br_zxp_power_" + var_1;

    if ( getdvarint( var_13, 1 ) == 0 )
        return;

    if ( isstring( var_2 ) )
        var_2 = [ var_2 ];

    var_0.powers[var_1] = spawnstruct();
    var_0.powers[var_1].bunker11vo = var_2;
    var_0.powers[var_1].func = var_3;
    var_0.powers[var_1]._id_124AB = var_5;
    var_0.powers[var_1].enable_lbravo_player_infil = var_6;
    var_0.powers[var_1].velo_forward_memory = var_7;
    var_0.powers[var_1].label = var_8;
    var_0.powers[var_1].removeextracthelipad = var_9;
    var_0.powers[var_1].eyeoffnotehandler = var_10;
    var_0.powers[var_1]._id_124BB = var_11;
    var_0.powers[var_1].waitfor_trigger_near_obit = var_12;
    var_0.powers[var_1]._id_11DC9 = var_4;
}

vehicle_createlate( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    self notify( "playerZombieGasOrEMP" );
    self endon( "playerZombieGasOrEMP" );
    var_2 = gettime() + getdvarint( "scr_br_zxp_gas_or_emp_timeout_ms", 500 );

    while ( var_2 > gettime() )
    {
        if ( self secondaryoffhandbuttonpressed() )
        {
            self notify( "gas" );
            break;
        }
        else if ( self fragbuttonpressed() )
        {
            self notify( "emp" );
            break;
        }

        waitframe();
    }
}

vehicle_compass_updateallvisibilityforplayer( var_0, var_1 )
{
    var_2 = 60;
    var_3 = 1;
    var_4 = 64;
    var_5 = var_4 * var_4;
    var_6 = 768;
    var_7 = var_6 * var_6;
    var_8 = "zxp_emp_fire_plr";
    var_9 = self;
    var_9 enableplayerbreathsystem( 0 );
    var_9 playsoundonmovingent( var_8 );
    var_9 playsoundtoplayer( "zmb_effort_empblast", self, self );
    var_9 playsound( "zmb_npc_effort_empblast", var_9, var_9 );
    var_9 thread _id_130CD( 2 );
    var_10 = anglestoforward( var_9.angles );
    playfx( level.cleanupswaploadoutflags.empvfx, var_9.origin, var_10 );
    var_11 = getcompleteweaponname( "emp_drone_non_player_mp" );
    var_12 = getcompleteweaponname( "emp_drone_non_player_direct_mp" );
    var_13 = scripts\cp_mp\emp_debuff::get_emp_ents();

    foreach ( var_15 in var_13 )
    {
        var_16 = var_15.owner;

        if ( isdefined( var_16 ) )
        {
            if ( var_16 != var_9 && !scripts\cp_mp\utility\player_utility::playersareenemies( var_9, var_16 ) )
                continue;
        }

        var_17 = distancesquared( var_9.origin, var_15.origin );

        if ( var_17 > var_7 )
            continue;

        var_18 = scripts\engine\utility::ter_op( var_17 > var_5, var_11, var_12 );
        var_15 dodamage( 1, var_9.origin, var_9, var_9, "MOD_EXPLOSIVE", var_18 );
        var_15 playsoundonmovingent( "zxp_emp_impact_ent" );
        var_19 = scripts\cp_mp\utility\damage_utility::packdamagedata( var_9, var_15, 1, var_18, "MOD_EXPLOSIVE", var_9, var_9.origin );
        thread vehicle_compass_instanceisregistered( var_19 );
    }

    var_21 = getcompleteweaponname( "emp_drone_player_mp" );
    var_22 = undefined;

    if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "player", "getPlayersInRadius" ) )
        var_22 = [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "player", "getPlayersInRadius" ) ]]( var_9.origin, var_6 );

    foreach ( var_24 in var_22 )
    {
        if ( var_24 == var_9 )
            continue;

        if ( var_24 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
            continue;

        if ( !var_24 scripts\cp_mp\emp_debuff::can_emp_player() )
            continue;

        if ( var_24 != var_9 && !scripts\cp_mp\utility\player_utility::playersareenemies( var_9, var_24 ) )
            continue;

        var_24 dodamage( 1, var_9.origin, var_9, var_9, "MOD_EXPLOSIVE", var_21 );
        var_19 = scripts\cp_mp\utility\damage_utility::packdamagedata( var_9, var_24, 1, var_21, "MOD_EXPLOSIVE", var_9, var_9.origin );
        thread vehicle_compass_instanceisregistered( var_19 );
    }

    thread updatescrapassistdata( var_0, var_1 );
}

_id_130CD( var_0 )
{
    if ( isdefined( var_0 ) )
        wait( var_0 );

    self enableplayerbreathsystem( 1 );
}

updatescrapassistdata( var_0, var_1 )
{
    if ( level.cleanupswaploadoutflags.physicssettled )
        self.vip_onrespawn[var_1].brking_createc130pathstruct scripts\mp\hud_util::updatebar( 1.0, 0 );
    else
        self.vip_onrespawn[var_1].frac = 1.0;

    thread updatetextongamepadchange( var_0, var_1 );
}

vehicle_createspawnselectionlittlebirdmarker( var_0, var_1 )
{
    self notify( "playerZombieGasOrEMP" );
}

vehicle_damage_getpristinestateminhealth()
{
    if ( !level.cleanupswaploadoutflags._id_13118 )
        return;

    thread van_stop_vo( level.cleanupswaploadoutflags._id_130C9 );
}

van_stop_vo( var_0 )
{
    thread updateteamplunderscore( var_0 );
    thread updatesuperuiprogress( var_0 );
    thread updateteambettermissionrewardsui( var_0 );

    if ( level.cleanupswaploadoutflags.physicssettled )
        thread updatetimedrunhud( var_0 );

    thread updateteamscoreplacements( var_0 );
    thread updatesmokinggunhud( var_0 );

    foreach ( var_3, var_2 in var_0.powers )
    {
        if ( isdefined( var_0.powers[var_3]._id_124BB ) )
            _id_12B3F( var_0.powers[var_3]._id_124BB, 2 );
    }
}

vehicle_compass_instanceisregistered( var_0 )
{
    var_1 = 5;
    var_2 = 2;
    scripts\cp_mp\emp_debuff::apply_emp_struct( var_0 );
    var_3 = var_1;

    if ( isplayer( var_0.victim ) )
    {
        var_0.victim.propminigamesetting = 1;
        var_0.victim playsound( "zxp_emp_impact_plr" );

        if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "perk", "hasPerk" ) )
        {
            if ( var_0.victim != self && var_0.victim [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "perk", "hasPerk" ) ]]( "specialty_emp_resist" ) )
            {
                var_3 = var_2;

                if ( scripts\cp_mp\utility\script_utility::issharedfuncdefined( "damage", "updateDamageFeedback" ) )
                    self [[ scripts\cp_mp\utility\script_utility::getsharedfunc( "damage", "updateDamageFeedback" ) ]]( "hittacresist" );
            }
        }
    }

    his_removequestinstance( var_0, var_3 );

    if ( isdefined( var_0.victim ) )
    {
        var_0.victim.propminigamesetting = undefined;
        var_0.victim scripts\cp_mp\emp_debuff::remove_emp();
    }
}

vehicle_create( var_0, var_1 )
{
    scripts\mp\equipment::giveequipment( "equip_gas_grenade", "secondary" );
    scripts\mp\equipment::setequipmentslotammo( "secondary", 1 );
}

vehicle_cp_createlate( var_0, var_1 )
{
    self endon( "offhand_end" );
    self waittill( "grenade_fire", var_2, var_3, var_4, var_5 );

    if ( !scripts\mp\utility\weapon::grenadethrown( var_2 ) )
        return;

    self playsound( "zxp_grenade_vo_npc", self, self );
    thread updatescrapassistdata( var_0, var_1 );
}

vehicle_cp_deletenextframelate( var_0, var_1 )
{
    scripts\mp\equipment::setequipmentslotammo( "secondary", 1 );
}

vehicle_cp_deletenextframe( var_0, var_1 )
{
    scripts\mp\equipment::takeequipment( "secondary" );
}

his_removequestinstance( var_0, var_1 )
{
    var_0.victim endon( "death_or_disconnect" );
    level endon( "game_ended" );
    var_2 = scripts\engine\utility::waittill_notify_or_timeout_return( "emp_cleared", var_1 );

    if ( var_2 != "emp_cleared" )
        var_0.empremoved = 1;
}

updatesmokinggunhud( var_0 )
{
    level endon( "game_ended" );
    self endon( "disconnect" );
    scripts\engine\utility::_id_12E40( "death", "zombie_unset", "zombie_set" );
    thread updatescrapassistdataforcecredit( var_0 );
    thread updatesquadleaderpassstateforteam( var_0 );
    thread updatesquadmemberlaststandreviveprogress( var_0 );
    thread updatespecificfobindanger( var_0 );
}

updateteamplunderscore( var_0 )
{
    if ( isbot( self ) )
        return;

    foreach ( var_6, var_2 in var_0.powers )
    {
        foreach ( var_4 in var_2.bunker11vo )
            self notifyonplayercommand( var_6, var_4 );
    }
}

updatespecificfobindanger( var_0 )
{
    if ( !isdefined( self.vip_onrespawn ) )
        return;

    if ( level.cleanupswaploadoutflags.physicssettled )
    {
        foreach ( var_2 in self.vip_onrespawn )
        {
            if ( isdefined( var_2 ) )
            {
                if ( isdefined( var_2.brking_createc130pathstruct ) )
                    var_2.brking_createc130pathstruct scripts\mp\hud_util::destroyelem();

                var_2 destroy();
            }
        }
    }

    self.vip_onrespawn = undefined;
}

updatesuperuiprogress( var_0 )
{
    var_1 = 200;
    var_2 = 18;
    var_3 = var_1;
    self.vip_onrespawn = [];

    foreach ( var_6, var_5 in var_0.powers )
    {
        if ( isdefined( var_5.label ) )
        {
            if ( level.cleanupswaploadoutflags.physicssettled )
                self.vip_onrespawn[var_6] = updatesixthsensevo( var_5.label, var_5.removeextracthelipad, var_3, var_5._id_11DC9 );
            else
            {
                self.vip_onrespawn[var_6] = spawnstruct();
                self.vip_onrespawn[var_6].frac = 0;
            }

            self.vip_onrespawn[var_6].incooldown = 0;
            var_3 = var_3 + var_2;
        }
    }
}

updatesixthsensevo( var_0, var_1, var_2, var_3 )
{
    var_4 = scripts\mp\hud_util::createfontstring( "default", 1.5 );
    var_4.x = 15;
    var_4.y = var_2;
    var_4.alignx = "left";
    var_4.aligny = "top";
    var_4.horzalign = "left_adjustable";
    var_4.vertalign = "top_adjustable";
    var_4.alpha = var_3;
    var_4.glowalpha = 0;
    var_4.hidewheninmenu = 1;
    var_4.archived = 0;

    if ( isdefined( var_1 ) && !scripts\engine\utility::is_player_gamepad_enabled() )
        var_4.label = var_1;
    else if ( isdefined( var_0 ) )
        var_4.label = var_0;

    var_5 = scripts\mp\hud_util::createbar( ( 1, 1, 1 ), 160, 14 );
    var_5.x = 13;
    var_5.y = var_2;
    var_5.alignx = "left";
    var_5.aligny = "top";
    var_5.horzalign = "left_adjustable";
    var_5.vertalign = "top_adjustable";
    var_5.alpha = var_3;
    var_5 _id_11FB2();
    var_5.archived = 0;
    var_5.hidewheninmenu = 1;
    var_5.bar.archived = 0;
    var_5.bar.hidewheninmenu = 1;
    var_5.bar.alpha = var_3;
    var_4.brking_createc130pathstruct = var_5;
    return var_4;
}

_id_11FB2( var_0, var_1, var_2, var_3 )
{
    self.bar.horzalign = self.horzalign;
    self.bar.vertalign = self.vertalign;
    self.bar.alignx = "left";
    self.bar.aligny = self.aligny;
    self.bar.y = self.y + 2;
    self.bar.x = self.x + 2;
    scripts\mp\hud_util::updatebar( self.bar.frac );
}

updatesquadleaderpassstateforteam( var_0 )
{
    if ( isbot( self ) )
        return;

    foreach ( var_6, var_2 in var_0.powers )
    {
        foreach ( var_4 in var_2.bunker11vo )
            self notifyonplayercommandremove( var_6, var_4 );
    }
}

updatesquadmemberlaststandreviveprogress( var_0 )
{
    foreach ( var_3, var_2 in var_0.powers )
    {
        if ( isdefined( var_2.enable_lbravo_player_infil ) )
            self thread [[ var_2.enable_lbravo_player_infil ]]( var_0, var_3 );
    }
}

updatescrapassistdataforcecredit( var_0 )
{
    if ( !isdefined( var_0 ) || !isdefined( self.vip_onrespawn ) )
        return;

    self notify( "disableCooldown" );

    foreach ( var_3, var_2 in var_0.powers )
    {
        if ( !isdefined( self.vip_onrespawn[var_3] ) )
            continue;

        self.vip_onrespawn[var_3].incooldown = 0;

        if ( level.cleanupswaploadoutflags.physicssettled )
            self.vip_onrespawn[var_3].brking_createc130pathstruct scripts\mp\hud_util::updatebar( 0, 0 );
        else
            self.vip_onrespawn[var_3].frac = 0;

        thread updatetextongamepadchange( var_0, var_3 );
    }

    self.getextractionpadent = undefined;
    self.registersuperextraweapon = undefined;
}

_id_119D9( var_0 )
{
    if ( !isdefined( level.teamdata[var_0]["aliveCountHuman"] ) )
        return level.teamdata[var_0]["aliveCount"];
    else
        return level.teamdata[var_0]["aliveCountHuman"];
}

remove_from_spawnflags( var_0, var_1 )
{
    var_2 = self;
    level endon( "game_ended" );
    var_2 endon( "disconnect" );
    var_2 notify( "gulag_auto_win" );
    var_2 notify( "zombie_set" );
    var_2 notify( "zombie_unset" );

    if ( istrue( var_2.respawningfromtoken ) )
        return;

    var_3 = var_0;
    var_4 = "token_sponsored";

    if ( !isalive( var_2 ) && istrue( var_2.checkpointstruct ) )
    {
        if ( !level.cleanupswaploadoutflags.currentvalue )
            var_2 usefuncoverride( 1 );

        [var_3, var_4] = scripts\mp\gametypes\br_gulag.gsc::update_ai_array( var_0, var_1, 0, 1 );
    }
    else if ( istrue( var_3.hasrespawntoken ) )
        var_3 scripts\mp\gametypes\br_pickups.gsc::removerespawntoken();

    var_2.respawningfromtoken = 1;
    var_6 = var_2 scripts\mp\gametypes\br_gulag.gsc::vehicle_collision_registerevent();

    if ( var_6 )
        var_2 scripts\mp\utility\lower_message::setlowermessageomnvar( 0 );

    var_2 scripts\mp\hud_message::ending_viewing_players_setup();

    if ( level.cleanupswaploadoutflags.currentvalue )
        var_2 scripts\mp\gametypes\br_gametype_zxp.gsc::vehicle_compass_mp_init( 1 );
    else
        var_2 vehicle_damage_givescore( 0 );

    var_2 freezecontrols( 0 );
    var_2 freezelookcontrols( 0 );
    var_2 allowsprint( 1 );
    var_7 = "br_gulag_kiosk_redeploy";
    var_8 = var_0;
    var_2 thread scripts\mp\hud_message::showsplash( var_7, undefined, var_0 );
    var_2.respawningfromtoken = undefined;
}

updateteamscoreplacements( var_0 )
{
    foreach ( var_3, var_2 in var_0.powers )
    {
        if ( isdefined( var_2._id_124AB ) )
            self thread [[ var_2._id_124AB ]]( var_0, var_3 );
    }
}

updateteambettermissionrewardsui( var_0 )
{
    if ( isbot( self ) )
        return;

    foreach ( var_3, var_2 in var_0.powers )
        thread updateteamplunderhud( var_0, var_3 );
}

updateteamplunderhud( var_0, var_1 )
{
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "zombie_set" );
    level endon( "game_ended" );

    for (;;)
    {
        self waittill( var_1 );
        waittillframeend;

        if ( isdefined( self.vip_onrespawn[var_1] ) && self.vip_onrespawn[var_1].incooldown )
        {
            updateleadmarkers();
            continue;
        }

        self thread [[ var_0.powers[var_1].func ]]( var_0, var_1 );
    }
}

updateleadmarkers()
{
    if ( !isdefined( self.getextractionpadent ) || gettime() > self.getextractionpadent )
    {
        self playlocalsound( "br_pickup_deny" );
        self.getextractionpadent = gettime() + 1000;
    }
}

updatetimedrunhud( var_0 )
{
    level endon( "game_ended" );
    self endon( "zombie_unset" );
    self endon( "zombie_set" );
    self endon( "death_or_disconnect" );

    if ( isbot( self ) )
        return;

    waittillframeend;
    var_1 = scripts\engine\utility::is_player_gamepad_enabled();

    for (;;)
    {
        var_2 = scripts\engine\utility::is_player_gamepad_enabled();

        if ( var_2 != var_1 )
        {
            var_1 = var_2;

            if ( var_2 )
            {
                foreach ( var_5, var_4 in var_0.powers )
                {
                    if ( isdefined( var_4.removeextracthelipad ) )
                        self.vip_onrespawn[var_5].label = var_4.label;
                }
            }
            else
            {
                foreach ( var_5, var_4 in var_0.powers )
                {
                    if ( isdefined( var_4.removeextracthelipad ) )
                        self.vip_onrespawn[var_5].label = var_4.removeextracthelipad;
                }
            }
        }

        waitframe();
    }
}

updatetextongamepadchange( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "zombie_set" );
    self endon( "disableCooldown" );

    if ( !isdefined( self.vip_onrespawn[var_1] ) || istrue( self.vip_onrespawn[var_1].incooldown ) )
        return;

    var_2 = self.vip_onrespawn[var_1];

    if ( level.cleanupswaploadoutflags.vip_onentergulag && var_2.frac > 0 )
    {
        self.vip_onrespawn[var_1].incooldown = 1;
        var_3 = var_0.powers[var_1].eyeoffnotehandler;
        var_4 = "scr_br_zxp_power_cooldown_" + var_1;

        if ( getdvarint( var_4, 0 ) != 0 )
            var_3 = getdvarint( var_4, 0 );

        thread vehicle_collision_ignorefutureevent( var_0, var_1, var_3, int( var_2.frac * 100 ) );
        var_5 = var_2.frac;
        var_3 = var_3 * var_5;

        if ( level.cleanupswaploadoutflags.physicssettled )
        {
            var_2.brking_createc130pathstruct.bar.color = ( 1, 0.6, 0 );
            var_2.brking_createc130pathstruct.bar scaleovertime( var_3, 0, var_2.brking_createc130pathstruct.height );
        }

        wait( var_3 );
        var_6 = "ui_zxp_restock_" + var_1;
        self playlocalsound( var_6 );
        self.vip_onrespawn[var_1].incooldown = 0;
    }
    else
    {
        if ( level.cleanupswaploadoutflags.physicssettled )
            var_2.brking_createc130pathstruct scripts\mp\hud_util::updatebar( 0, 0 );
        else
            var_2.frac = 0;

        thread vehicle_collision_ignorefutureevent( var_0, var_1, 0, 0 );
    }

    if ( level.cleanupswaploadoutflags.physicssettled )
        var_2.brking_createc130pathstruct.bar.color = ( 1, 1, 1 );

    if ( isdefined( var_0.powers[var_1].velo_forward_memory ) )
        self [[ var_0.powers[var_1].velo_forward_memory ]]( var_0, var_1 );
}

vehicle_collision_ignorefutureevent( var_0, var_1, var_2, var_3 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "zombie_set" );
    self endon( "disableCooldown" );

    if ( !isdefined( var_0.powers[var_1]._id_124BB ) || !isdefined( var_0.powers[var_1].waitfor_trigger_near_obit ) )
        return;

    _id_12B3F( var_0.powers[var_1]._id_124BB, 1 );
    var_4 = var_2 * 1000 * var_3 / 100;
    var_5 = gettime();
    var_6 = var_5 + var_4;

    while ( gettime() < var_6 )
    {
        var_7 = gettime();
        var_8 = ( var_6 - gettime() ) / var_4;
        var_9 = var_8 * var_3;
        _id_12B3F( var_0.powers[var_1].waitfor_trigger_near_obit, int( var_9 ) );
        waitframe();
    }

    _id_12B3F( var_0.powers[var_1].waitfor_trigger_near_obit, 0 );
    _id_12B3F( var_0.powers[var_1]._id_124BB, 2 );
}

_id_12B3F( var_0, var_1 )
{
    var_2 = 0;
    var_3 = 0;

    switch ( var_0 )
    {
        case "jumpStatus":
            var_2 = 0;
            var_3 = 2;
            break;
        case "jumpProgress":
            var_2 = 2;
            var_3 = 7;
            break;
        case "empStatus":
            var_2 = 9;
            var_3 = 2;
            break;
        case "empProgress":
            var_2 = 11;
            var_3 = 7;
            break;
        case "gasGrenadeStatus":
            var_2 = 18;
            var_3 = 2;
            break;
        case "gasGrenadeProgress":
            var_2 = 20;
            var_3 = 7;
            break;
        case "numVaccine":
            var_2 = 27;
            var_3 = 2;
            break;
        default:
            break;
    }

    if ( !isdefined( level._id_13116 ) )
        level._id_13116 = [];

    if ( !isdefined( level._id_13116["ui_br_zombie_powers"] ) )
        level._id_13116["ui_br_zombie_powers"] = 0;

    var_4 = int( pow( 2, var_3 ) ) - 1;
    var_5 = ( int( var_1 ) & var_4 ) << var_2;
    var_6 = ~( var_4 << var_2 );
    var_7 = self getclientomnvar( "ui_br_zombie_powers" );
    var_8 = var_7 & var_6;
    var_9 = var_8 + var_5;
    level._id_13116["ui_br_zombie_powers"] = var_9;
    self setclientomnvar( "ui_br_zombie_powers", level._id_13116["ui_br_zombie_powers"] );
}

vehicle_damage_enginevisualcallback( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "playerZombieJumpStop" );
    var_2 = -1;

    if ( vehicle_damage_enginevisualclearcallback() )
    {
        updateleadmarkers();
        return;
    }

    var_3 = getdvarfloat( "scr_br_zxp_powers_jump_charge_rate", 1.0 );
    var_4 = getdvarfloat( "scr_br_zxp_powers_jump_min_frac", 0.25 );
    var_5 = getdvarint( "scr_br_zxp_powers_jump_max_hold_time", var_2 );
    var_6 = var_3 * level.framedurationseconds;
    self.registerpuzzleinteractions = 0.0;
    self allowmelee( 0 );
    self disableoffhandweapons();

    while ( self ismantling() || self isthrowinggrenade() || self ismeleeing() || scripts\mp\utility\weapon::grenadeinpullback() )
        waitframe();

    thread vehicle_damage_beginburndown();
    thread _id_1258D();
    var_7 = undefined;
    var_8 = 0;

    if ( !isdefined( self.registersuperextraweapon ) || gettime() > self.registersuperextraweapon )
    {
        self playlocalsound( "ui_zxp_charge_jump_start" );
        self.registersuperextraweapon = gettime() + 500;
    }

    if ( isdefined( var_0.powers[var_1]._id_124BB ) )
        _id_12B3F( var_0.powers[var_1]._id_124BB, 0 );

    while ( !vehicle_damage_enginevisualclearcallback() )
    {
        if ( level.cleanupswaploadoutflags.physicssettled )
            self.vip_onrespawn[var_1].brking_createc130pathstruct scripts\mp\hud_util::updatebar( self.registerpuzzleinteractions, 0 );
        else
            self.vip_onrespawn[var_1].frac = self.registerpuzzleinteractions;

        var_9 = self.registerpuzzleinteractions;
        self.registerpuzzleinteractions = self.registerpuzzleinteractions + var_6;

        if ( self.registerpuzzleinteractions >= 1 )
        {
            self.registerpuzzleinteractions = 1.0;

            if ( var_5 >= 0 )
            {
                if ( !isdefined( var_7 ) )
                {
                    var_7 = gettime() + var_5 * 1000;

                    if ( level.cleanupswaploadoutflags.physicssettled )
                        thread vehicle_damage_getheavystatemaxhealth( var_1, var_5 );
                }

                if ( gettime() >= var_7 )
                    break;
            }
        }

        if ( level.cleanupswaploadoutflags.physicssettled && var_9 < var_4 && self.registerpuzzleinteractions >= var_4 )
            self.vip_onrespawn[var_1].brking_createc130pathstruct.bar.color = ( 0, 1, 0 );

        if ( var_9 < 1 && self.registerpuzzleinteractions >= 1 )
            self playlocalsound( "ui_zxp_charge_jump_full" );

        if ( isdefined( var_0.powers[var_1].waitfor_trigger_near_obit ) )
        {
            var_8 = max( int( self.registerpuzzleinteractions * 100 ), 0 );
            _id_12B3F( var_0.powers[var_1].waitfor_trigger_near_obit, var_8 );
        }

        waitframe();
    }

    thread vehicle_damage_getheavystatehealthadd( var_0, var_1 );
}

vehicle_damage_enginevisualclearcallback()
{
    return self getstance() == "prone" || istrue( self.usingascender );
}

vehicle_damage_getleveldatafordamagestate()
{
    if ( level.cleanupswaploadoutflags.registerquestcategorytablevalues != 0 )
    {
        var_0 = self.origin + ( 0, 0, level.cleanupswaploadoutflags.registerquestcategorytablevalues );
        var_1 = playerphysicstrace( self.origin, var_0 );

        if ( var_1 != var_0 )
            return 0;
    }

    if ( level.cleanupswaploadoutflags.registerscriptableinstance != 0 )
    {
        var_2 = self geteye();
        var_0 = var_2 + ( 0, 0, level.cleanupswaploadoutflags.registerscriptableinstance );
        var_3 = 10;
        var_4 = 20;
        var_5 = scripts\engine\trace::create_contents( 0, 1, 0, 1, 0, 0, 1 );
        var_1 = scripts\engine\trace::capsule_trace( var_2, var_0, var_3, var_4, ( 0, 0, 0 ), self, var_5 );

        if ( var_1["fraction"] != 1 )
            return 0;
    }

    return 1;
}

vehicle_damage_getheavystatehealthadd( var_0, var_1 )
{
    self stopgestureviewmodel( "ges_zombie_superjumpcharge" );
    self notify( "playerZombieJumpChargeEnd" );
    self notify( "playerZombieJumpStop" );
    var_2 = getdvarfloat( "scr_br_zxp_powers_jump_min_frac", 0.25 );
    var_3 = getdvarint( "scr_br_zxp_powers_jump_min_frac_refund", 1 );

    if ( self.registerpuzzleinteractions >= var_2 && !vehicle_damage_enginevisualclearcallback() && vehicle_damage_getleveldatafordamagestate() && !self ismantling() )
    {
        self playsoundtoplayer( "zxp_superjump_vo", self, self );
        self playsound( "zxp_superjump_sfx_npc", self, self );
        var_4 = getdvarfloat( "scr_br_zxp_powers_jump_velocity", 1300 );
        var_5 = self getplayerangles();
        thread vehicle_damage_deregisterdefaultvisuals();
        uavworstid( var_5, var_4, self.registerpuzzleinteractions );
        thread vehicle_collision_geteventdata();
        thread unload_type();
        self.getextractionpadent = undefined;
        self.registersuperextraweapon = undefined;
    }
    else if ( var_3 )
    {
        if ( level.cleanupswaploadoutflags.physicssettled )
            self.vip_onrespawn[var_1].brking_createc130pathstruct.bar.frac = 0;
        else
            self.vip_onrespawn[var_1].frac = 0;

        _id_12B3F( var_0.powers[var_1].waitfor_trigger_near_obit, 0 );
        self enableoffhandweapons();
        self allowmelee( 1 );
        self notify( "endSuperJumpFov" );
        updateleadmarkers();
    }
    else
        updateleadmarkers();

    vehicle_damage_getburndowntime( var_0, var_1, 1 );
}

vehicle_damage_beginburndown()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "playerZombieJumpStop" );

    if ( self isgestureplaying( "ges_zombie_superjumpcharge" ) )
        return;

    while ( self ismantling() || self isthrowinggrenade() || self ismeleeing() || scripts\mp\utility\weapon::grenadeinpullback() )
        waitframe();

    self forceplaygestureviewmodel( "ges_zombie_superjumpcharge" );

    while ( self isgestureplaying( "ges_zombie_superjumpcharge" ) )
    {
        if ( self isonladder() )
        {
            self stopgestureviewmodel( "ges_zombie_superjumpcharge" );
            break;
        }

        waitframe();
    }
}

vehicle_damage_deregisterdefaultvisuals()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self setscriptablepartstate( "skydiveVfx", "enabled_zombie", 0 );
    wait 0.2;
    self notify( "endSuperJumpFov" );
    self forceplaygestureviewmodel( "ges_zombie_superjump" );

    while ( !vehicle_damage_endburndown() )
        waitframe();

    self notify( "zombie_jump_complete" );
    self stopgestureviewmodel( "ges_zombie_superjump" );
    self setscriptablepartstate( "skydiveVfx", "default", 0 );
    self playsoundtoplayer( "zxp_splat_plr", self, self );
    self playsound( "zmb_npc_breath_land_hi", self, self );
    self playsound( "zxp_splat_npc", self, self );
    wait 0.2;
    self enableoffhandweapons();
    self allowmelee( 1 );
}

vehicle_damage_endburndown()
{
    return self isonground() || self isonladder() || self ismantling();
}

uavworstid( var_0, var_1, var_2, var_3 )
{
    var_4 = 1;
    var_5 = ( 0, 0, 20 );

    if ( !isdefined( var_3 ) )
        var_3 = var_5;

    var_6 = var_0;
    var_7 = ( 0, 0, 1 );
    var_8 = ( 1, 0, 0 );

    if ( getdvarint( "scr_br_zxp_powers_jump_pitch_correction", var_4 ) )
    {
        var_7 = lbravo_spawner_jammer1();

        if ( !isdefined( var_7 ) )
            var_7 = ( 0, 0, 1 );

        var_9 = ( 0, var_6[1], 0 );
        var_10 = anglestoright( var_9 );
        var_8 = vectorcross( var_7, var_10 );
        var_11 = vectortoangles( var_8 );
        var_12 = angleclamp180( var_11[0] );
        var_13 = -85;
        var_14 = var_12;
        var_15 = var_6[0];

        if ( var_15 > var_12 )
            var_15 = var_12;

        var_16 = getdvarfloat( "scr_br_zxp_powers_jump_pitch_correction_at_max", -45.0 );
        var_17 = getdvarfloat( "scr_br_zxp_powers_jump_pitch_correction_at_min", 0.0 );
        var_18 = ( var_15 - var_13 ) / ( var_14 - var_13 );
        var_19 = var_17 + var_18 * ( var_16 - var_17 );
        var_6 = ( var_15 + var_19, var_6[1], var_6[2] );
    }

    var_20 = getdvarfloat( "scr_br_zxp_powers_jump_pitch_add", 0.0 );

    if ( var_20 != 0.0 )
        var_6 = ( var_6[0] + var_20, var_6[1], var_6[2] );

    var_21 = anglestoforward( var_6 );
    var_22 = var_21 * var_2 * var_1;
    var_23 = self.origin + var_3;
    self setorigin( var_23 );
    self setvelocity( var_22 );
    glassradiusdamage( self.origin + ( 0, 0, 30 ), 30, 50, 51 );
    var_24 = anglestoforward( self.angles );
    var_25 = self.origin + ( 0, 0, 30 ) + var_24 * 15;
    radiusdamage( var_25, 100, 1, 1 );
}

vehicle_collision_geteventdata()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    var_0 = getdvarfloat( "scr_br_zxp_air_control", 400.0 );

    if ( var_0 <= 0.0 )
        return;

    var_1 = getdvarfloat( "scr_br_zxp_air_control_max_speed", 1400.0 );
    wait 0.2;

    while ( !vehicle_damage_endburndown() )
    {
        var_2 = self getnormalizedmovement();

        if ( length( var_2 ) > 0 )
        {
            var_3 = rotatevector( ( var_2[0], -1.0 * var_2[1], 0 ), self.angles );
            var_4 = self getvelocity();
            var_5 = length( var_4 );
            var_6 = var_3 * var_0 * level.framedurationseconds;
            var_7 = var_4 + var_6;
            var_8 = length( var_7 );

            if ( var_8 <= var_1 )
                self setvelocity( var_7 );
            else if ( var_5 < var_1 )
            {
                var_7 = vectornormalize( var_7 ) * var_1;
                self setvelocity( var_7 );
            }
        }

        waitframe();
    }
}

unload_type()
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "zombie_jump_complete" );
    var_0 = getdvarfloat( "scr_br_zxp_clear_moving_platfrom_time", 0.3 );

    if ( var_0 < 0 )
        return;

    if ( var_0 > 0 )
        wait( var_0 );

    self _meth_87AF();
}

get_max_ai_from_infil_name( var_0, var_1, var_2, var_3, var_4 )
{
    level notify( "hitVelocity" );
    level endon( "hitVelocity" );
    var_5 = var_0 + var_1;
    var_6 = var_2 + var_3 * 20;
    var_7 = var_2 + var_4 * 20;

    for (;;)
        waitframe();
}

vehicle_damage_getinstancedataforvehicle( var_0, var_1 )
{
    if ( isdefined( self.registerpuzzleinteractions ) )
        vehicle_damage_getheavystatehealthadd( var_0, "jump" );
    else
        self notify( "playerZombieJumpStop" );
}

lbravo_spawner_jammer1( var_0, var_1 )
{
    if ( !isdefined( var_0 ) )
        var_2 = self;
    else
        var_2 = var_0;

    if ( !isdefined( var_1 ) )
        var_1 = 0;

    var_3 = [ var_2 ];
    var_4 = [ self.origin ];

    for ( var_5 = -1.0; var_5 <= 1.0; var_5 = var_5 + 2.0 )
    {
        for ( var_6 = -1.0; var_6 <= 1.0; var_6 = var_6 + 2.0 )
        {
            var_7 = var_2 getpointinbounds( var_5, var_6, 0.0 );
            var_7 = ( var_7[0], var_7[1], self.origin[2] );
            var_4[var_4.size] = var_7;
        }
    }

    var_8 = ( 0, 0, 0 );
    var_9 = 0;

    foreach ( var_11 in var_4 )
    {
        var_12 = scripts\engine\trace::_bullet_trace( var_11 + ( 0, 0, 4 ), var_11 + ( 0, 0, -16 ), 0, var_3 );
        var_13 = var_12["fraction"] > 0.0 && var_12["fraction"] < 1;

        if ( var_13 )
        {
            var_8 = var_8 + var_12["normal"];
            var_9++;
        }
    }

    if ( var_9 > 0 )
    {
        var_8 = var_8 / var_9;
        return var_8;
    }
    else
        return undefined;
}

vehicle_damage_getburndowntime( var_0, var_1, var_2 )
{
    if ( istrue( var_2 ) )
        thread updatetextongamepadchange( var_0, var_1 );

    self.registerpuzzleinteractions = undefined;
}

vehicle_damage_getheavystatemaxhealth( var_0, var_1 )
{
    level endon( "game_ended" );
    self endon( "death_or_disconnect" );
    self endon( "zombie_unset" );
    self endon( "playerZombieJumpStop" );
    self endon( "playerZombieJumpChargeEnd" );

    if ( var_1 <= 0 )
        return;

    var_2 = scripts\mp\gametypes\br_circle.gsc::bot_get_low_on_all_ammo( var_1, int( var_1 * 5 ), 1 );
    var_3 = 1;

    for ( var_4 = 0; var_4 < var_2.size; var_4++ )
    {
        if ( var_3 )
            self.vip_onrespawn[var_0].brking_createc130pathstruct.bar.color = ( 1, 0, 0 );
        else
            self.vip_onrespawn[var_0].brking_createc130pathstruct.bar.color = ( 0, 1, 0 );

        wait( var_2[var_4] );
        var_3 = !var_3;
    }
}

update_health_bar_to_player( var_0, var_1 )
{
    var_2 = 1800;
    var_3 = spawnstruct();
    var_3.origin = self.origin;
    var_0 thread scripts\mp\equipment\concussion_grenade::applyconcussion( var_3, self );
    var_0 thread updatesecretstashhud( level.cleanupswaploadoutflags._id_130C9 );
    var_4 = var_0.origin - self.origin;
    var_5 = vectortoangles( var_4 );
    var_6 = distance( var_0.origin, self.origin );
    var_7 = 1.0 - var_6 / var_1;
    var_0 uavworstid( var_5, var_2, var_7 );
}

play_exfil_hvt_vo( var_0 )
{
    if ( isexplosivedamagemod( var_0.meansofdeath ) && var_0.objweapon.basename == "emp_drone_non_player_direct_mp" || var_0.objweapon.basename == "emp_drone_non_player_mp" || var_0.objweapon.basename == "emp_drone_player_mp" )
        return 1;
    else
        return 0;
}

updatesecretstashhud( var_0 )
{
    if ( !isdefined( var_0 ) )
        return;

    self notify( "disableCooldown" );

    foreach ( var_3, var_2 in var_0.powers )
    {
        if ( !isdefined( self.vip_onrespawn[var_3] ) )
            continue;

        self.vip_onrespawn[var_3].incooldown = 0;
        thread updatescrapassistdata( var_0, var_3 );
    }
}

_id_1258D()
{
    var_0 = self;
    var_0 endon( "death_or_disconnect" );
    var_0 notify( "applyFOVPresentation" );
    var_0 endon( "applyFOVPresentation" );
    var_0 lerpfovbypreset( "zombiearcade" );
    var_0 waittill( "endSuperJumpFov" );
    var_0 lerpfovbypreset( "zombiedefault" );
}

addtoteamlives( var_0, var_1 )
{
    var_0 vehicle_collision_getignoreevent();
}

removefromteamlives( var_0, var_1 )
{
    var_0 vehicle_collision_getignoreevent();
}

update_operator_east_char_loc()
{
    return istrue( self.processedsplash );
}

respawntags( var_0 )
{
    if ( scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() )
    {
        var_1 = isdefined( var_0.attacker ) && var_0.attacker infilvideoplay();

        if ( !var_1 || !level.cleanupswaploadoutflags._id_1313F )
            return 0;

        thread updatesecretstashhud( level.cleanupswaploadoutflags._id_130C9 );
        thread vehicle_damage_getmaxhealth();
        thread vehicle_damage_onenterstateheavy( var_0 );
        thread vehicle_compass_shouldbevisibletoplayer();
    }

    return 1;
}

vehicle_damage_onenterstateheavy( var_0 )
{
    var_1 = 500;
    var_2 = 90;
    var_3 = 60;
    var_4 = 30;
    var_5 = var_0.direction_vec;
    var_6 = vectortoyaw( var_5 );
    var_7 = var_2;
    var_8 = var_3;

    if ( scripts\engine\utility::cointoss() )
        var_8 = var_8 * -1;

    var_8 = var_8 + var_6;
    var_9 = ( var_7, var_8, 0 );
    var_10 = vectornormalize( ( var_5[0], var_5[1], 0 ) );
    var_11 = var_10 * var_4 + ( 0, 0, var_4 );
    uavworstid( var_9, var_1, 1.0, var_11 );
}

vehicle_compass_shouldbevisibletoplayer()
{
    self endon( "disconnect" );
    self._id_12D03 = 1;
    var_0 = getdvarfloat( "scr_br_zxp_vehicle_immunity", 1.5 );
    wait( var_0 );
    self._id_12D03 = undefined;
}

vehicle_damage_getmaxhealth()
{
    level endon( "game_ended" );
    self endon( "last_stand_finished" );
    self endon( "death_or_disconnect" );
    self waittill( "last_stand_transition_done" );
    waittillframeend;
    self setlaststandselfreviving( 1 );
    self.rallypoint_showafterprematch = 1;
    self.laststandreviveent makeunusable();
    var_0 = self.laststandreviveent;
    var_0.usetime = getdvarfloat( "scr_br_zxp_vehicle_getup", 3.0 ) * 1000;

    if ( !isdefined( var_0.curprogress ) )
        var_0.curprogress = 0;

    while ( scripts\mp\utility\player::isreallyalive( self ) && var_0.curprogress < var_0.usetime )
    {
        if ( self isinexecutionvictim() )
        {
            waitframe();
            continue;
        }

        if ( !isdefined( var_0.userate ) )
            var_0.userate = 0;

        var_0.curprogress = var_0.curprogress + level.frameduration * var_0.userate;
        var_0.userate = 1;
        scripts\mp\gameobjects::updateuiprogress( var_0, 1 );

        if ( var_0.curprogress >= var_0.usetime )
            break;

        waitframe();
    }

    var_0.usetime = undefined;
    var_0.curprogress = undefined;
    var_0.userate = undefined;
    scripts\mp\laststand::is_same_combat_action( "self_revive_success", self );
    self playsoundtoplayer( "zmb_breath_land_dropin", self, self );
    self playsound( "zmb_npc_breath_land_dropin" );
    self setlaststandselfreviving( 0 );
}

vfx_time()
{
    if ( istrue( level.br_debugsolotest ) || level.gameended )
        return;

    var_0 = 0;
    var_1 = [];
    var_2 = [];

    foreach ( var_4 in level.teamnamelist )
    {
        var_5 = level.teamdata[var_4]["teamCount"];

        if ( var_5 > 0 )
        {
            if ( level.teamdata[var_4]["aliveCountHuman"] > 0 )
            {
                if ( ( level.cleanupswaploadoutflags.registerleveldataforvehicle || level.cleanupswaploadoutflags.registerhints == 0 ) && var_2.size > 0 )
                    return;

                var_2[var_2.size] = var_4;
                var_0 = var_0 + level.teamdata[var_4]["aliveCountHuman"];
                continue;
            }

            if ( level.teamdata[var_4]["aliveCount"] > 0 )
                var_1[var_1.size] = var_4;
        }
    }

    if ( !level.cleanupswaploadoutflags.registerleveldataforvehicle && var_0 <= level.cleanupswaploadoutflags.registerhints )
    {
        level.cleanupswaploadoutflags.registerleveldataforvehicle = 1;
        thread build_our_weapon( var_2 );

        if ( level.cleanupswaploadoutflags._id_1311E )
            level.cleanupswaploadoutflags._id_1311D = 0;
    }

    if ( var_2.size > 1 )
        return;

    var_7 = scripts\mp\utility\script::quicksort( var_1, ::_id_12172 );

    for ( var_8 = 0; var_8 < var_7.size; var_8++ )
    {
        var_4 = var_7[var_8];
        var_9 = var_8 + 2;
        thread scripts\mp\gametypes\br.gsc::supplydropprice( var_4, var_9, 0, 1 );
    }

    thread scripts\mp\gamelogic::endgame( var_2[0], game["end_reason"]["enemies_eliminated"] );
}

_id_12172( var_0, var_1 )
{
    var_2 = level.teamdata[var_0]["lastZombieTime"];
    var_3 = level.teamdata[var_1]["lastZombieTime"];
    return var_2 >= var_3;
}

_id_1315E()
{
    wait 5.0;
    scripts\mp\utility\sound::anim_spawnposition_override( "br_zxp" );
}

vehicle_collision_getignoreevent()
{
    var_0 = self.team;
    level.teamdata[var_0]["aliveCountHuman"] = 0;

    foreach ( var_2 in level.teamdata[var_0]["alivePlayers"] )
    {
        if ( !var_2 scripts\mp\gametypes\br_public.gsc::update_timer_for_bomb_vest_detonator_holder() && !var_2 update_operator_east_char_loc() )
            level.teamdata[var_0]["aliveCountHuman"]++;
    }
}
